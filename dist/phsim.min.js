!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";
/**
 * @author Mjduniverse
 * @copyright 2020 Mjduniverse 
 * @license
 *
 * Physics Simulator Class Library
 *
 * Copyright 2020 Mjduniverse.com
 * 
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software 
 * and associated documentation files (the "Software"), to deal in the Software without restriction, 
 * including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, 
  * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, 
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial 
 * portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT 
 * LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. 
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, 
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
  * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 */function n(t=new n.Static){if(t&&Object.assign(this,t),n.Static.call(this),Array.isArray(t.simulations)?this.simulations=t.simulations:Array.isArray(t.layers)?this.simulations[0]=t:Array.isArray(t.objUniverse)?this.simulations[0].layers[0]=t:Array.isArray(t)&&(this.simulations[0].layers[0].objUniverse=[]),"object"==typeof t.wFunctions&&(this.wFunctions=t.wFunctions),t.noUse||Matter.use(n.matterPlugin),this.options=t,t.canvas)this.connectCanvas(t.canvas);else{var e=document.createElement("canvas");this.connectCanvas(e)}if(t.container)this.connectContainer(t.container);else{var i=document.createElement("div");this.connectContainer(i)}this.registerKeyEvents(),t.initSimIndex?this.gotoSimulationIndex(t.initSimIndex):this.gotoSimulationIndex(0)}n.prototype.connectCanvas=function(t){this.canvas=t,this.ctx=t.getContext("2d"),this.canvas.width=this.box.w||this.box.width,this.canvas.height=this.box.h||this.box.height,this.registerCanvasEvents(),this.configRender(this.ctx)},n.prototype.connectContainer=function(t){this.container=t,t.appendChild(this.canvas),t.classList.add("phsim-container"),this.configFilter(t)},n.prototype.delta=50/3,n.prototype.init=!1,n.prototype.sl_time=0,n.prototype.simulationIndex=0,n.statusCodes={INT:0,LOADED_DYN_OBJECTS:1,LOADED_SPRITES:2,LOADED_AUDIO:3,LOADED_SIMULATION:4},n.prototype.status=0,n.prototype.mouseX=null,n.prototype.mouseY=null,n.prototype.sim=null,n.prototype.simulation=null,n.prototype.paused=!0,n.prototype.matterJSWorld=null,n.prototype.matterJSEngine=null,n.prototype.dynTree=[],n.prototype.objUniverse=[],n.prototype.staticSprites=[],n.prototype.staticAudio=[],n.prototype.audioPlayers=0,n.prototype.classes={},n.prototype.bgFillStyle="white",n.version="0.1.0-alpha",n.prototype.loading={bgClr:"black",txtClr:"white",txtFace:"arial",txtAlign:"center",txt:"Loading...",yPos:"center",txtSize:20},n.prototype.drawLoadingScreen=function(){this.ctx.fillStyle=this.loading.bgClr,this.ctx.fillRect(0,0,this.camera.scale,this.canvas.height),this.ctx.fillStyle=this.loading.txtClr,this.ctx.textAlign=this.loading.txtAlign,this.ctx.font=this.loading.txtSize+"px "+this.loading.txtFace,this.ctx.fillText(this.loading.txt,this.canvas.width/2,this.canvas.height/2)},"object"==typeof window&&(window.PhSim=n),t.exports=n,n.Static=i(2),i(10),n.EventStack=i(3),n.prototype.eventStack=new n.EventStack,n.prototype.simulationEventStack=new n.EventStack,n.PhRender=i(11),n.Sprites=i(12),n.Audio=i(13),n.Vector=i(4),n.diagRect=i(14),n.Vertices=i(6),n.Centroid=i(5),n.BoundingBox=i(15),n.DynObject=i(1),n.Events=i(16),i(17),i(18),i(19),i(20),i(21),i(22),n.PhSimEventTarget=i(7),Object.assign(n.prototype,n.PhSimEventTarget),i(23),i(24),i(25),n.prototype.gotoSimulationIndex=i(26),n.Motion=i(8),i(27),i(28),i(29),n.Camera=i(30),n.Game=i(9),n.Gradients=i(31),i(32),n.calc_skinmesh=i(46),i(47),i(48),n.ObjLoops=i(49),n.prototype.eventStack=new n.EventStack,n.prototype.simulationEventStack=new n.EventStack,n.statusStruct={0:"Unloaded",1:"Initalized",2:"Loaded Images",3:"Loaded Audio",4:"Loaded Simulation"}},function(t,e,i){const n=i(2),s=i(0),o=i(6),r=i(7),a=i(3);var c=function(t,e){Object.assign(this,r);Object.assign(this,JSON.parse(JSON.stringify(t))),this.matter=e||s.DynObject.createMatterObject(t),"polygon"===t.shape&&(this.skinmesh=JSON.parse(JSON.stringify(t.verts))),this.firstCycle=t.cycle,"composite"===t.shape&&(this.flattenedParts=c.flattenComposite()),this.static=t,this.id=c.nextId,c.nextId++,this.phSim,this.eventStack=new a,this.matter.plugin.dynObject=this};c.setColor=function(t,e){t.fillStyle=e},c.prototype.setColor=function(t){return c.setColor(this,t)},c.setBorderColor=function(t,e){t.strokeStyle=e},c.prototype.setBorderColor=function(t){return c.setBorderColor(this,t)},c.setLineWidth=function(t,e){t.lineWidth=e},c.setRegPolygonSideNumber=function(t,e){},c.flattenComposite=function(t){var e=[];return function(t){for(var i=0;i<t.parts.length;i++)"composite"===t.parts[i].shape?c.flattenComposite("composite"===t.parts[i].shape):e.push(t.parts[i])}(t),e},c.createPath=function(t,e){var i=new n.Polygon(t);return Object.assign(i,e),new c(i)},c.createCircle=function(t,e,i,s={}){var o=new n.Circle(t,e,i);return Object.assign(o,s),new c(o)},c.createRectangle=function(t,e,i,s,o={}){var r=new n.Rectangle(t,e,i,s);Object.assign(r,o)},c.createRegPolygon=function(t,e,i,s,o={}){var r=new n.RegPolygon(t,e,i,s);return Object.assign(r,o),new c(r)},c.createMatterObject=function(t){var e=t.matter||{};if(e.label=t.name||"Untitled Object",e.isStatic=t.semiLocked,e.isStatic=t.locked,"number"==typeof t.density?e.density=t.density:e.density=.001,"number"==typeof t.mass&&(e.mass=t.mass,e.inverseMass=1/t.mass),"number"==typeof t.airFriction&&(e.airFriction=t.airFriction),Number.isInteger(t.collisionNum)&&(e.collisionFilter=t.collisionNum),"polygon"===t.shape)return Matter.Bodies.fromVertices(Matter.Vertices.centre(t.verts).x,Matter.Vertices.centre(t.verts).y,t.verts,e);if("circle"===t.shape)return Matter.Bodies.circle(t.x,t.y,t.radius,e);if("rectangle"===t.shape){var i=o.rectangle(t);return Matter.Bodies.fromVertices(Matter.Vertices.centre(i).x,Matter.Vertices.centre(i).y,i,e)}if("regPolygon"===t.shape){i=o.regPolygon(t);return Matter.Bodies.fromVertices(Matter.Vertices.centre(i).x,Matter.Vertices.centre(i).y,i,e)}},c.nextId=0,t.exports=c},function(t,e,i){const n=i(0);var s=function(){this.version=n.version,this.simulations=[],this.simulations.push(new n.Static.Simulation),this.simulations[0].layers[0].name="Untitled Layer",this.simulations[0].name="Untitled simulation",this.box=new n.Static.Rectangle(0,0,800,600)};s.GradientLimits=function(t,e,i,s){this.start=new n.Vector(t,e),this.end=new n.Vector(i,s)},s.GradientStop=function(t,e){this.color=e,this.pos=t},s.Gradient=function(){this.stops=[],this.name="",this.limits={start:{x:null,y:null},end:{x:null,y:null}}},s.lclGradient=function(){this.src=null,this.limits=new n.Static.GradientLimits(x0,y0,x1,y1),this.type="linear"},s.Polygon=function(t){if(this.verts,!Array.isArray(t))throw"Expecting array in argument 1";this.verts=t,this.shape="polygon"},s.Circle=function(t=null,e=null,i=null){this.shape="circle",this.x=null,this.y=null,this.radius=null,this.cycle=null},s.RegPolygon=function(t,e,i,n){this.shape="regPolygon",this.x=t,this.y=e,this.radius=i,this.cycle=null,this.sides=n},s.Rectangle=function(t,e,i,n){this.shape="rectangle",this.x=t,this.y=e,this.w=i,this.h=n,this.cycle=0},s.Composite=function(){this.shape="composite",this.name="Untitled"},s.SimBox=function(t,e){this.width=t,this.height=e},s.Camera=function(t,e,i){this.x=t,this.y=e,this.c=i},s.Layer=function(){this.objUniverse=[],this.name=null},s.Simulation=function(){this.layers=[],this.layers.push(new n.Static.Layer),this.world={grav:1,bg:"white",border:null,unit:1},this.simulation=!0,this.widgets=[]},s.LO=function(t,e){t.layers[0].objUniverse},s.SLO=function(t,e,i){},t.exports=s},function(t,e){t.exports=function(){this.contact=[],this.beforeupdate=[],this.objupdate=[],this.afterupdate=[],this.beforeslchange=[],this.afterslchange=[],this.beforespriteimgload=[],this.afterspriteimgload=[],this.beforeforcekey=[],this.mouseup=[],this.mouseout=[],this.mousemove=[],this.keydown=[],this.collisionstart=[],this.collisionactive=[],this.collisionend=[],this.beforecounterset=[],this.aftercounterset=[],this.collisionchange=[],this.load=[],this.matterJSLoad=[],this.clone=[],this.objmousedown=[],this.objmouseover=[],this.objmouseout=[],this.firstslupdate=[],this.exit=[],this.mousedown=[],this.click=[],this.objclick=[],this.objmousemove=[],this.objmouseup=[],this.score=[],this.hazard=[],this.gamewin=[],this.levelwin=[],this.levelloss=[]}},function(t,e){var i=function(t,e){if(this.x,this.y,"number"!=typeof t)throw console.trace(),"Expecting a number in argument 1";if(this.x=t,"number"!=typeof e)throw console.trace(),"Expecting a number in argument 2";this.y=e};i.add=function(t,e,n=!0){return n?new i(t.x+e.x,t.y+e.y):(t.x=t.x+e.x,t.y=t.y+e.y,t)},i.subtract=function(t,e,n=!0){return n?new i(t.x-e.x,t.y-e.y):(t.x=t.x-e.x,t.y=t.y-e.y,t)},i.scale=function(t,e){return new i(t.x*e,t.y*e)},i.divide=function(t,e){return new i(t.x*(1/e),t.y*(1/e))},i.distance=function(t,e){var i=Math.pow(t.x-e.x,2),n=Math.pow(t.y-e.y,2);return Math.sqrt(i+n)},i.getLength=function(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))},i.unitVector=function(t){return i.scale(t,1/i.getLength(t))},i.applyTransformation=function(t,e,n,s,o,r){return new i(t*o+e*r,n*o+s*r)},i.rotate=function(t,e,n){return i.applyTransformation(Math.cos(n),Math.sin(n),-Math.cos(n),Math.sin(n),t,e)},i.svgVector=function(t,e){return t+","+e},t.exports=i},function(t,e){const i={shape:function(t){return"rectangle"===t.shape?i.rectangle(t):"polygon"===t.shape?i.polygon(t):"circle"===t.shape||"regPolygon"===t.shape?t:void 0},rectangle:function(t){return{x:t.x+.5*t.w,y:t.y+.5*t.h}},polygon:function(t){for(var e=new PhSim.Vector(0,0),i=0;i<t.verts.length;i++)e.x+=t.verts[i].x,e.y+=t.verts[i].y;return e.x=1/t.verts.length*e.x,e.y=1/t.verts.length*e.y,e}};t.exports=i},function(t,e){const i={regPolygon:function(t){for(var e=[],i=2*Math.PI/t.sides,n=0;n<t.sides;n++){var s=t.x+Math.cos(i*n+t.cycle)*t.radius,o=t.y+Math.sin(i*n+t.cycle)*t.radius;e.push(new PhSim.Vector(s,o))}return e},rectangle:function(t){var e=[{x:t.x,y:t.y,topLeft:!0},{x:t.x+t.w,y:t.y,topRight:!0},{x:t.x+t.w,y:t.y+t.h,bottomRight:!0},{x:t.x,y:t.y+t.h,bottomLeft:!0}];return Matter.Vertices.rotate(e,t.cycle,PhSim.Centroid.rectangle(t)),e},getRectangleCorners:function(t){var e=PhSim.Vertices.rectangle(t);return{topLeft:e[0],topRight:e[1],bottomLeft:e[3],bottomRight:e[2]}}};t.exports=i},function(t,e,i){i(3);const n={on:function(t,e,i={}){if(i&&!0===i.slEvent?this.simulationEventStack[t]&&this.simulationEventStack[t].push(e):this.eventStack[t]&&this.eventStack[t].push(e),!i)throw new Error("Event Target Not Available");if(!0===i&&i.once){var n=function(i){this.off(t,e),this.off(t,n)};this.on(t,n)}},off:function(t,e){if(this.eventStack[t]&&this.eventStack[t].includes(e)){var i=this.eventStack[t].indexOf(e);this.eventStack[t].splice(i,1)}if(this.simulationEventStack[t]&&this.simulationEventStack[t].includes(e)){i=this.simulationEventStack[t].indexOf(e);this.simulationEventStack[t].splice(i,1)}},callEventClass:function(t,e,i){if(this.eventStack[t])for(var n=0;n<this.eventStack[t].length;n++){var s=this.eventStack[t][n];i.func=s,s.call(e,i)}if(this instanceof PhSim&&this.simulationEventStack[t])for(n=0;n<this.simulationEventStack[t].length;n++){s=this.simulationEventStack[t][n];i.func=s,s.call(e,i)}}};t.exports=n},function(t,e,i){const n=i(1),s=(i(0),i(5));var o={applyForce:function(t,e,i){if(!t.locked&&!t.noDyn)return Matter.Body.applyForce(t.matter,e,i)},setVelocity:function(t,e){if(!t.locked)return Matter.Body.setVelocity(t.matter,e)},translate:function(t,e){if(!t.locked){if("polygon"===t.shape)for(var i=0;i<t.verts.length;i++)t.verts[i].x=t.verts[i].x+e.x,t.verts[i].y=t.verts[i].y+e.y;if("circle"!==t.shape&&"rectangle"!==t.shape&&"regPolygon"!==t.shape||(t.x=t.x+e.x,t.y=t.y+e.y),t instanceof n)return Matter.Body.translate(t.matter,e)}},setPosition:function(t,e){if(!t.locked){if("circle"!==t.type&&"regPolygon"!==t.type||(t.x=e.x,t.y=e.y),"rectangle"===t.shape){var i=s.rectangle(t);t.x=t.x-i.x+e.x,t.y=t.y-i.y+e.y}if("polygon"===t.shape){i=s.polygon(dynObject);for(var o=0;o<t.verts.length;o++)t.verts[o].x=t.verts[o].x-i.x+e.x,t.verts[o].y=t.verts[o].y-i.y+e.y}t instanceof n&&Matter.Body.setPosition(t.matter,e)}},rotate:function(t,e,i){if(!t.locked)return t.skinmesh&&Matter.Vertices.rotate(t.skinmesh,e,i),Matter.Body.rotate(t.matter,e,i)},rotateTowards:function(t,e){var i=Math.atan2(e.y-t.matter.position.y,e.x-t.matter.position.x);o.rotate(t,i,t.matter.position)},setAngle:function(t,e){if(!t.locked)return t.skinmesh&&(Matter.Vertices.rotate(t.skinmesh,-t.cycle,t),Matter.Vertices.rotate(t.skinmesh,e,t)),Matter.Body.setAngle(t.matter,e)}};t.exports=o},function(t,e){var i=function(t,e){this.intLife=e.life,this.goal=e.goal,this.intScore=e.score,this.options=e,this.life=e.life,this.score=e.score,this.phSim=t};i.Options=function(t,e,i){this.goal=t,this.life=e,this.score=i},i.prototype.defaultGameWinModal=!0,i.prototype.defaultLevelWinModal=!0,i.prototype.setScore=function(t){var e=this;if(this.score=t,this.score>=this.goal&&Number.isInteger(this.score)&&Number.isInteger(this.goal))if(this.phSim.pause(),this.phSim.enableFilter(),this.phSim.simulationIndex+1===this.phSim.simulations.length){if(this.defaultGameWinModal){this.phSim.callEventClass("gamewin",this,{});var i=e.phSim.alert({msg:"You Win!",closeButtonTxt:"Play again",bgColor:"#333",txtColor:"#fff",w:300,h:100,onok:function(){e.phSim.disableFilter(),i.parentNode.removeChild(i),e.phSim.gotoSimulationIndex(0),e.phSim.play()}})}}else this.phSim.callEventClass("levelwin",this,{}),clearInterval(this.phSim.intervalLoop),this.phSim.disableFilter(),this.phSim.gotoSimulationIndex(this.phSim.simulationIndex+1),e.phSim.play();this.phSim.callEventClass("score",this,{})},i.prototype.setLife=function(t){this.life=t,0===this.life&&this.end()},i.prototype.incrementLife=function(){this.setLife(this.life+1)},i.prototype.decrementLife=function(){this.setLife(this.life-1)},i.prototype.end=function(){this.phSim.pause(),this.phSim.enableFilter();var t=this,e=this.phSim.alert({msg:"Game Over",closeButtonTxt:"Try again",bgColor:"#333",txtColor:"#fff",w:300,h:100,onok:function(){t.phSim.gotoSimulationIndex(t.phSim.simulationIndex),t.phSim.play(),t.phSim.disableFilter(),e.parentNode.removeChild(e)}});this.phSim.callEventClass("levelloss",this,{})},(i.Widgets={}).coin=function(t,e){e.value;var i,n,s=this;s.on("collisionstart",(i=t,n=function(){s.inSensorCollision(i)&&s.lclGame&&(s.lclGame.setScore(s.lclGame.score+1),s.off("collisionstart",n))}))},i.Widgets.hazard=function(t,e){var i,n,s=this;s.on("collisionstart",(i=t,n=function(){s.inSensorCollision(i)&&s.lclGame&&(s.lclGame.setLife(s.lclGame.life-1),s.off("collisionstart",n))}))},i.Widgets.health=function(t,e){var i,n,s=this;s.on("collisionstart",(i=t,n=function(){s.inSensorCollision(i)&&s.lclGame&&(s.lclGame.setLife(s.lclGame.life+1),s.off("collisionstart",n))}))},i.Widgets.endGame=function(t,e){var i=this.createMotionFunction("position",t,e.vector);this.createWFunction(t,i,e)},t.exports=i},function(t,e,i){const n=i(1),s=i(0),o={name:"phsim",version:"0.1.0",install:function(t){t.after("Detector.collisions",(function(){o.Detector.collisions.call(this,arguments)}))},Body:{init:function(t){t.plugin&&t.plugin.dynObject}},Bodies:{circle:function(t,e,i,n){},rectangle:function(){},fromVertices:function(){}},Detector:{collisions:function(){for(var t=0;t<this.length;t++){var e=this[t].bodyA,i=this[t].bodyB;if(e.parent===e){if(e.plugin.dynObject instanceof n)var o=s.Query.getCollisionClasses(e.plugin.dynObject)}else o=s.Query.getCollisionClasses(e.parent.plugin.dynObject);if(i.parent===i){if(i.plugin.dynObject instanceof n)var r=s.Query.getCollisionClasses(i.plugin.dynObject)}else r=s.Query.getCollisionClasses(i.parent.plugin.dynObject);o.length>0&&r.length>0&&(s.Query.intersectionExists(o,r)||(this.splice(this.indexOf(this[t]),1),t=0))}}}};s.matterPlugin=o,Matter.Plugin.register(s.matterPlugin)},function(t,e){var i=function(t){this.ctx=t};i.prototype.defaultAlpha=1,i.prototype.defaultStrokeStyle="transparent",i.prototype.defaultFillStyle="transparent",i.prototype.setCtx=function(t){this.ctx.lineCap="round","number"==typeof this.ctx.globalAlpha?this.ctx.globalAlpha=t.globalAlpha:this.ctx.globalAlpha=this.defaultAlpha,this.ctx.strokeStyle=t.strokeStyle||this.defaultStrokeStyle,this.ctx.fillStyle=t.fillStyle||this.defaultFillStyle,t.lineWidth?0===t.lineWidth?this.ctx.strokeStyle="transparent":this.ctx.lineWidth=t.lineWidth:this.ctx.strokeStyle="transparent"},i.prototype.unsetCtx=function(){this.ctx.globalAlpha=1},i.prototype.renderPolygon=function(t){this.setCtx(t),this.ctx.beginPath(),this.ctx.moveTo(t.verts[0].x,t.verts[0].y);for(var e=0;e<t.verts.length;e++)this.ctx.lineTo(t.verts[e].x,t.verts[e].y);if(this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill(),t.sprite&&t.sprite.src){var i=this.spriteImgObj[t.sprite.src],n=findCentroidOfPath(t);if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t.verts[0].x,t.verts[0].y);for(e=0;e<t.verts.length;e++)this.ctx.lineTo(t.verts[e].x,t.verts[e].y);this.ctx.translate(n.x,n.y),this.ctx.scale(t.sprite.scale,t.sprite.scale);var s=this.ctx.createPattern(i,"repeat");this.ctx.fillStyle=s,this.ctx.closePath(),this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t.verts[0].x,t.verts[0].y);for(e=0;e<t.verts.length;e++)this.ctx.lineTo(t.verts[e].x,t.verts[e].y);this.ctx.closePath(),this.ctx.clip();var o=PhSim.BoundingBox.fromShape(t),r=i.height*(o.w/i.width);this.renderSpriteByCenter(t.sprite.src,n.x,n.y,o.w,r,0),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,n.x,n.y,i.width,i.height,0)}this.unsetCtx()},i.prototype.renderSpriteByCenter=function(t,e,i,n,s,o){var r=this.spriteImgObj[t];this.ctx.save(),this.ctx.translate(e,i),this.ctx.rotate(o),null===s?this.ctx.drawImage(r,0,0,r.width,r.height,.5*-n,.5*-s,n):this.ctx.drawImage(r,0,0,r.width,r.height,.5*-n,.5*-s,n,s),this.ctx.restore()},i.prototype.renderConstraint=function(t){var e=SLO(t.object.S,t.object.L,t.object.O);this.ctx.save(),this.ctx.globalAlpha=.5,this.ctx.strokeStyle="black",this.ctx.arc(t.point.x,t.point.y,10,0,2*Math.PI),this.ctx.stroke(),this.ctx.arc(t.relativeEndPoint.x+findCentroidOfPath(e).x,t.relativeEndPoint.y+findCentroidOfPath(e).y,10,0,2*Math.PI),this.ctx.stroke(),this.ctx.setLineDash([10,10]),this.ctx.moveTo(t.point.x,t.point.y),this.ctx.lineTo(t.relativeEndPoint.x+findCentroidOfPath(e).x,t.relativeEndPoint.y+findCentroidOfPath(e).y),this.ctx.stroke(),this.ctx.restore()},i.prototype.renderCircle=function(t){if(this.setCtx(t),this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.radius,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),t.gradient&&(this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.fillStyle=PhSim.Gradients.extractGradient(this.ctx,t.gradient),this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()),t.sprite&&t.sprite.src){var e=this.spriteImgObj[t.sprite.src];if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.scale(t.sprite.scale,t.sprite.scale);var i=this.ctx.createPattern(e,"repeat");this.ctx.fillStyle=i,this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.clip();var n=PhSim.BoundingBox.fromShape(t),s=e.height*(n.w/e.width);this.renderSpriteByCenter(t.sprite.src,0,0,n.w,s),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,t.x,t.y,t.cycle)}this.unsetCtx()},i.prototype.renderRectangle=function(t){var e=PhSim.Centroid.rectangle(t),i=.5*-t.w,n=.5*-t.h;if(this.setCtx(t),this.ctx.translate(e.x,e.y),this.ctx.rotate(t.cycle),this.ctx.beginPath(),this.ctx.rect(i,n,t.w,t.h),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill(),t.widgets)for(var s=0;s<t.widgets.length;s++)"rectText"===t.widgets[s].type&&this.rectText(t.widgets[s],i,n,t.w,t.h,0);if(this.ctx.rotate(-t.cycle),this.ctx.translate(-e.x,-e.y),t.sprite&&t.sprite.src){var o=this.spriteImgObj[t.sprite.src];if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.rotate(t.cycle);var r=this.ctx.createPattern(o,"repeat");this.ctx.fillStyle=r,this.ctx.rect(.5*-t.w,.5*-t.h,t.w,t.h),this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.rotate(t.cycle),this.ctx.rect(.5*-t.w,.5*-t.h,t.w,t.h),this.ctx.clip();var a=o.height*(t.w/o.width);this.renderSpriteByCenter(t.sprite.src,0,0,t.w,a,0),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,e.x,e.y,o.w,o.h,t.cycle)}this.unsetCtx()},i.prototype.rectText=function(t,e,i,n,s,o){this.ctx.save(),this.ctx.translate(e,i),this.ctx.rotate(o),this.ctx.beginPath(),this.ctx.rect(0,0,n,s),this.ctx.clip(),this.ctx.textAlign="left",this.ctx.fillStyle=t.fill,this.ctx.lineWidth=void 0,t.lineWidth&&(this.ctx.lineWidth=t.lineWidth),this.ctx.strokeStyle=t.borderColor,this.ctx.font=t.size+"px "+t.font,this.ctx.textBaseline="top";var r=t.content;this.dynSim&&(r=this.dynSim.processVar(r)),this.ctx.fillText(r,0,0),t.lineWidth&&this.ctx.strokeText(r,0,0),this.ctx.restore()},i.prototype.renderRegPolygon=function(t){var e=PhSim.Vertices.regPolygon(t);this.setCtx(t),this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y);for(var i=0;i<e.length;i++)this.ctx.lineTo(e[i].x,e[i].y);if(this.ctx.closePath(),this.ctx.stroke(),this.ctx.globalAlpha=t.fillAlpha,this.ctx.fill(),t.sprite&&t.sprite.src){var n=this.spriteImgObj[t.sprite.src];if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.scale(t.sprite.scale,t.sprite.scale);var s=this.ctx.createPattern(n,"repeat");this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y);for(i=0;i<e.length;i++)this.ctx.lineTo(e[i].x,e[i].y);this.ctx.closePath(),this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y);for(i=0;i<e.length;i++)this.ctx.lineTo(e[i].x,e[i].y);this.ctx.closePath(),this.ctx.clip(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle);var o=PhSim.BoundingBox.fromShape(t),r=n.height*(o.w/n.width);this.renderSpriteByCenter(t.sprite.src,0,0,o.w,r,0),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,t.x,t.y,n.width,n.height,t.cycle)}this.unsetCtx()},i.prototype.renderStatic=function(t){if("polygon"===t.shape&&this.renderPolygon(t),"circle"===t.shape&&this.renderCircle(t),"rectangle"===t.shape&&this.renderRectangle(t),"regPolygon"===t.shape&&this.renderRegPolygon(t),"composite"===t.shape)for(var e=0;e<t.parts.length;e++)this.renderStatic(t.parts[e])},i.prototype.renderStaticLayer=function(t){for(var e=0;e<t.objUniverse.length;e++)this.renderStatic(t.objUniverse[e])},i.prototype.simulation=function(t){for(var e=0;e<t.layers.length;e++)t.layers[e].hidden||this.layer(t.layers[e])},i.prototype.dynamicSkeleton=function(t){if("polygon"===t.static.shape){this.ctx.beginPath(),this.ctx.moveTo(t.skinmesh[0].x,t.skinmesh[0].y);for(var e=0;e<t.skinmesh.length;e++)this.ctx.lineTo(t.skinmesh[e].x,t.skinmesh[e].y)}else{this.ctx.beginPath(),this.ctx.moveTo(t.matter.vertices.x,t.matter.vertices.y);for(e=0;e<t.matter.vertices.length;e++)this.ctx.lineTo(t.matter.vertices[e].x,t.matter.vertices[e].y)}},i.prototype.dynamicSkeleton_center=function(t){if("polygon"===t.static.shape){this.ctx.beginPath(),this.ctx.moveTo(t.skinmesh[0].x-t.matter.position.x,t.skinmesh[0].y-t.matter.position.y);for(var e=0;e<t.skinmesh.length;e++)this.ctx.lineTo(t.skinmesh[e].x-t.matter.position.x,t.skinmesh[e].y-t.matter.position.y)}else{this.ctx.beginPath(),this.ctx.moveTo(t.matter.vertices.x-t.matter.position.x,t.matter.vertices.y-t.matter.position.y);for(e=0;e<t.matter.vertices.length;e++)this.ctx.lineTo(t.matter.vertices[e].x-t.matter.position.x,t.matter.vertices[e].y-t.matter.position.y)}},i.prototype.drawDynamicSkeleton=function(t){this.dynamicSkeleton(t),this.ctx.closePath(),this.ctx.stroke()},i.prototype.dynamicRenderDraw=function(t){if(this.ctx.lineWidth=t.lineWidth,this.ctx.fillStyle=t.fillStyle,this.ctx.strokeStyle=t.strokeStyle,"polygon"===t.shape&&(this.drawDynamicSkeleton(t),this.ctx.fill(),t.sprite&&t.sprite.src)){var e=this.spriteImgObj[t.sprite.src];if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.dynamicSkeleton(t),this.ctx.translate(t.matter.position.x,t.matter.position.y),this.ctx.rotate(t.matter.angle),this.ctx.scale(t.sprite.scale,t.sprite.scale);var i=this.ctx.createPattern(e,"repeat");this.ctx.fillStyle=i,this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t.verts[0].x,t.verts[0].y);for(var n=0;n<t.verts.length;n++)this.ctx.lineTo(t.verts[n].x,t.verts[n].y);this.ctx.closePath(),this.ctx.clip();var s=PhSim.BoundingBox.fromShape(t),o=e.height*(s.w/e.width);this.renderSpriteByCenter(t.sprite.src,t.matter.position.x,t.matter.position.y,s.w,o,t.matter.angle),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,t.matter.position.x,t.matter.position.y,e.width,e.height,t.matter.angle)}if("circle"===t.shape&&this.renderCircle(t),"regPolygon"===t.shape&&this.renderRegPolygon(t),"rectangle"===t.shape&&this.renderRectangle(t),"composite"===t.shape)for(var r=1;r<t.parts.length;r++)this.dynamicRenderDraw(t.parts[r])},i.prototype.dynamicDrawLayer=function(t){for(var e=0;e<sim.simulations[simulationI].layers[t].length;e++)this.dynamicRenderDraw(t,e)},t.exports=i},function(t,e){var n={Calc:{},Sprite:function(){this.src=null,this.w=null,this.h=null,this.x=null,this.y=null,this.fit=null,this.repeat=null,this.object=null},renderSprite:function(t,e){var i=document.createElement("img");i.src=e.src,!0===e.spec&&t.drawImage(i,e.x,e.y,e.w,e.h),!0===e.auto&&t.drawImage(i,e.x,e.y,e.w,e.h)},renderGlobalSprites:function(t,e){for(i=0;i<e.sprites.length;i++)n.renderSprite(t,e.sprites[i])},circularSpriteRenderCanvas:function(t,e,i){var n=document.createElement("canvas").getContext("2d");document.createElement("img").src=e.src,n.rotate(i),n.drawImage()},spriteImgObj:function(t,e=function(){}){Object.defineProperty(this,"static",{enumerable:!1,value:{},writable:!0}),Object.defineProperty(this,"loaded_n",{enumerable:!1,value:0,writable:!0}),Object.defineProperty(this,"loaded",{enumerable:!1,value:!1,writable:!0}),Object.defineProperty(this,"onload",{enumerable:!1,value:e,writable:!0}),Object.defineProperty(this,"urls",{enumerable:!1,value:[],writable:!0}),Object.defineProperty(this,"length",{enumerable:!1,value:0,writable:!0});for(var i=this,n=0;n<t.length;n++)i.addSprite(t[n],(function(){i.loaded_n++,(i.loaded_n=i.length)&&e()}));0===t.length&&(i.onload(),i.loaded=!0)}};n.spriteImgObj.prototype.getBlobs=function(){},n.spriteImgObj.prototype.addSprite=function(t,e=function(){}){var i=this;if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addSprite(t[n]);else if(t.src){var s=document.createElement("img"),o=(i=this,function(){e(),s.removeEventListener("load",o),i.static[t.src]=t,i[t.src]=s,i.urls.push(t.src),i.length++});s.addEventListener("load",o),s.src=t.src}},t.exports=n},function(t,e){var i={AudioArray:function(t,e){this.array=[],this.loaded_n=0,this.loaded=!1,this.onload=e;var i=this;0===t.length&&(i.loaded=!0,i.onload());for(var n=0;n<t.length;n++){var s=document.createElement("audio"),o=function(){i.loaded_n++,i.array.length===i.loaded_n&&(i.loaded=!0,i.onload(),s.removeEventListener("canplaythrough",o))};s.addEventListener("canplaythrough",o),s.src=t[n].src,s.loop=t[n].loop,this.array.push(s)}}};t.exports=i},function(t,e){t.exports=function(t,e,i,n){var s=i-t,o=n-e;return new PhSim.Static.Rectangle(t,e,s,o)}},function(t,e,i){const n=i(2),s=function(t){(t=Object.assign([],t)).sort((function(t,e){return t.x-e.x})),this.smallX=t[0].x,this.largeX=t[t.length-1].x,t.sort((function(t,e){return t.y-e.y})),this.smallY=t[0].y,this.largeY=t[t.length-1].y;var e=this.largeX-this.smallX,i=this.largeY-this.smallY,s=this.smallX,o=this.smallY;n.Rectangle.call(this,e,i,s,o)};s.fromShape=function(t){if("polygon"===t.shape)return new s(t.verts);if("regPolygon"===t.shape)return new s(PhSim.Vertices.regPolygon(t));if("rectangle"===t.shape)return new s(PhSim.Vertices.rectangle(t,!0));if("circle"===t.shape){var e=t.x-t.radius,i=t.y-t.radius,n=t.x+t.radius,o=t.y+t.radius;return PhSim.diagRect(e,i,n,o,0)}if(t.composite){for(var r=[],a=0;a<t.objUniverse.length;a++)r.push(PhSim.Vertices.rectangle(this.getStaticBoundingBox(t.objUniverse[a])));return r=r.flat(1/0),new s(r)}},t.exports=s},function(t,e){const i={PhSimEvent:function(t){this.target=null,this.timestamp=null,this.type=t},PhSimDynEvent:function(){i.PhSimEvent.call(this),this.layer=null,this.simulation=null,this.object=null}};i.PhSimDynEvent.prototype=Object.create(i.PhSimEvent.prototype),i.PhSimEventKey=function(){i.PhSimDynEvent.call(this),this.key=null,this.domEvent=null},i.PhSimEventKey.prototype=Object.create(i.PhSimDynEvent.prototype),i.PhSimMouseEvent=function(){i.PhSimDynEvent.call(this),this.x=null,this.y=null,this.domEvent=null,this.dynArr=null},i.PhSimMouseEvent.prototype=Object.create(i.PhSimDynEvent.prototype),i.PhSimCollision=function(){this.bodyA=null,this.bodyB=null,this.matter=null},t.exports=i},function(t,e,i){const n=i(0);n.prototype.L=function(t){return this.dynTree[t]},n.prototype.LO=function(t,e){return this.dynTree[t][e]},n.prototype.getObjectFromLOStr=function(t){return t.split(","),this.LO(t[1],t[2])}},function(t,e,i){const n=i(0);n.createFromCanvas=function(t,e){var i=Object.create(t);return i.canvas=e,new n(i)},n.createFromContainer=function(t,e){var i=Object.create(t);return i.container=e,new n(i)},n.createContainer=function(t){var e=document.createElement("div");return this.createFromContainer(t,e)},n.loadFromJSON=function(t,e){var i=new XMLHttpRequest;i.open("GET",t);var s=function(){var t=n.createContainer(JSON.parse(i.responseText));e(t),i.removeEventListener("load",s)};i.addEventListener("load",s),i.send()},n.prototype.configRender=function(){this.assignPhRender(new n.PhRender(this.ctx)),this.noCamera||(this.camera=new n.Camera(this),this.camera.translate(-this.camera.x,-this.camera.y))}},function(t,e,i){const n=i(0);n.prototype.configFilter=function(t){this.htmlFilter=document.createElement("div"),this.htmlFilter.style.background="rgba(3,3,3,0.7)",this.htmlFilter.style.position="absolute",this.htmlFilter.style.display="none",this.htmlFilter.classList.add("dynsim-filter"),t.appendChild(this.htmlFilter)},n.prototype.enableFilter=function(){var t=this.canvas.getBoundingClientRect();this.htmlFilter.style.display="inline-block",this.htmlFilter.style.left="0px",this.htmlFilter.style.position="absolute",this.htmlFilter.style.width=Math.floor(t.width)+"px",this.htmlFilter.style.height=Math.floor(t.height)+"px"},n.prototype.disableFilter=function(){this.htmlFilter.style.display="none"},n.prototype.toggleFilter=function(){"none"===this.htmlFilter.style.display?this.enableFilter():this.disableFilter()},n.prototype.alert=function(t){var e=document.createElement("div");e.style.backgroundColor=t.bgColor,e.style.color=t.txtColor,e.style.textAlign="center",e.style.width=t.w+"px",e.style.height=t.h+"px",e.style.fontSize="20px";e.getBoundingClientRect();var i=this.canvas.getBoundingClientRect(),n=document.createElement("div");n.className="phsim-alertbox-msg",n.innerText=t.msg,n.style.textAlign="left",n.style.padding="20px",e.appendChild(n);var s=document.createElement("div"),o=function(){t.onok(),s.removeEventListener("click",o)};return s.addEventListener("click",o),s.innerText=t.closeButtonTxt,e.appendChild(s),this.container.appendChild(e),e.style.position="absolute",e.style.left=.5*i.width-.5*e.offsetWidth+"px",e.style.top=.5*i.height-.5*e.offsetHeight+"px",e}},function(t,e,i){const n=i(1),s=i(0);s.prototype.connectDynObjects=function(t,e){Matter.Body.setStatic(e,!0);var i=function(){var i={x:t.matter.position.x-t.matter.positionPrev.x,y:t.matter.position.y-t.matter.positionPrev.y};s.Motion.translate(e,i),s.Motion.rotate(e,t.matter.angle-t.matter.anglePrev,t.matter.position)};return this.on("afterupdate",i),i},s.prototype.forAllObjects=function(t){for(var e=this.objUniverse,i=0;i<e.length;i++){if(!1===t(e[i]))break}},s.prototype.addToOverlayer=function(t){t instanceof n&&Matter.World.add(this.matterJSWorld,t.matter),this.objUniverse.push(t)},s.prototype.isNonDyn=function(t){return t.noDyn},s.prototype.addObject=function(t,e={}){return"number"==typeof e.layer&&(this.dynTree[e.layer].push(t),t instanceof n&&(t.layerBranch=this.dynTree[e.layer])),this.objUniverse.push(t),t instanceof n&&(t.phSim=this,Matter.World.add(this.matterJSWorld,t.matter),t.static.widgets&&this.extractWidgets(t)),t},s.prototype.removeDynObj=function(t){if(Matter.Composite.remove(this.matterJSWorld,t.matter),this.objUniverse.splice(this.objUniverse.indexOf(t),1),t.layerBranch){var e=t.layerBranch.indexOf(t);t.layerBranch.splice(e,1),t.layerBranch=void 0}return t},s.prototype.setDynObjectLifespan=function(t,e){var i=this;setTimeout(e,(function(){i.removeDynObj(t)}))},s.prototype.renderAllCounters=function(){for(var t=0;t<this.counterArray.length;t++)this.renderCounterByIndex(t)}},function(t,e,i){const n=i(0);n.prototype.playAudioByIndex=function(t){return this.audioArray.array[t].play()},n.prototype.pauseAudioByIndex=function(t){return this.audioArray.array[t].pause()},n.prototype.pauseAudioByIndex=function(t){return this.audioArray.array[t].pause()},n.prototype.setAudioVolByIndex=function(t,e){return this.audioArray.array[t].volume=e,this.audioArray.array[t].volume},n.prototype.setAudioMuteByIndex=function(t){return this.audioArray.array[t].muted=v,this.audioArray.array[t].muted},n.prototype.toggleAudioByIndex=function(t){return!0===this.audioArray.array[t].muted?(this.audioArray.array[t].muted=!1,!1):!1===this.audioArray.array[t].muted?(this.audioArray.array[t].muted=!0,!0):void 0}},function(t,e,i){const n=i(0);n.prototype.getEventBridge=function(t){var e=this;return function(i){t.call(e,i)}},n.prototype.registerCanvasEvents=function(){var t=this;this.dispatchMouseDown=function(e){var i=new n.Events.PhSimMouseEvent,s=t.ctx.canvas;s.getBoundingClientRect();if(i.domEvent=e,i.x=t.mouseX,i.y=t.mouseY,i.type="mousedown",i.dynArr=t.pointObjArray(i.x,i.y),!t.paused&&t.objMouseArr&&t.objMouseArr.length>0){i.target=i.dynArr[i.dynArr.length-1],t.callEventClass("objmousedown",s,i);for(var o=0;o<i.dynArr.length;o++)i.dynArr[o].callEventClass("objmousedown",i.dynArr[o],i)}t.callEventClass("mousedown",s,i)},this.canvas.addEventListener("mousedown",this.dispatchMouseDown),this.dispatchClick=function(e){var i=new n.Events.PhSimMouseEvent,s=t.ctx.canvas;s.getBoundingClientRect();if(i.domEvent=e,i.x=t.mouseX,i.y=t.mouseY,i.type="click",i.dynArr=t.pointObjArray(i.x,i.y),t.objMouseArr.length>0){i.target=i.dynArr[i.dynArr.length-1],t.callEventClass("objclick",s,i);for(var o=0;o<i.dynArr.length;o++)i.dynArr[o].callEventClass("objclick",i.dynArr[o],i)}t.callEventClass("click",s,i)},this.canvas.addEventListener("click",this.dispatchClick),this.dispatchMouseMove=function(e){var i=new n.Events.PhSimMouseEvent,s=t.ctx.canvas,o=s.getBoundingClientRect();if(i.domEvent=e,i.x=e.clientX-o.left-t.camera.x,i.y=e.clientY-o.top-t.camera.y,i.dynArr=t.pointObjArray(i.x,i.y),t.mouseX&&t.mouseY&&(t.prevMouseX=t.mouseX,t.prevMouseY=t.mouseY),t.prevObjMouseArr=[],t.objMouseArr&&(t.prevObjMouseArr=[...t.objMouseArr]),t.mouseX=i.x,t.mouseY=i.y,t.dynArr=t.objMouseArr,t.objMouseArr=[],t.formerMouseObjs=[],t.newMouseObjs=[],t.init){for(r=0;r<t.objUniverse.length;r++)t.pointInObject(t.objUniverse[r],t.mouseX,t.mouseY)&&t.objMouseArr.push(t.objUniverse[r]),!t.objMouseArr.includes(t.objUniverse[r])&&t.prevObjMouseArr.includes(t.objUniverse[r])&&t.formerMouseObjs.push(t.objUniverse[r]),t.objMouseArr.includes(t.objUniverse[r])&&!t.prevObjMouseArr.includes(t.objUniverse[r])&&t.newMouseObjs.push(t.objUniverse[r]);if(t.objMouseArr&&t.objMouseArr.length>0){i.target=i.dynArr[i.dynArr.length-1],t.callEventClass("objmousemove",s,i);for(var r=0;r<i.dynArr.length;r++)i.dynArr[r].callEventClass("objmousemove",i.dynArr[r],i)}if(t.newMouseObjs&&t.newMouseObjs.length>0){i.newMouseObjs=t.newMouseObjs,i.target=i.newMouseObjs[i.dynArr.length-1],t.callEventClass("objmouseover",s,i);for(r=0;r<i.newMouseObjs.length;r++)i.newMouseObjs[r].callEventClass("objmouseover",i.newMouseObjs[r],i)}if(t.formerMouseObjs&&t.formerMouseObjs.length>0){i.formerMouseObjs=t.formerMouseObjs,i.target=i.formerMouseObjs[i.dynArr.length-1],t.callEventClass("objmouseout",s,i);for(r=0;r<i.formerMouseObjs.length;r++)i.formerMouseObjs[r].callEventClass("objmouseout",i.formerMouseObjs[r],i)}}t.callEventClass("mousemove",s,i)},this.canvas.addEventListener("mousemove",this.dispatchMouseMove),this.dispatchMouseUp=function(e){var i=new n.Events.PhSimMouseEvent,s=t.ctx.canvas;s.getBoundingClientRect();if(i.domEvent=e,i.x=t.mouseX,i.y=t.mouseY,t.mouseX=i.x,t.mouseY=i.y,i.dynArr=t.pointObjArray(i.x,i.y),t.objMouseArr.length>0){i.target=i.dynArr[i.dynArr.length-1],t.callEventClass("objmouseup",s,i);for(var o=0;o<i.dynArr.length;o++)i.dynArr[o].callEventClass("objmouseup",i.dynArr[o],i)}t.callEventClass("mouseup",s,i)},this.canvas.addEventListener("mouseup",this.getEventBridge(t.dispatchMouseUp)),t.dispatchMouseOut=function(e){var i=new n.Events.PhSimMouseEvent,s=t.ctx.canvas;s.getBoundingClientRect();i.domEvent=e,i.x=t.mouseX,i.y=t.mouseY,t.mouseX=i.x,t.mouseY=i.y,t.callEventClass("mouseout",s,i)},this.canvas.addEventListener("mouseout",this.dispatchMouseOut)},n.prototype.deregisterCanvasEvents=function(){},n.prototype.registerKeyEvents=function(){var t=this;t.windowObj=t.windowObj||window,t.keydownBridge=function(e){var i=new n.Events.PhSimEventKey;i.domEvent=e,i.key=e.key,i.code=e.code,i.type="keydown",t.callEventClass("keydown",this,i)},t.keydownBridgeWrapper=function(e){t.filter||t.keydownBridge(e)},t.windowObj.addEventListener("keydown",t.keydownBridgeWrapper)},n.prototype.deregisterKeyEvents=function(){this.windowObj.removeEventListener("keydown",self.keydownBridgeWrapper)}},function(t,e,i){i(1);const n=i(4);PhSim.Query={},PhSim.Query.getSpecialRectanglePoints=function(t){var e={center:{rel:{x:.5*t.w,y:.5*t.h},abs:{x:t.x+e.center.rel.x,y:t.h+e.center.rel.y}},sidepoint:{rel:{x:t.w,y:.5*t.h},abs:{x:e.sidepoint.rel.x+t.x,y:e.sidepoint.rel.y+t.y}}};return e},PhSim.prototype.getStatusStr=function(){return PhSim.statusStruct[this.status]},PhSim.Query.getCollisionClasses=function(t){return t.collisionClass?t.collisionClass.split(" "):[]},PhSim.prototype.getUniversalObjArray=function(){for(var t=[],e=0;e<this.matterJSWorld.composites.length;e++)for(var i=this.matterJSWorld.composites[e].bodies,n=0;n<i.length;n++)t.push(i[n]);for(e=0;e<this.matterJSWorld.bodies.length;e++)t.push(this.matterJSWorld.bodies[e]);return t},PhSim.Query.chkWidgetType=function(t){for(var e=0;e<PhSim.boolKey_lc.length;e++)if(t[PhSim.boolKey_lc[e]])return PhSim.boolKey_lc[e];return"unknown_widget"},PhSim.prototype.getStatic=function(t){return t.static||t.static?null:t.static},PhSim.prototype.getObjectByName=function(t){for(var e=0;e<this.objUniverse.length;e++)if(this.objUniverse[e].name===t)return this.objUniverse[e];return null},PhSim.prototype.collided=function(t,e){return Matter.SAT.collides(t.matter,e.matter).collided},PhSim.prototype.isInCollision=function(t){var e=this,i=!1;return this.forAllObjects((function(n){var s=e.collided(t,n);if(!0===s)return i=s,!1})),i},PhSim.Query.pointInVerts=function(t,e){var i=document.createElement("canvas").getContext("2d");i.beginPath(),i.moveTo(t[0].x,t[0].y);for(var n=0;n<t.length;n++)i.lineTo(t[n].x,t[n].y);i.closePath();var s=i.isPointInPath(e.x,e.y);return i.stroke(),s},PhSim.Query.pointInVertsBorder=function(t,e,i){if(i){var n=document.createElement("canvas").getContext("2d");n.lineWidth=i,n.beginPath(),n.lineTo(t[0].x,t[0].y);for(var s=0;s<t.length;s++)n.moveTo(t[s].x,t[s].y);n.closePath();var o=n.isPointInPath(e.x,e.y);return n.stroke(),o}return!1},PhSim.Query.deepClone=function(t){return JSON.parse(JSON.stringify(t))},PhSim.Query.pointInRectangle=function(t,e,i){var s=PhSim.Vertices.rectangle(t);return PhSim.Query.pointInVerts(s,new n(e,i))},PhSim.Query.pointInObject=function(t,e,i){if("rectangle"===t.shape)return PhSim.Query.pointInRectangle(t,e,i);if("circle"===t.shape)return n.distance(t,new n(e,i))<t.radius;if("regPolygon"===t.shape){var s=PhSim.Vertices.regPolygon(t);return PhSim.Query.pointInVerts(s,new n(e,i))}return"polygon"===t.shape?PhSim.Query.pointInVerts(t.verts,new n(e,i)):void 0},PhSim.prototype.pointInObject=function(t,e,i){return PhSim.Query.pointInObject(t,e,i)},PhSim.prototype.getDynObjectByID=function(t){for(var e=this.getUniversalObjArray(),i=0;i<e.length;i++)if(e[i].id===t)return e[i]},PhSim.prototype.pointObjArray=function(t,e){for(var i=[],n=this.objUniverse||[],s=0;s<n.length;s++)this.pointInObject(n[s],t,e)&&i.push(n[s]);return i},PhSim.prototype.getCollisionList=function(t){for(var e=[],i=0;i<this.matterJSEngine.pairs.list.length;i++){var n=this.matterJSEngine.pairs.list[i];if(n.bodyA.parent===n.bodyA&&n.bodyB.parent===n.bodyB&&(n.bodyA.plugin.dynObject.id===t.id||n.bodyB.plugin.dynObject.id===t.id)){var s=new PhSim.Events.PhSimCollision;s.bodyA=n.bodyA.plugin.dynObject,s.bodyB=n.bodyB.plugin.dynObject,s.matter=n,e.push(s)}}return e},PhSim.prototype.getCollidingObjects=function(t){for(var e=this.getCollisionList(t),i=[],n=0;n<e.length;n++)e[n].matter.bodyA.plugin.id===t.id&&i.push(e[n].bodyB),e[n].matter.bodyB.plugin.id===t.id&&i.push(e[n].bodyA);return i},PhSim.Query.getSensorClasses=function(t){return t.sensorClass?t.sensorClass.split(" "):[]},PhSim.Query.sameSensorClasses=function(t,e){return PhSim.Query.intersectionExists(PhSim.Query.getSensorClasses(t),PhSim.Query.getSensorClasses(e))},PhSim.Query.intersectionExists=function(t,e){for(var i=0;i<t.length;i++){if(-1!==e.indexOf(t[i]))return!0}return!1},PhSim.prototype.getCollidingSensorObjects=function(t){for(var e=this.getCollisionList(t),i=[],n=0;n<e.length;n++){var s=e[n],o=s.matter;o.bodyA.plugin.dynObject.id===t.id&&PhSim.Query.sameSensorClasses(t,s.bodyB)&&i.push(s.bodyB),o.bodyB.plugin.dynObject.id===t.id&&PhSim.Query.sameSensorClasses(t,s.bodyA)&&i.push(s.bodyA)}return i},PhSim.prototype.inSensorCollision=function(t){return this.getCollidingSensorObjects(t).length>0},PhSim.Query.isPointInRawRectangle=function(t,e,i,n,s,o){return!!(t<s&&s<t+i&&e<o&&o<e+n)},PhSim.prototype.getCollisionChecker=function(t,e){var i=this,n=new PhSim.CollisionReport;return n.before=null,n.current=null,n.difference=null,n.objectA=t,n.objectB=e,this.on("beforeupdate",(function(){n.before=i.collided(t,e)})),this.on("afterupdate",(function(){if(n.current=i.collided(t,e),n.difference=n.current-n.before,n.difference){var s=new PhSim.Events.PhSimDynEvent;s.report=n,s.difference=n.difference,i.callEventClass("collisionchange",i,s)}})),n}},function(t,e,i){const n=i(0);n.prototype.applyGravitationalField=function(){for(var t=this.objUniverse,e=0;e<t.length;e++)for(var i=0;i<t.length;i++)if(!(e===i||this.isNonDyn(t[e])||this.isNonDyn(t[i])||t[e].matter.isStatic||t[i].matter.isStatic)){var s=n.Vector.scale(n.Vector.subtract(t[i].matter.position,t[e].matter.position),6.67*Math.pow(10,-11)*t[e].matter.mass*t[i].matter.mass*-1),o=Math.pow(n.Vector.distance(t[i].matter.position,t[e].matter.position),3),r=n.Vector.divide(s,o);n.Motion.applyForce(t[i],t[e].matter.position,r)}}},function(t,e,i){const n=i(0);n.prototype.play=function(){this.paused=!1,this.intervalLoop=setInterval(this.loopFunction.bind(this),this.delta)},n.prototype.pause=function(){clearInterval(this.intervalLoop),this.paused=!0},n.prototype.toggle=function(){this.paused?this.play():this.pause()},n.prototype.exitSl=function(){this.callEventClass("beforeslchange",this,new n.Events.PhSimEvent("beforeslchange")),this.paused=!1,clearInterval(this.intervalLoop)},n.prototype.exit=function(){delete this.camera.dynSim,delete this.phRender.dynSim;for(var t=0;t<this.objUniverse.length;t++)delete this.objUniverse[t].phSim;this.callEventClass("exit",this,new n.Events.PhSimEvent("exit")),this.deregisterCanvasEvents(),this.deregisterKeyEvents(),this.exitSl(),Object.assign(this,new n)}},function(t,e,i){i(5);const n=i(4);t.exports=function(t){this.status=PhSim.statusCodes.INT;var e=new Map,i=this;this.firstSlUpdate=!1;var s=new PhSim.Events.PhSimEvent("slchange");s.type="slchange",this.callEventClass("beforeslchange",this,s),this.noCamera||this.camera.translate(-this.camera.x,-this.camera.y),this.ctx&&this.drawLoadingScreen(),this.simulation=this.simulations[t],this.simOptions=this.simulations[t],this.simulationIndex=t,this.ctx&&(this.width=this.ctx.canvas.width,this.height=this.ctx.canvas.height),this.paused=!1;var o=this;if(this.matterJSWorld=Matter.World.create(),this.matterJSEngine=Matter.Engine.create({world:o.matterJSWorld}),this.dynTree=[],this.objUniverse=[],this.staticSprites=[],this.staticAudio=[],this.audioPlayers=0,this.simulationEventStack=new PhSim.EventStack,this.simOptions&&this.simOptions.world&&this.simOptions.world.bg&&(this.bgFillStyle=this.simOptions.world.bg),this.simulations)for(var r=0;r<this.simOptions.layers.length;r++){this.dynTree.push([]);for(var a=0;a<this.simOptions.layers[r].objUniverse.length;a++){var c=this.simOptions.layers[r].objUniverse[a];if(c.sprite&&this.staticSprites.push(c.sprite),c.noDyn)this.addObject(c,{layer:r});else if(c instanceof PhSim.DynObject)this.addObject(c,{layer:r});else{var l=new PhSim.DynObject(c);this.addObject(l,{layer:r}),e.set(c,l)}}var h=new PhSim.Events.PhSimDynEvent;o.callEventClass("matterJSLoad",o,h)}if(Matter.Events.on(this.matterJSEngine,"collisionStart",(function(t){var e=new PhSim.Events.PhSimDynEvent;e.matterEvent=t,o.callEventClass("collisionstart",o,e)})),this.simOptions.game&&(this.lclGame=new PhSim.Game(this,this.simOptions.game)),o.simulation.widgets)for(var u=0;u<o.simulation.widgets.length;u++){if("constraint"===(h=o.simulation.widgets[u]).type){var p={};h.objectA&&(h.objectA instanceof PhSim?p.bodyA=h.objectA.matter:"number"==typeof h.objectA.L&&"number"==typeof h.objectA.O?p.bodyA=o.LO(h.objectA.L,h.objectA.O).matter:p.bodyA=e.get(h.objectA).matter),h.objectB&&(p.bodyB=o.LO(h.objectB.L,h.objectB.O).matter,h.objectB instanceof PhSim?p.bodyB=h.objectB.matter:"number"==typeof h.objectB.L&&"number"==typeof h.objectB.O?p.bodyB=o.LO(h.objectB.L,h.objectB.O).matter:p.bodyB=e.get(h.objectB).matter),h.pointA&&(h.objectA?p.pointA=n.subtract(h.pointA,p.bodyA.position):p.pointA=h.pointA),h.pointB&&(h.objectB?p.pointB=n.subtract(h.pointB,p.bodyB.position):p.pointB=h.pointB);var y=Matter.Constraint.create(p);Matter.World.add(this.matterJSWorld,y)}"connection"===h.type&&o.connectDynObjects(o.dynTree[h.objectA.L][h.objectA.O],o.dynTree[h.objectB.L][h.objectB.O]),"wFunction"===h.type&&i.createWFunction(i,h.function,h)}return this.status=PhSim.statusCodes.LOADED_DYN_OBJECTS,new Promise((function(t,e){i.phRender&&i.staticSprites.length?i.phRender.spriteImgObj=new PhSim.Sprites.spriteImgObj(i.staticSprites,(function(){t(),i.status=PhSim.statusCodes.LOADED_SPRITES})):(t(),i.status=PhSim.statusCodes.LOADED_SPRITES)})).then((function(){return new Promise((function(t,e){i.staticAudio.length?i.audioArray=new PhSim.Audio.AudioArray(i.staticAudio,(function(){i.status=PhSim.statusCodes.LOADED_AUDIO,t()})):(i.status=PhSim.statusCodes.LOADED_AUDIO,t())}))})).then((function(){o.init=!0,i.status=PhSim.statusCodes.LOADED_SIMULATION;var t=new PhSim.Events.PhSimDynEvent;i.callEventClass("load",i,t)}))}},function(t,e,i){const n=i(0);n.prototype.assignPhRender=function(t){return this.phRender=t,this.phRender.sim=this.sim,this.phRender.dynSim=this,t},n.prototype.setRadius=function(t,e){var i=e/t.radius;"regPolygon"!==t.shape&&"circle"!==t.shape||Matter.Body.scale(t.object,i,i)}},function(t,e,n){const s=n(0);s.prototype.updateDynObj=function(t){if(t.noDyn)this.phRender.renderStatic(t);else{if("circle"!==t.shape&&"regPolygon"!==t.shape&&"rectangle"!==t.shape||(t.cycle=t.firstCycle+t.matter.angle),"rectangle"===t.shape){t.matter.position.x,t.matter.positionPrev.x,t.matter.position.y,t.matter.positionPrev.y;t.x=t.matter.position.x-.5*t.w,t.y=t.matter.position.y-.5*t.h}"circle"!==t.shape&&"regPolygon"!==t.shape||(t.x=t.matter.position.x,t.y=t.matter.position.y),"polygon"===t.shape&&s.calc_skinmesh(t),this.phRender&&this.phRender.dynamicRenderDraw(t)}var e=new s.Events.PhSimEvent("objupdate");e.target=t,this.callEventClass("objupdate",this,e)},s.prototype.loopFunction=function(){if(!1===this.paused){var t=new s.Events.PhSimDynEvent;for(t.simulation=this.simulation,this.prevDate=this.prevDate&&this.updateDate,this.callEventClass("beforeupdate",this,t),this.firstSlUpdate||this.callEventClass("beforefirstslupdate",this,e),this.updateDate=new Date,this.prevDate&&(this.updateTimeInterval=this.updateDate-this.prevDate),Matter.Engine.update(this.matterJSEngine,this.delta),this.ctx&&(this.ctx.fillStyle=this.bgFillStyle,this.noCamera?this.ctx.fillRect(0,0,this.width,this.height):this.ctx.fillRect(0-this.camera.x,0-this.camera.y,this.width/this.camera.scale,this.height/this.camera.scale)),i=0;i<this.objUniverse.length;i++)this.updateDynObj(this.objUniverse[i]);this.applyGravitationalField();var e=new s.Events.PhSimDynEvent;e.simulation=this.simulation,this.sl_time=this.sl_time+this.delta,this.filter&&(this.ctx.fillStyle="rgba(3,3,3,0.7)",this.ctx.fillRect(0,0,this.width/this.camera.scale,this.height/this.camera.scale)),this.firstSlUpdate||(this.callEventClass("firstslupdate",this,e),this.firstSlUpdate=!0),this.callEventClass("afterupdate",this,e)}}},function(t,e,i){const n=i(0);n.prototype.extractWidget=function(t,e){n.Widgets[e.type]&&n.Widgets[e.type].call(this,t,e),e.name&&(this.widgets[e.name]=e);var i=this;if(e.changeSl){this.createWFunction(e.trigger,function(){var t=e.slIndex;return function(){i.gotoSimulationIndex(t)}}(),{...e,wFunctionObj:t})}e.transformWithCamera&&this.camera.transformingObjects.push(t)},n.prototype.extractWidgets=function(t){for(var e=0;e<t.widgets.length;e++)this.extractWidget(t,t.widgets[e])}},function(t,e){var i=function(t){this.dynSim=t};i.prototype.scale=1,i.prototype.x=0,i.prototype.y=0,i.prototype.targetObj=null,i.prototype.transformingObjects=[],i.prototype.zoomIn=function(t){this.scale=this.scale*t,this.dynSim.ctx.scale(t,t)},i.prototype.translate=function(t,e){this.x=this.x+t,this.y=this.y+e,this.dynSim.ctx.translate(t,e);for(var i=0;i<this.transformingObjects.length;i++)PhSim.Motion.translate(this.transformingObjects[i],t,e)},i.prototype.setPosition=function(t,e){this.dynSim.ctx.translate(-this.x,-this.y),this.x=t,this.y=e},t.exports=i},function(t,e){var i={extractGradient:function(t,e){for(var i=t.createLinearGradient(e.limits.start.x,e.limits.start.y,e.limits.end.x,e.limits.end.y),n=0;n<e.stops.length;n++)i.addColorStop(e.stops[n].pos,e.stops[n].color);return i}};t.exports=i},function(t,e,i){const n=i(0);n.Constraints={Static:{}},n.Constraints.Static.Constraint=function(){this.objectA=null,this.objectB=null,this.pointA=null,this.pointB=null,this.type="constraint"},n.prototype.getWidgetByName=function(t){for(var e=0;e<this.objUniverse.length;e++)this.objUniverse[e].getWidgetByName(t)},n.prototype.widgets={},n.Widget={},n.Widget.defineByBoolean=function(t){Object.keys(n.Widgets).forEach((function(e){t[e]&&(t.type=e)}))},n.Widget.WidgetOptions=function(t){this.type=t},n.Widgets={},n.Query.chkWidgetType=function(){},i(33),i(34),i(35);const s=i(9);n.Widgets.coin=s.Widgets.coin,n.Widgets.hazard=s.Widgets.hazard,n.Widgets.health=s.Widgets.health,n.Widgets.endGame=s.Widgets.endGame,i(36),i(37),i(38),i(39),i(40),i(41),i(42),i(43),i(44),i(45),n.Widgets.playAudio=function(t,e){var i=this,n=this.audioPlayers;this.staticAudio.push(e);this.createWFunction(t,(function(){i.playAudioByIndex(n)}),e);this.audioPlayers++},n.Widgets.noRotation=function(t){Matter.Body.setInertia(t.matter,1/0)}},function(t,e){PhSim.prototype.createCircularConstraint=function(t,e,i){var n=Matter.Constraint.create({bodyA:t.matter,pointB:{x:e,y:i}});Matter.World.add(this.matterJSWorld,n);var s=Math.atan2(i-t.matter.position.y,e-t.matter.position.x);this.on("afterupdate",(function(){var n=Math.atan2(i-t.matter.position.y,e-t.matter.position.x)-s;PhSim.Motion.setAngle(t,n)})),t.circularConstraintVector={x:e,y:i}},PhSim.Widgets.circularConstraint=function(t,e){this.createCircularConstraint(t,e.x,e.y)}},function(t,e,i){const n=i(0);n.prototype.cloneObject=function(t,e={}){var i=new n.DynObject(t.static);i.cloned=!0,i.cloneParent=t,n.Motion.setVelocity(i,e.velocity),this.addToOverlayer(i);var s=new n.Events.PhSimEvent("clone");s.target=t,s.clonedObj=i,this.callEventClass("clone",this,s)},n.Widgets.clone=function(t,e){var i=this,n={velocity:e.vector};if("time"===e.trigger){var s=(o=function(){var s=e.time,o=e.maxN,r=null;return Number.isInteger(o)?(r=function(e){r.__n===o?clearInterval(r.__interN):i.paused||(i.cloneObject(t,n),r.__n++)}).__n=0:r=function(e){i.paused||i.cloneObject(t,n)},r.__phtime=s,r.__interN=null,r})();s.__interN=setInterval(s,s.__phtime)}if("key"===e.trigger){var o=function(){var s=e.key;e.vector;return function(e){e.key===s&&i.cloneObject(t,n)}};this.on("keydown",o())}}},function(t,e){PhSim.Widgets.draggable=function(t,e){var i,n,s,o,r,a=this;this.on("mousedown",(i={},n={x:null,y:null},s=function(t){n.x=t.x-i.x,n.y=t.y-i.y},o=function(){a.off("mousemove",s),a.off("mouseup",o),a.off("beforeupdate",r)},r=function(){Matter.Body.setVelocity(t.matter,{x:0,y:0}),PhSim.Motion.setPosition(t,n)},a.on("mouseout",o),function(e){a.pointInObject(t,e.x,e.y)&&(i.x=e.x-t.matter.position.x,i.y=e.y-t.matter.position.y,a.on("mousemove",s),a.on("mouseup",o),a.on("beforeupdate",r),s(e))}))}},function(t,e,i){const n=i(0);n.prototype.setLock=function(t,e){t.locked=e,Matter.Body.setStatic(t.matter,e)},n.prototype.toggleLock=function(t){this.setLock(t,!t.locked)},n.prototype.toggleSemiLock=function(t){t.locked=!t.locked,Matter.Body.setStatic(t.matter,t.locked)},n.Widgets.toggleLock=function(t,e){var i,n=this;this.createWFunction(t,(i=t,function(){n.toggleLock(i)}),e)},n.Widgets.toggleSemiLock=function(t,e){var i,n=this;this.createWFunction(t,(i=t,function(){n.toggleSemiLock(i)}),e)}},function(t,e,i){const n=i(8);PhSim.prototype.createMotionFunction=function(t,e,i){return"force"===t?function(){return n.applyForce(e,e.matter.position,i)}:"velocity"===t?function(){return n.setVelocity(e,i)}:"translate"===t?function(){return n.translate(e,i)}:"position"===t?function(){return n.setPosition(e,i)}:"rotation"===t?function(){return n.rotate(e,i,e.matter.position)}:"circular_constraint_rotation"===t?function(){return n.rotate(e,i,e.circularConstraintVector)}:"setAngle"===t?function(){return n.setAngle(e,i)}:"circular_constraint_setAngle"===t?function(){var t=Math.atan2(e.y-e.circularConstraintVector.y,e.x-e.circularConstraintVector.x);n.rotate(e,-t,e.circularConstraintVector),n.rotate(e,i,e.circularConstraintVector)}:console.error("Parameter 'mode' must either be equal to the one of the following strings: 'force','velocity' or 'position'.")},PhSim.Widgets.velocity=function(t,e){var i=this.createMotionFunction("velocity",t,e.vector);this.createWFunction(t,i,e)},PhSim.Widgets.translate=function(t,e){var i=this.createMotionFunction("translate",t,e.vector);this.createWFunction(t,i,e)},PhSim.Widgets.position=function(t,e){var i=this.createMotionFunction("position",t,e.vector);this.createWFunction(t,i,e)},PhSim.Widgets.rotation=function(t,e){if(e.circularConstraintRotation)var i=this.createMotionFunction("circular_constraint_rotation",t,e.cycle);else i=this.createMotionFunction("rotation",t,e.cycle);this.createWFunction(t,i,e)},PhSim.Widgets.setAngle=function(t,e){if(e.circularConstraintRotation)var i=this.createMotionFunction("circular_constraint_setAngle",t,e.cycle);else i=this.createMotionFunction("setAngle",t,e.cycle);this.createWFunction(t,i,e)},PhSim.Widgets.force=function(t,e){var i=this.createMotionFunction("force",t,e.vector);this.createWFunction(dynObject,i,e)}},function(t,e,i){const n=i(1);PhSim.prototype.callObjLinkFunctions=function(t){for(var e=0;e<t.objLinkFunctions.length;e++)t.objLinkFunctions[e]()},PhSim.Widgets.objLink=function(t,e){var i=this,s=e;this.on("load",(function(){if("number"==typeof e.target.L&&"number"==typeof e.target.O)var o=i.LO(s.target.L,s.target.O);else if(e.target instanceof n)o=e.target;i.createWFunction(t,(function(){i.callObjLinkFunctions(o)}),e)}))}},function(t,e,i){const n=i(0);n.prototype.wFunctions=[],n.prototype.wFunctionRefs=[],n.prototype.createWFunction=function(t,e,i){var n=this;"number"==typeof e&&(e=this.wFunctions[e]),"string"==typeof e&&(e=new Function("e",i.function));var s=function(i){return e.apply(t,i)};if(s._options=i,s._bodyFunction=e,s._thisRef=t,i._name&&(n.wFunctionNames[i._name]=s),"key"===i.trigger){if(i.key)var o=function(t){t.key.match(new RegExp("^"+i.key+"$","i"))&&s(t)};else o=function(t){s(t)};s._ref=o,s._eventclass="keydown"}else if("sensor"===i.trigger||"sensor_global"===i.trigger){n=this;o="sensor"===i.trigger?function(e){n.inSensorCollision(t)&&s(e)}:function(t){s(t)},s._ref=o,s._eventclass="collisionstart"}else if("update"===i.trigger){o=function(){s()};s._ref=o,s._eventclass="beforeupdate"}else if("objclick"===i.trigger||"objclick_global"===i.trigger){o="objclick"===i.trigger?function(e){n.objMouseArr[n.objMouseArr.length-1]===t&&s(e)}:function(t){s(t)},s._eventclass="objclick",s._ref=o}else if("objmousedown"===i.trigger||"objmousedown_global"===i.trigger){if("objmousedown"===i.trigger)o=function(e){n.objMouseArr[n.objMouseArr.length-1]===t&&s(e)};else o=function(t){s(t)};s._eventclass="objmousedown",s._ref=o}else if("firstslupdate"===i.trigger){o=function(t){s(t)};s._ref=o,s._eventclass="firstslupdate"}else if("objmouseup"===i.trigger||"objmouseup_global"===i.trigger){if("objmouseup"===i.trigger)o=function(e){n.objMouseArr[n.objMouseArr.length-1]===t&&s(e)};else o=function(t){s(t)};s._eventclass="objmouseup",s._ref=o}else{if("objlink"===i.trigger)return t.objLinkFunctions=t.objLinkFunctions||[],t.objLinkFunctions.push(s),s._ref=o,s;if("afterslchange"===i.trigger){o=function(t){s(t)};s._eventclass="afterslchange",s._ref=o}else{if("time"===i.trigger){var r=(Number.isInteger(i.maxN)?(func=function(t){func.__n===i.maxN?clearInterval(func.__interN):n.paused||(s(),func.__n++)},func.__n=0):func=function(t){n.paused||s()},func.__phtime=i.time,func.__interN=null,func);return r.__interN=setInterval(r,r.__phtime),s._ref=r.__interN,s}s._ref=s,s._eventclass=i.trigger}}return"string"==typeof s._eventclass&&n.on(s._eventclass,s._ref,{slEvent:!0}),s},n.prototype.disableWFunction=function(t){if("string"==typeof t._eventclass)this.off(t._eventclass,t._ref);else if("time"===t._options.trigger)clearInterval(t._ref);else if("time"===t._options.trigger)clearInterval(t._ref);else if("objlink"===t._options.trigger){var e=t._thisRef.objLinkFunctions.indexOf(t);t._thisRef.objLinkFunctions.splice(e,1)}t._name&&delete this.wFunctionNames[t._name]},n.Widgets.wFunction=function(t,e){this.createWFunction(t,e.function,e)},n.prototype.wFunctionNames={}},function(t,e){PhSim.Widgets.elevator=function(t,e){this.on("afterupdate",function(){var i,n,s,o,r=e.bounding,a=t,c=PhSim.Vector.subtract(e.pointB,e.pointA),l=PhSim.Vector.unitVector(c),h=!0,u=function(){};"x"===r&&(e.pointA.x<e.pointB.x&&(i=e.pointA.x,s=e.pointB.x),e.pointB.x<e.pointA.x&&(i=e.pointB.x,s=e.pointA.x),u=function(){return i<=a.matter.position.x&&a.matter.position.x<=s}),"y"===r&&(e.pointA.y<e.pointB.y&&(n=e.pointA.y,o=e.pointB.y),e.pointB.y<e.pointA.y&&(n=e.pointB.y,o=e.pointA.y),u=function(){return n<=a.matter.position.y&&a.matter.position.y<=o}),Matter.Body.setStatic(t.matter,!0);return function(){u()?(PhSim.Motion.translate(a,PhSim.Vector.scale(l,1)),h=!0):h?(l={x:-l.x,y:-l.y},h=!1):PhSim.Motion.translate(a,PhSim.Vector.scale(l,1))}}())}},function(t,e){PhSim.prototype.addKeyboardControls=function(t,e){this.on("keydown",(function(i){"ArrowRight"==i.code&&Matter.Body.setVelocity(t.matter,{x:e.right,y:0}),"ArrowUp"==i.code&&Matter.Body.setVelocity(t.matter,{x:0,y:-e.up}),"ArrowLeft"==i.code&&Matter.Body.setVelocity(t.matter,{x:-e.left,y:0}),"ArrowDown"==i.code&&Matter.Body.setVelocity(t.matter,{x:0,y:e.down})}),{slEvent:!0})},PhSim.Widgets.keyboardControls=function(t,e){this.addKeyboardControls(t,e)}},function(t,e){PhSim.Widgets.transformCameraByObj=function(t){var e=this;this.on("afterupdate",(function(){var i=t.matter.position.x-t.matter.positionPrev.x,n=t.matter.position.y-t.matter.positionPrev.y;e.camera.translate(-i,-n)}),{slEvent:!0})}},function(t,e){PhSim.Widgets.setColor=function(t,e){var i,n;this.createWFunction(t,(i=e.color,n=t,function(){PhSim.DynObject.setColor(n,i)}),e)},PhSim.Widgets.setBorderColor=function(t,e){var i,n;this.createWFunction(t,(i=e.color,n=t,function(){PhSim.DynObject.setBorderColor(n,i)}),e)},PhSim.Widgets.setLineWidth=function(t,e){var i=function(){PhSim.DynObject.setLineWidth(t,e.width)};i=this.createWFunction(t,i,e)}},function(t,e){PhSim.Widgets.deleteSelf=function(t,e){var i,n=this;i=this.createWFunction(t,(function(){n.removeDynObj(t),n.disableWFunction(i)}),e)}},function(t,e){PhSim.Widgets.stack=function(t,e){for(var i=[],n=1;n<=e.rows;n++){var s=this.cloneObject(t);PhSim.Motion.transform(s,{x:e.rowDist*n,y:0}),i.push(s)}for(n=1;n<=e.columns;n++){s=this.cloneObject(t);PhSim.Motion.transform(s,{x:0,y:e.colDist*n}),i.push(s)}}},function(t,e){t.exports=function(t){t.transformVector={x:t.matter.position.x-t.matter.positionPrev.x,y:t.matter.position.y-t.matter.positionPrev.y};var e=t.matter.angle-t.matter.anglePrev;Matter.Vertices.translate(t.skinmesh,Matter.Vertices.centre(t.skinmesh),-1),Matter.Vertices.rotate(t.skinmesh,e,{x:0,y:0}),Matter.Vertices.translate(t.skinmesh,t.matter.position,1),t.verts=t.skinmesh,t.verts=t.skinmesh}},function(t,e){},function(t,e,i){const n=i(0);n.prototype.vars={},n.prototype.magicWords={},n.MagicWords={__test1:function(){return"4"},__game__score:function(){return this.lclGame&&this.lclGame.score},__game__life:function(){return this.lclGame&&this.lclGame.life},__game__goal:function(){return this.lclGame&&this.lclGame.goal},__game__int_life:function(){return this.lclGame&&this.lclGame.intLife},__game__int_score:function(){return this.lclGame&&this.lclGame.intScore}},n.addGlobalMagicalWord=function(t,e){if(n.MagicWords[t])throw"Magical word "+t+" already exists.";n.MagicWords[t]=e},n.prototype.addLocalMagicalWord=function(t,e){if(this.magicWords[t])throw"Magical word "+t+" already exists.";this.magicWords[t]=e},n.prototype.processVar=function(t){t=t;for(var e=Object.keys(n.MagicWords),i=0;i<e.length;i++){var s=e[i],o=new RegExp("{"+s+"}","g");-1!==t.search(o)&&(t=t.replace(o,n.MagicWords[s].call(this)))}var r=Object.keys(this.vars);for(i=0;i<r.length;i++){var a="\\$\\{"+r[i]+"\\}",c=new RegExp(a,"g");-1!==t.search(c)&&(t=t.replace(c,this.vars[r[i]]))}return t}},function(t,e,i){const n=i(0),s={global:function(t,e){if(t instanceof n)for(var i=0;i<t.objUniverse.length;i++)e(t.objUniverse[i]);else for(i=0;i<t.simulations.length;i++)for(var s=0;s<t.simulations[i].layers.length;s++)for(var o=0;o<t.simulations[i].layers[s].objUniverse.length;o++)e(t.simulations[i].layers[s].objUniverse[o])},simulation:function(t,e){for(var i=0;i<t.layers.length;i++)for(k=0;k<t.layers[i].objUniverse.length;k++)e(t.layers[i].objUniverse[k])},layer:function(t,e){for(k=0;k<t.objUniverse.length;k++)e(t.objUniverse[k])}};t.exports=s}]);