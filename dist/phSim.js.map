{"version":3,"sources":["core.js","objects.js","eventStack.js","phRender.js","sprites.js","audio.js","tools/vectorTools.js","tools/objectChecker.js","tools/diagRect.js","tools/vertex.js","tools/centroid.js","tools/boundingBox.js","tools/tools.js","dynSim/lo.js","dynSim/makeQuickly.js","dynSim/filter.js","dynSim/audioToggle.js","dynSim/registerEvents.js","dynSim/eventListener.js","dynSim/gravity.js","dynSim/toggle.js","dynSim/gotoSuperlayer.js","dynSim/matterAliases.js","dynSim/set.js","dynSim/update.js","dynSim/extractWidgets.js","dynSim/dynSim.js","dynSimCamera.js","gradient.js","widgets.js","collisionClass.js","dynObject.js","calc_skinmesh.js","simpleEvent.js","processVar.js","phSim.js","../node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["PhSim","name","version","window","Objects","GradientLimits","x0","y0","x1","y1","start","Vector","end","GradientStop","pos","color","Gradient","stops","limits","x","y","lclGradient","src","type","Path","verts","path","Circle","circle","radius","cycle","RegPolygon","r","n","regPolygon","sides","Rectangle","w","h","rectangle","Composite","composite","SimBox","width","height","Camera","scale","c","Layer","objUniverse","simulation","layers","push","world","grav","bg","border","unit","widgets","CompositeSimulation","simulations","box","camera","EventStack","contact","beforeupdate","objupdate","afterupdate","beforeslchange","afterslchange","beforespriteimgload","afterspriteimgload","beforeforcekey","mouseup","mouseout","mousemove","keydown","collisionstart","collisionactive","collisionend","beforecounterset","aftercounterset","collisionchange","load","matterJSLoad","clone","objmousedown","objmouseover","objmouseout","firstslupdate","exit","PhRender","ctx","prototype","defaultAlpha","defaultStrokeStyle","defaultFillStyle","setCtx","object","lineCap","globalAlpha","strokeStyle","fillStyle","lineWidth","static_path","beginPath","moveTo","j","length","lineTo","closePath","stroke","fill","sprite","img","spriteImgArray","centroid","findCentroidOfPath","imageSmoothingEnabled","smooth","repeat","save","translate","pattern","createPattern","restore","fit","clip","Tools","getStaticBoundingBox","renderSpriteByCenter","url","a","spriteImg","rotate","drawImage","renderConstraint","constraint","SLO","S","L","O","arc","point","Math","PI","relativeEndPoint","setLineDash","static_circle","gradient","Gradients","extractGradient","static_rectangle","getRectangleCentroid","rect","i","rectText","Number","isInteger","text","textAlign","undefined","borderColor","font","size","textBaseline","content","dynSim","processVar","fillText","strokeText","static_regPolygon","vertSet","getRegPolygonVerts","center","renderStatic","obj","renderStaticLayer","layer","hidden","dynamicSkeleton","static","skinmesh","matter","vertices","dynamicSkeleton_center","position","drawDynamicSkeleton","dynamicRenderDraw","arg","angle","parts","dynamicDrawLayer","sim","simulationI","Sprites","Calc","Sprite","renderSprite","localElm","document","createElement","spec","auto","renderGlobalSprites","sprites","circularSpriteRenderCanvas","canvas","localCtx","getContext","localImg","SpriteImgArray","onload","loaded_n","loaded","self","addSprite","staticObj","addEventListener","Audio","AudioArray","p_audio","array","audio","loop","addVectors","vector1","vector2","subtractVectors","scaleVector","vector","scalar","divideVector","calcVertDistance","l1","pow","l2","sqrt","getVectorLength","getUnitVector","applyTransformation","a11","a12","a21","a22","rotatedVector","cos","sin","objectTypes","regularPolygon","checkObjectType","objectTypeStr","diagRect","x2","y2","v","firstAngle","getRectangleVertArray","Matter","Vertices","getRectangleCorners","z","getVertBoundingBox","JSON","parse","stringify","o","sort","b","smallX","largeX","smallY","largeY","ax","ay","bx","by","flat","Infinity","getDynBoundingBox","dynObj","bounds","min","max","DynSim","matterJSEngine","composites","LO","dynTree","getObjectFromLOStr","str","split","createFromCanvas","p","simCanvas","simCtx","registerCanvasEvents","configRender","createFromContainer","simContainer","appendChild","classList","add","configFilter","createContainer","container","loadFromJSON","jsonURL","XMLHttpRequest","open","responseText","send","assignPhRender","noCamera","DynSimCamera","htmlFilter","style","background","display","enableFilter","elmBox","getBoundingClientRect","left","floor","disableFilter","toggleFilter","alert","options","alertBox","backgroundColor","bgColor","txtColor","fontSize","alertBoxMsg","className","innerText","msg","padding","closeButton","onok","closeButtonTxt","offsetWidth","top","offsetHeight","playAudioByIndex","audioArray","play","pauseAudioByIndex","pause","setAudioVolByIndex","volume","setAudioMuteByIndex","muted","toggleAudioByIndex","eventStack","mousedown","mousedownBridge","e","eventObj","PhMouseEvent","domEvent","clientX","clientY","dynArr","pointObjArray","paused","objMouseArr","callEventClass","filter","click","objclick","clickBridge","objmousemove","mousemoveBridge","mouseX","mouseY","prevMouseX","prevMouseY","prevObjMouseArr","formerMouseObjs","newMouseObjs","init","pointInObject","includes","objmouseup","mouseupBridge","mouseoutBridge","registerKeyEvents","keydownBridge","PhKeyEvent","key","code","keydownBridgeWrapper","deregisterKeyEvents","removeEventListener","eventStr","call","slEvent","slEventStack","once","f","Error","callIndex","indexOf","splice","thisArg","eventArg","func","applyGravitationalField","isStatic","a1","mass","b1","applyForce","initSim","toggle","exitSl","PhEvent","clearInterval","intervalLoop","gotoSimulationIndex","firstSlUpdate","event","drawLoadingScreen","simulationIndex","this_a","matterJSWorld","World","create","staticSprites","staticAudio","audioPlayers","collisionClasses","Engine","ncc","CollisionClass","engine","layerComposite","layerBranch","noDyn","permStatic","dynObject","DynObject","collisionClass","trim","getCollisionClasses","addDynObject","extractWidgets","PhDynEvent","Events","on","matterEvent","game","lclGame","extractLclGame","C","objectA","bodyA","objectB","bodyB","pointA","pointB","Constraint","connection","connectDynObjects","promise","Promise","resolve","reject","phRender","then","setInterval","loopFunction","bind","delta","dynsimulation","status","forceVector","Body","setVelocity","velocityVector","translationVector","setPosition","positionVector","setAngle","setRadius","ratio","setRectWidthAndHeight","setColor","dyn_object","colorStr","setBorderColor","setLineWidth","updateDynObj","currentObj","firstCycle","positionPrev","calc_skinmesh","target","beforeUpdateEvent","prevDate","updateDate","Date","updateTimeInterval","update","fillRect","afterUpdateEvent","sl_time","extractWidget","widget","changeSl","closure","slIndex","addSimpleEvent","trigger","triggerObj","numVar","value","keyboardControls","addKeyboardControls","circularConstraint","createCircularConstraint","setNumVar","force","createMotionFunction","velocity","rotation","circularConstraintRotation","deleteSelf","ref","removeDynObj","removeSimpleEvent","toggleLock","getFunction","time","maxN","__n","__interN","spawnObject","__phtime","refFunc","kc","vc","cloneByKeyFunc","draggable","change","__ismoving","mV","__onmousemove","__onmouseup","__onbeforeupdate","__onmousedown","rectTextWidget","coin","obj1","inSensorCollision","setScore","score","hazard","decrementLife","health","incrementLife","noRotation","setInertia","elevator","relVec","u","reversable","cond_f","setStatic","inRange","endGame","playAudio","transformCameraByObj","dx","dy","transformWithCamera","transformingObjects","cameraWindow","objLink_a","widgetO","eventFuncClosure","targetObj","eventFunc","callObjLinkFunctions","nextId","statusStruct","forAllObjects","getUniversalObjArray","addToOverlayer","zoomIn","scaleFactor","loading","bgClr","txtClr","txtAlign","txtSize","txtFace","txt","localSettings","intLife","life","goal","intScore","parentNode","removeChild","setLife","jsObject","createLinearGradient","addColorStop","Widgets","Velocity","Force","Position","Translate","Clone","timeCloner","copyWidgets","DeleteSelf","PointInWidgetsReturn","pointInWidgetsReturn","Draggable","Coin","Hazard","Health","Elevator","TransformCameraByObj","TransformWithCamera","KeyboardControls","up","down","right","SimpleEvent","simpleEvent","action","args","InputBox","buttonTxt","inputBox","Alert","actionStruct","Connection","Rotation","SetAngle","NoRotation","RectText","margin","borderSize","NumVar","SetNumVar","SetColor","SetBorderColor","SetLineWidth","Game","PlayAudio","valueStruc","textBaseLine","direction","ObjLink_a","ToggleLock","CircularConstraint","alignStruct","Constraints","Static","SingleObjectConstraint","damping","DoubleObjectConstraint","rel1","rel2","doubleObjectConstraint","staticObject","opts","label","locked","density","inverseMass","collisionNum","collisionFilter","Bodies","fromVertices","centre","set","id","parseInt","toString","plugin","ph","transformVector","transformAngle","anglePrev","SimpeEventRef","simpleEventRefs","match","m","objLinkFunctions","refNumber","search","replace","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","console","clear","hmrApply","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","getElementById","remove","stackTrace","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"phSim.js","sourceRoot":"../src","sourcesContent":["var PhSim = {}\nPhSim.name = \"phsim\"\nPhSim.version = \"1\"\n\nif(typeof window === \"object\") {\n\twindow.PhSim = PhSim;\n}","PhSim.Objects = {}\n\nPhSim.Objects.GradientLimits = function(x0,y0,x1,y1) {\n    this.start = new Vector(x0,y0);\n    this.end = new Vector(x1,y1);\n}\n\nPhSim.Objects.GradientStop = function(pos,color) {\n\tthis.color = color;\n\tthis.pos = pos;\n}\n\n\nPhSim.Objects.Gradient = function() {\n\tthis.stops = [];\n\tthis.name = \"\";\n\n\tthis.limits = {\n\n\t\tstart: {\n\t\t\tx: null,\n\t\t\ty: null\n\t\t},\n\n\t\tend: {\n\t\t\tx: null,\n\t\t\ty: null\n\t\t}\n\n\t};\n}\n\nPhSim.Objects.lclGradient = function() {\n\tthis.src = null;\n\tthis.limits = new PhSim.Objects.GradientLimits(x0,y0,x1,y1);\n\tthis.type = \"linear\";\n}\n\n\nPhSim.Objects.Path = function() {\n\n\t/**\n\t * Array of vectors defining a path or a polygon\n\t * @type {PhSim.Objects.Vector}\n\t */\n\n\tthis.verts = [];\n\n\t/**\n\t * Boolean indicating it is a path\n\t * @type {Boolean}\n\t */\n\n\tthis.path = true;\n}\n\n\n/**\n * Circle constructor\n * \n */\n\nPhSim.Objects.Circle = function() {\n\n\t/**\n\t * Boolean indicating a circle\n\t * @type {Boolean}\n\t */\n\n\tthis.circle = true,\n\n\t/**\n\t * x-coordinate of the center\n\t * @type {Number}\n\t */\n\n\tthis.x = null;\n\n\t/**\n\t * y-coordinate of the center\n\t * @type {Number}\n\t */\n\n\tthis.y = null;\n\n\t/**\n\t * Radius of the circle\n\t * @type {Number}\n\t */\n\n\tthis.radius = null\n\n\t/**\n\t * Angle of the circle\n\t * @type {Number}\n\t */\n\n\tthis.cycle = null;\n}\n\n/**\n * Regular Polygon Constructor\n */\n\nPhSim.Objects.RegPolygon = function(x,y,r,n) {\n\n\t/**\n\t * Boolean for indicating a regular polygon\n\t * @type {Boolean}\n\t */\n\n\tthis.regPolygon =  true;\n\n\t/**\n\t * x-coordinate of the center of the regular polygon\n\t * @type {Number}\n\t */\n\n\tthis.x = x;\n\n\t/**\n\t * y-coordinate for the center of the regular polygon\n\t * @type {Number}\n\t */\n\n\tthis.y = y;\n\n\t/**\n\t * The radius of the regular polygon\n\t * @type {Number}\n\t */\n\n\tthis.radius = r;\n\n\t/**\n\t * The angle of the regular polygon\n\t * @type {Number}\n\t */\n\n\tthis.cycle = null;\n\n\t/**\n\t * The number of sides the regular polygon has\n\t * @type {Number}\n\t */\n\n\tthis.sides = n;\n}\n\n/**\n * \n * Constructor for a static Rectangle\n * \n * @constructor Rectangle\n * @param {Number} x \n * @param {Number} y \n * @param {Number} w \n * @param {Number} h \n * \n */\n\nPhSim.Objects.Rectangle = function(x,y,w,h) {\n\n\t/**\n\t * Boolean for indicating a rectangle\n\t * @type {Boolean}\n\t */\n\n\tthis.rectangle = true;\n\n\t/**\n\t * x-coordinate of the upper left corner of the rectangle\n\t * @type {Number}\n\t */\n\n\tthis.x = x;\n\n\t/**\n\t * y-coordinate of the upper left corner of the rectangle\n\t * @type {Number}\n\t */\n\n\tthis.y = y;\n\n\t/**\n\t * Width of rectangle\n\t * @type {Number}\n\t */\n\n\tthis.w = w;\n\n\t/**\n\t * Height of rectangle\n\t * @type {Number}\n\t */\n\n\tthis.h = h;\n\n\t/**\n\t * Angle of rectangle\n\t * @type {Number}\n\t */\n\n\tthis.cycle = 0;\n}\n\n/**\n * \n * Static Object Type\n * \n * @typedef {PhSim.Objects.Rectangle | PhSim.Objects.Circle | PhSim.Objects.RegPolygon | PhSim.Objects.Path} StaticObject\n * \n */\n\n /*** \n * Composite Object \n */\n\nPhSim.Objects.Composite = function() {\n\tthis.composite = true;\n\tthis.name = \"Untitled\";\n}\n\n/*** \n * Simulation Box Object \n * \n * @param {Number} w\n * @param {Number} h\n * \n */\n\nPhSim.Objects.SimBox = function(w,h) {\n\t\n\t/**\n\t * Simulation Width\n\t * @type {Number}\n\t */\n\n\tthis.width = w;\n\n\t/**\n\t * Simulation Height\n\t * @type {Number}\n\t */\n\n\tthis.height = h;\n}\n\n/*** Simulation Camera **/\n\nPhSim.Objects.Camera = function(x,y,scale) {\n\n\t/**\n\t * x-coordinate vector of camera\n\t * @type {Number}\n\t */\n\n\tthis.x = x;\n\n\t/**\n\t * y-coordinate vector of camera\n\t * @type {Number}\n\t */\n\n\tthis.y = y;\n\n\t/**\n\t * Scaling factor of camera\n\t */\n\n\tthis.c = scale;\n}\n\n/**\n * Layer constructor\n */\n\nPhSim.Objects.Layer = function() {\n\n\t/**\n\t * The array of objects\n\t * @type {StaticObject[]}\n\t */\n\n\tthis.objUniverse = [];\n\n\t/**\n\t * The name of the layer\n\t * @type {String}\n\t */\n\n\tthis.name = null;\n}\n\n/*** \n * simulation Object \n * \n * */\n\nPhSim.Objects.simulation = function() {\n\n\t/**\n\t * Array of layers\n\t * @type {PhSim.Objects.Layer[]}\n\t */\n\n\tthis.layers = [];\n\n\tthis.layers.push(new PhSim.Objects.Layer())\n\tthis.world = {\n\t\tgrav: 1,\n\t\tbg: \"white\",\n\t\tborder: null,\n\t\tunit: 1\n\t}\n\n\t/**\n\t * Property indicating a simulation\n\t * @type {Boolean}\n\t * \n\t */\n\n\tthis.simulation = true;\n\tthis.widgets = [];\n}\n\n/**\n * Simulation Object\n * @constructor\n * \n */\n\nPhSim.Objects.CompositeSimulation = function() {\n\n\t/**\n\t * PhSim version\n\t * @type {Number}\n\t */\n\n\tthis.version = 1;\n\n\t/** \n\t * PhSim Static simulation Array \n\t * @type {PhSim.Objects.simulation[]}\n\t */\n\n\tthis.simulations = [];\n\t\n\tthis.simulations.push(new PhSim.Objects.simulation());\n\tthis.simulations[0].layers[0].name = \"Untitled Layer\"\n\tthis.simulations[0].name = \"Untitled simulation\";\n\n\t/** PhSim Box Settings */\n\n\tthis.box = new PhSim.Objects.SimBox(800,600);\n\n\t/** PhSim Camera */\n\n\tthis.camera = new PhSim.Objects.Camera(0,0,1);\n\n}\n\n/*** \n * Vector \n * \n * @param {Number} x \n * @param {Number} y\n * \n */\n\nPhSim.Objects.Vector = function(x, y) {\n\tthis.x = x;\n\tthis.y = y;\n}\n\n","PhSim.EventStack = function() {\n\n\t/** \n\t * \n\t * Array of functions to be executed whenever two or more objects contact each other \n\t * @type {PhSimEventCall[]}\n\t * \n\t*/\n\n\tthis.contact = [];\n\n\t/** \n\t * \n\t * Array of functions to be executed before the simulation updates \n\t * \n\t * @type {PhSimEventCall[]}\n\t * \n\t * */\n\n\tthis.beforeupdate = [];\n\n\t/** \n\t * \n\t * Array of functions to be exected when PhSim.DynSim.updateDynObject is called \n\t * \n\t * @type {PhSimEventCall[]}\n\t * \n\t * */\n\n\tthis.objupdate = [];\n\n\n\t/** \n\t * \n\t * Array of functions to be executed after the simulation updates \n\t * \n\t * @type {PhSimEventCall[]}\n\t * \n\t * */\n\n\tthis.afterupdate = [];\n\n\t/** \n\t * \n\t * Array of functions to be executed before the simulation is changed \n\t * \n\t * @type {PhSimEventCall[]}\n\t * \n\t * */\n\n\tthis.beforeslchange = [];\n\n\t/** \n\t * \n\t * Array of functions to be executed after the simulation is changed \n\t * \n\t * @type {PhSimEventCall[]}\n\t * \n\t * */\n\n\tthis.afterslchange = [];\n\n\t/** \n\t * \n\t * Array of functions to be executed before the Sprite Image Array loads \n\t * \n\t * @type {PhSimEventCall[]}\n\t * \n\t * */\n\n\tthis.beforespriteimgload = [];\n\n\t/** Array of functions to be executed after the Sprite Image Array loads */\n\n\tthis.afterspriteimgload = [];\n\tthis.beforeforcekey = [];\n\n\t/** Array of functions to be executed when mouse is let go while over simulation canvas */\n\n\tthis.mouseup = [];\n\n\t/** Array of functions to be executed when mouse leaves simulation canvas */\n\n\tthis.mouseout = [];\n\n\t/** Array of functions to be executed when the mouse moves */\n\n\tthis.mousemove = [];\n\n\t/** Array of functions to be executed when at least one key is pressed */\n\n\tthis.keydown = [];\n\n\t/** Array of functions to be executed when a new collision is created */\n\n\tthis.collisionstart = [];\n\n\t/** Array of functions to be executed during an active collision */\n\n\tthis.collisionactive = [];\n\n\t/** Array of functions to be executed when a new collision is deleted */\n\n\tthis.collisionend = [];\n\n\tthis.beforecounterset = [];\n\n\tthis.aftercounterset = [];\n\n\tthis.collisionchange = [];\n\n\tthis.load = [];\n\n\tthis.matterJSLoad = [];\n\n\t/** Array of functions to be executed when an object is cloned */\n\n\tthis.clone = [];\n\n\tthis.objmousedown = [];\n\n\tthis.objmouseover = [];\n\n\tthis.objmouseout = [];\n\n\t/** Array of functions  */\n\n\tthis.firstslupdate = [];\n\n\t/** Array of functions to be executed before the simulation exit */\n\n\tthis.exit = []\n}","/*** \n * \n * PhRender\n * \n * @constructor PhRender\n * @param {CanvasRenderingContext2D} ctx - Canvas context\n * \n ***/\n\nPhSim.PhRender = function(ctx) {\n\n\t/**\n\t * PhRender Context\n\t */\n\n\tthis.ctx = ctx;\n}\n\n/**\n * Default Alpha\n * @type {Number}\n */\n\nPhSim.PhRender.prototype.defaultAlpha = 1;\n\n/**\n * Default stroke style\n * @type {String}\n */\n\nPhSim.PhRender.prototype.defaultStrokeStyle = \"transparent\";\n\n/**\n * Default fill style\n * @type {String}\n */\n\nPhSim.PhRender.prototype.defaultFillStyle = \"transparent\";\n\n/**\n * Setting context\n * \n * @function setCtx\n * @param {Object} object \n */\n\nPhSim.PhRender.prototype.setCtx = function(object) {\n\tthis.ctx.lineCap = \"round\";\n\n\tif(typeof this.ctx.globalAlpha === \"number\") {\n\t\tthis.ctx.globalAlpha = object.globalAlpha\n\t}\n\n\telse {\n\t\tthis.ctx.globalAlpha = this.defaultAlpha;\n\t}\n\n\tthis.ctx.strokeStyle = object.strokeStyle || this.defaultStrokeStyle;\n\tthis.ctx.fillStyle = object.fillStyle || this.defaultFillStyle;\n\n\tif(object.lineWidth) {\n\n\t\tif(object.lineWidth === 0) {\n\t\t\tthis.ctx.strokeStyle = \"transparent\"\n\t\t}\n\n\t\telse {\n\t\t\tthis.ctx.lineWidth = object.lineWidth;\n\t\t}\n\n\t}\n\n\telse {\n\t\tthis.ctx.strokeStyle = \"transparent\"\n\t}\n\t\n}\n\n/**\n * \n * @param {*} path \n */\n\nPhSim.PhRender.prototype.static_path = function (path) {\n\n\tthis.setCtx(path);\n\n\tthis.ctx.beginPath();\n\n\tthis.ctx.moveTo(path.verts[0].x, path.verts[0].y);\n\n\tfor(var j = 0; j < path.verts.length; j++) {\n\t  this.ctx.lineTo(path.verts[j].x, path.verts[j].y);\n\t}\n\n\tthis.ctx.closePath();\n\t\n\tthis.ctx.stroke();\n\tthis.ctx.fill();\n\n\tif(path.sprite) {\n\n\t\tvar img = this.spriteImgArray[path.sprite.src];\n\n\t\tvar centroid = findCentroidOfPath(path);\n\n\t\tthis.ctx.imageSmoothingEnabled = path.sprite.smooth;\n\n\t\tif(path.sprite.repeat) {\n\n\t\t\tthis.ctx.save();\n\n\t\t\tthis.ctx.beginPath();\n\n\t\t\tthis.ctx.moveTo(path.verts[0].x, path.verts[0].y);\n\n\t\t\tfor(var j = 0; j < path.verts.length; j++) {\n\t\t\t\tthis.ctx.lineTo(path.verts[j].x, path.verts[j].y);\n\t\t\t}\n\t\t\n\n\t\t\tthis.ctx.translate(centroid.x,centroid.y);\n\t\t\t//this.ctx.rotate(circle.cycle);\n\t\t\tthis.ctx.scale(path.sprite.scale,path.sprite.scale);\n\t\t\tvar pattern = this.ctx.createPattern(img,\"repeat\");\n\t\t\tthis.ctx.fillStyle = pattern;\n\n\t\t\tthis.ctx.closePath();\n\n\t\t\tthis.ctx.fill();\n\t\t\tthis.ctx.restore();\t\n\t\t}\n\n\t\tif(path.sprite.fit) {\n\n\t\t\tthis.ctx.save();\n\n\t\t\tthis.ctx.beginPath();\n\n\t\t\tthis.ctx.moveTo(path.verts[0].x, path.verts[0].y);\n\n\t\t\tfor(var j = 0; j < path.verts.length; j++) {\n\t\t\t\tthis.ctx.lineTo(path.verts[j].x, path.verts[j].y);\n\t\t\t}\n\n\t\t\tthis.ctx.closePath();\n\n\t\t\tthis.ctx.clip();\n\n\t\t\tvar box = PhSim.Tools.getStaticBoundingBox(path);\n\n\t\t\tvar h = img.height * (box.w/img.width);\n\n\t\t\tthis.renderSpriteByCenter(path.sprite.src,centroid.x,centroid.y,box.w,h,0);\n\n\t\t\tthis.ctx.restore();\t\n\n\t\t}\n\n\t\telse {\n\t\t\tthis.renderSpriteByCenter(path.sprite.src,centroid.x,centroid.y,img.width,img.height,0);\n\t\t}\n\n\t}\n\n\t\n}\n\n/**\n * @function renderSpriteByCenter\n * @param {String} url - URL of object loaded in PhSim.PhRender.prototype.spriteImgArray\n * @param {Number} x - x-coordinate\n * @param {Number} y - y-coordinate\n * @param {Number} w - width\n * @param {Number} h - height\n * @param {Number} a - angle\n */\n\nPhSim.PhRender.prototype.renderSpriteByCenter = function(url,x,y,w,h,a) {\n\n\tvar spriteImg = this.spriteImgArray[url];\n\n\tthis.ctx.save();\n\tthis.ctx.translate(x,y)\n\tthis.ctx.rotate(a)\n\t\n\tif(h === null) {\n\t\tthis.ctx.drawImage(spriteImg,0,0,spriteImg.width,spriteImg.height,-w * 0.5 , -h * 0.5,w);\n\t}\n\n\telse {\n\t\tthis.ctx.drawImage(spriteImg,0,0,spriteImg.width,spriteImg.height,-w * 0.5 , -h * 0.5,w,h);\n\t}\n\n\tthis.ctx.restore();\n}\n\n/**\n * \n * @param {Object} constraint \n */\n\nPhSim.PhRender.prototype.renderConstraint = function (constraint) {\n\n\tvar path = SLO(constraint.object.S, constraint.object.L, constraint.object.O);\n\n\tthis.ctx.save();\n\n\tthis.ctx.globalAlpha = 0.5\n\tthis.ctx.strokeStyle = \"black\";\n\n\tthis.ctx.arc(constraint.point.x, constraint.point.y, 10, 0, 2 * Math.PI);\n\tthis.ctx.stroke();\n\n\tthis.ctx.arc(constraint.relativeEndPoint.x + findCentroidOfPath(path).x , constraint.relativeEndPoint.y + findCentroidOfPath(path).y, 10, 0, 2 * Math.PI);\n\tthis.ctx.stroke();\n\n\tthis.ctx.setLineDash([10,10]);\n\n\tthis.ctx.moveTo(constraint.point.x, constraint.point.y);\n\tthis.ctx.lineTo(constraint.relativeEndPoint.x + findCentroidOfPath(path).x, constraint.relativeEndPoint.y + findCentroidOfPath(path).y);\n\tthis.ctx.stroke();\n\n\tthis.ctx.restore();\n\n}\n\n\n\n/**\n * \n * Render circle\n * \n * @function static_circle\n * @param {PhSim.Objects.Circle} circle \n */\n\nPhSim.PhRender.prototype.static_circle = function (circle) {\n\t\n\tthis.setCtx(circle);\n\n\tthis.ctx.beginPath();\n\tthis.ctx.arc(circle.x, circle.y, circle.radius, 0, 2*Math.PI)\n\tthis.ctx.closePath();\n\n\tthis.ctx.fill();\n\tthis.ctx.stroke();\n\n\tif(circle.gradient) {\n\t\tthis.ctx.save();\n\t\tthis.ctx.translate(circle.x,circle.y);\n\t\tthis.ctx.rotate(circle.cycle);\n\t\tthis.ctx.fillStyle = PhSim.Gradients.extractGradient(this.ctx,circle.gradient);\n\t\tthis.ctx.arc(0,0,circle.radius,0,2*Math.PI);\n\t\tthis.ctx.fill();\n\t\tthis.ctx.restore();\t\n\n\t}\n\n\tif(circle.sprite) {\n\n\t\tvar img = this.spriteImgArray[circle.sprite.src];\n\n\t\tthis.ctx.imageSmoothingEnabled = circle.sprite.smooth;\n\n\t\tif(circle.sprite.repeat) {\n\t\t\tthis.ctx.save();\n\t\t\tthis.ctx.translate(circle.x,circle.y);\n\t\t\tthis.ctx.rotate(circle.cycle);\n\t\t\tthis.ctx.scale(circle.sprite.scale,circle.sprite.scale);\n\t\t\tvar pattern = this.ctx.createPattern(img,\"repeat\");\n\t\t\tthis.ctx.fillStyle = pattern;\n\t\t\tthis.ctx.arc(0,0,circle.radius,0,2*Math.PI);\n\t\t\tthis.ctx.fill();\n\t\t\tthis.ctx.restore();\t\n\t\t}\n\n\t\tif(circle.sprite.fit) {\n\t\t\tthis.ctx.save();\n\t\t\tthis.ctx.translate(circle.x,circle.y);\n\t\t\tthis.ctx.rotate(circle.cycle);\n\t\t\tthis.ctx.arc(0,0,circle.radius,0,2*Math.PI);\n\t\t\tthis.ctx.clip();\n\t\t\tvar box = PhSim.Tools.getStaticBoundingBox(circle);\n\n\t\t\tvar h = img.height * (box.w/img.width);\n\n\t\t\tthis.renderSpriteByCenter(circle.sprite.src,0,0,box.w,h);\n\t\t\tthis.ctx.restore();\t\n\t\t}\n\n\t\telse { \n\t\t\tthis.renderSpriteByCenter(circle.sprite.src,circle.x,circle.y,circle.cycle);\n\t\t}\n\n\t}\n\n}\n\n\n/**\n * \n * Render rectangle\n * \n * @function static_rectangle\n * @param {PhSim.Objects.Rectangle} rectangle - Rectangle object\n * \n */\n\nPhSim.PhRender.prototype.static_rectangle = function(rectangle) {\n\n\t/*\n\tvar rectangle = {\n\t\t\"cycle\": arg.cycle,\n\t\t\"x\": arg.x,\n\t\t\"y\": arg.y,\n\t\t\"w\": arg.w,\n\t\t\"h\": arg.h,\n\t\t\"globalAlpha\": arg.globalAlpha,\n\t\t\"strokeStyle\": arg.strokeStyle,\n\t\t\"fillStyle\": arg.fillStyle,\n\t\t\"lineWidth\": arg.lineWidth\n\t}\n\n\t*/\n\n\t//var c = getCentroid.object(rectangle);\n\n\tvar c = PhSim.Tools.getRectangleCentroid(rectangle);\n\n\tvar x = -rectangle.w * 0.5;\n\tvar y = -rectangle.h * 0.5;\n\t\n\tthis.setCtx(rectangle);\n\tthis.ctx.translate(c.x,c.y);\n\tthis.ctx.rotate(rectangle.cycle);\n\tthis.ctx.beginPath();\n\tthis.ctx.rect(x,y,rectangle.w,rectangle.h);\n\tthis.ctx.closePath();\n\tthis.ctx.stroke();\n\tthis.ctx.fill();\n\n\tif(rectangle.widgets) {\n\t\tfor(var i = 0; i < rectangle.widgets.length; i++) {\n\t\t\tif(rectangle.widgets[i].rectText) {\n\t\t\t\tthis.rectText(rectangle.widgets[i],x,y,rectangle.w,rectangle.h,0);\n\t\t\t}\n\t\t}\n\t}\n\n\t/*\n\tif(rectangle.text) {\n\t\n\t\tthis.ctx.save();\n\t\tthis.ctx.beginPath();\n\t\tthis.ctx.rect(0,0,rectangle.w,rectangle.h);\n\t\tthis.ctx.clip();\n\t\tthis.ctx.fillStyle = rectangle.text.fill;\n\t\tthis.ctx.strokeStyle = rectangle.text.borderColor\n\t\tthis.ctx.font = rectangle.text.size + \"px \" + rectangle.text.font;\n\t\tthis.ctx.textBaseline = \"top\";\n\t\tthis.ctx.strokeText(rectangle.text.content, 0, (0));\n\t\tthis.ctx.restore();\n\t\t\n\n\t\tthis.rectText(rectangle.text,0,0,rectangle.w,rectangle.h);\n\t}\n\n\t*/\n\n\tthis.ctx.rotate(-rectangle.cycle);\n\tthis.ctx.translate(-c.x,-c.y);\n\n\n\tif(Number.isInteger(rectangle.sprite)) {\n\n\t\tvar img = this.spriteImgArray[rectangle.sprite.src];\n\n\t\tthis.ctx.imageSmoothingEnabled = rectangle.sprite.smooth;\n\n\t\tif(rectangle.sprite.repeat) {\n\t\t\tthis.ctx.save();\n\t\t\tthis.ctx.translate(c.x,c.y);\n\t\t\tthis.ctx.rotate(rectangle.cycle);\n\t\t\tvar pattern = this.ctx.createPattern(img,\"repeat\");\n\t\t\tthis.ctx.fillStyle = pattern;\n\t\t\tthis.ctx.rect(-rectangle.w * 0.5,-rectangle.h * 0.5,rectangle.w,rectangle.h);\n\t\t\tthis.ctx.fill();\n\t\t\tthis.ctx.restore();\t\n\t\t}\n\n\t\tif(rectangle.sprite.fit) {\n\t\t\tthis.ctx.save();\n\t\t\tthis.ctx.translate(c.x,c.y);\n\t\t\tthis.ctx.rotate(rectangle.cycle);\n\t\t\tthis.ctx.rect(-rectangle.w * 0.5,-rectangle.h * 0.5,rectangle.w,rectangle.h);\n\t\t\tthis.ctx.clip();\n\t\t\tvar box = PhSim.Tools.getStaticBoundingBox(rectangle);\n\n\t\t\tvar h = img.height * (rectangle.w/img.width);\n\n\t\t\tthis.renderSpriteByCenter(rectangle.sprite.src,0,0,rectangle.w,h);\n\t\t\tthis.ctx.restore();\t\n\t\t}\n\n\t\telse { \n\t\t\tthis.renderSpriteByCenter(rectangle.sprite.src,c.x,c.y,img.w,img.h,rectangle.cycle);\n\t\t}\n\n\t}\n\n}\n\n// Draw text\n\n/**\n * \n * @param {*} text \n * @param {Number} x \n * @param {Number} y \n * @param {Number} w \n * @param {Number} h \n * @param {Number} a \n */\n\nPhSim.PhRender.prototype.rectText = function(text,x,y,w,h,a) {\n\tthis.ctx.save();\n\tthis.ctx.translate(x,y);\n\tthis.ctx.rotate(a);\n\tthis.ctx.beginPath();\n\tthis.ctx.rect(0,0,w,h);\n\tthis.ctx.clip();\n\tthis.ctx.textAlign = \"left\";\n\tthis.ctx.fillStyle = text.fill;\n\n\t// Reset Line Width\n\n\tthis.ctx.lineWidth = undefined;\n\n\tif(text.lineWidth) {\n\t\tthis.ctx.lineWidth = text.lineWidth;\n\t}\n\n\tthis.ctx.strokeStyle = text.borderColor\n\tthis.ctx.font = text.size + \"px \" + text.font;\n\tthis.ctx.textBaseline = \"top\";\n\tvar content = text.content;\n\n\tif(this.dynSim) {\n\t\tcontent = this.dynSim.processVar(content);\n\t}\n\n\tthis.ctx.fillText(content,0,0);\n\n\tif(text.lineWidth) {\n\t\tthis.ctx.strokeText(content,0,0);\n\t}\n\n\tthis.ctx.restore();\n}\n\n// Draw a regular polygon\n\n/**\n * \n * @param {PhSim.Objects.RegPolygon} regPolygon \n */\n\nPhSim.PhRender.prototype.static_regPolygon = function(regPolygon) {\n\n\tvar vertSet = PhSim.Tools.getRegPolygonVerts(regPolygon);\n\t\n\tthis.setCtx(regPolygon);\n\n\tthis.ctx.beginPath();\n\n\tthis.ctx.moveTo(vertSet[0].x, vertSet[0].y);\n\n\tfor(var j = 0; j < vertSet.length; j++) {\n\t  this.ctx.lineTo(vertSet[j].x, vertSet[j].y);\n\t}\n\n\tthis.ctx.closePath();\n\t\n\tthis.ctx.stroke();\n\n\tthis.ctx.fill();\n\n\tif(regPolygon.sprite) {\n\n\t\tvar img = this.spriteImgArray[regPolygon.sprite.src];\n\n\t\tthis.ctx.imageSmoothingEnabled = regPolygon.sprite.smooth;\n\n\t\tif(regPolygon.sprite.repeat) {\n\t\t\tthis.ctx.save();\n\t\t\tthis.ctx.translate(regPolygon.x,regPolygon.y);\n\t\t\tthis.ctx.rotate(regPolygon.cycle);\n\t\t\tthis.ctx.scale(regPolygon.sprite.scale,regPolygon.sprite.scale);\n\t\t\tvar pattern = this.ctx.createPattern(img,\"repeat\");\n\t\t\tthis.ctx.fillStyle = pattern;\n\t\t\tthis.ctx.arc(0,0,regPolygon.radius,0,2*Math.PI);\n\t\t\tthis.ctx.fill();\n\t\t\tthis.ctx.restore();\t\n\t\t}\n\n\t\tif(regPolygon.sprite.center) { \n\t\t\tthis.renderSpriteByCenter(regPolygon.sprite.src,regPolygon.x,regPolygon.y,regPolygon.cycle);\n\t\t}\n\n\t}\n\n\n}\n\n// Draw Static object\n\n/**\n * \n * @param {*} obj \n */\n\nPhSim.PhRender.prototype.renderStatic = function(obj) {\n\t\t\t\t\n\tif ( obj.path === true )  {\n\t\tthis.static_path(obj);\n\t}\n\t\n\tif( obj.circle === true) {\n\t\tthis.static_circle(obj); \n\t}\n\n\tif( obj.rectangle === true) {\n\t\tthis.static_rectangle(obj);\n\t}\n\n\tif( obj.regPolygon === true ) {\n\t\tthis.static_regPolygon(obj);\n\t}\n\n\tif( obj.composite === true) {\n\t\tfor(var i = 0; i < obj.objUniverse.length; i++) {\n\t\t\tthis.renderStatic(obj.objUniverse[i]);\n\t\t}\n\t}\n\n}\n\n// Draws a layer\n\n/**\n * \n * @param {*} layer \n */\n\nPhSim.PhRender.prototype.renderStaticLayer = function(layer) {\n\n\tfor(var i = 0; i < layer.objUniverse.length; i++) {\n\n\t\t\tthis.renderStatic(layer.objUniverse[i])\n\t\t\t\n\t\t\t/*** Drawing Path ***/\n\n\t\t\t/*\n\t\t\t\n\t\t\tif ( layer.objUniverse[i].path === true )  {\n\t\t\t\tthis.static_path(layer.objUniverse[i]);\n\t\t\t}\n\t\t\t\n\t\t\tif( layer.objUniverse[i].circle === true) {\n\t\t\t\tthis.static_circle(layer.objUniverse[i]); \n\t\t\t}\n\n\t\t\tif( layer.objUniverse[i].rectangle === true) {\n\t\t\t\tthis.static_rectangle(layer.objUniverse[i]);\n\t\t\t}\n\n\t\t\tif( layer.objUniverse[i].regPolygon === true ) {\n\t\t\t\tthis.static_regPolygon(layer.objUniverse[i]);\n\t\t\t}\n\n\t\t\t*/\n\n\n\t\t\t//PhSim.PhRender.prototype.renderStaticObject(layer.objUniverse[i]);\n\t\t\t\n\t}\t\n}\n\n/**\n * \n * @param {*} simulation \n */\n\nPhSim.PhRender.prototype.simulation = function(simulation) {\n\n\tfor(var i = 0; i < simulation.layers.length; i++) {\n\t\tif(!simulation.layers[i].hidden) {\n\t\t\tthis.layer(simulation.layers[i])\n\t\t}\n\t}\n}\n\n/**\n * \n * @param {*} object \n */\n\nPhSim.PhRender.prototype.dynamicSkeleton = function(object) {\n\n\tif(object.static.path) {\n\t\t\n\t\tthis.ctx.beginPath();\n\n\t\tthis.ctx.moveTo(object.skinmesh[0].x, object.skinmesh[0].y);\n\n\t\tfor(var j = 0; j < object.skinmesh.length; j++) {\n\t\t\tthis.ctx.lineTo(object.skinmesh[j].x, object.skinmesh[j].y);\n\t\t}\n\t\n\t}\n\n\telse {\n\n\t\tthis.ctx.beginPath();\n\n\t\tthis.ctx.moveTo(object.matter.vertices.x, object.matter.vertices.y);\n\n\t\tfor(var j = 0; j < object.matter.vertices.length; j++) {\n\t\t\tthis.ctx.lineTo(object.matter.vertices[j].x, object.matter.vertices[j].y);\n\t\t}\n\n\n\t}\n\n}\n\n/**\n * \n * @param {*} object \n */\n\nPhSim.PhRender.prototype.dynamicSkeleton_center = function(object) {\n\n\tif(object.static.path) {\n\t\t\n\t\tthis.ctx.beginPath();\n\n\t\tthis.ctx.moveTo(object.skinmesh[0].x - object.matter.position.x, object.skinmesh[0].y - object.matter.position.y);\n\n\t\tfor(var j = 0; j < object.skinmesh.length; j++) {\n\t\t\tthis.ctx.lineTo(object.skinmesh[j].x - object.matter.position.x, object.skinmesh[j].y - object.matter.position.y);\n\t\t}\n\t\n\t}\n\n\telse {\n\n\t\tthis.ctx.beginPath();\n\n\t\tthis.ctx.moveTo(object.matter.vertices.x - object.matter.position.x, object.matter.vertices.y - object.matter.position.y);\n\n\t\tfor(var j = 0; j < object.matter.vertices.length; j++) {\n\t\t\tthis.ctx.lineTo(object.matter.vertices[j].x - object.matter.position.x, object.matter.vertices[j].y - object.matter.position.y);\n\t\t}\n\n\n\t}\n\n}\n\n/**\n * \n * @param {*} object \n */\n\nPhSim.PhRender.prototype.drawDynamicSkeleton = function (object) {\n\n\tthis.dynamicSkeleton(object);\n\tthis.ctx.closePath();\n\tthis.ctx.stroke();\n\n}\n\n/**\n * \n * @param {*} arg \n */\n\nPhSim.PhRender.prototype.dynamicRenderDraw = function (arg) {\n\n\tthis.ctx.lineWidth = arg.object.lineWidth;\n\tthis.ctx.fillStyle = arg.object.fillStyle;\n\tthis.ctx.strokeStyle = arg.object.strokeStyle;\n\n\t\n\tif(arg.object.path) {\n\t\t\n\t\tthis.drawDynamicSkeleton(arg);\n\t\t\n\t\tthis.ctx.fill();\n\n\t\tif(arg.object.sprite) {\n\n\t\t\tvar img = this.spriteImgArray[arg.object.sprite.src];\n\n\t\t\tthis.ctx.imageSmoothingEnabled = arg.object.sprite.smooth;\n\n\t\t\tif(arg.object.sprite.repeat) {\n\n\t\t\t\tthis.ctx.save();\n\n\t\t\t\tthis.dynamicSkeleton(arg);\n\t\t\t\tthis.ctx.translate(arg.matter.position.x,arg.matter.position.y);\n\t\t\t\tthis.ctx.rotate(arg.matter.angle);\n\t\t\t\tthis.ctx.scale(arg.object.sprite.scale,arg.object.sprite.scale);\n\t\t\n\n\t\t\t\tvar pattern = this.ctx.createPattern(img,\"repeat\");\n\t\t\t\tthis.ctx.fillStyle = pattern;\n\t\t\t\tthis.ctx.fill();\n\n\t\t\t\tthis.ctx.restore();\n\t\t\t}\n\n\t\t\tif(arg.object.sprite.fit) {\n\n\t\t\t\tthis.ctx.save();\n\t\n\t\t\t\tthis.ctx.beginPath();\n\t\n\t\t\t\tthis.ctx.moveTo(arg.object.verts[0].x, arg.object.verts[0].y);\n\t\n\t\t\t\tfor(var j = 0; j < arg.object.verts.length; j++) {\n\t\t\t\t\tthis.ctx.lineTo(arg.object.verts[j].x, arg.object.verts[j].y);\n\t\t\t\t}\n\t\n\t\t\t\tthis.ctx.closePath();\n\t\n\t\t\t\tthis.ctx.clip();\n\t\n\t\t\t\tvar box = PhSim.Tools.getStaticBoundingBox(arg.object);\n\t\n\t\t\t\tvar h = img.height * (box.w/img.width);\n\t\n\t\t\t\tthis.renderSpriteByCenter(arg.object.sprite.src,arg.matter.position.x,arg.matter.position.y,box.w,h,arg.matter.angle);\n\t\n\t\t\t\tthis.ctx.restore();\t\n\t\n\t\t\t}\n\t\n\t\t\telse {\n\t\t\t\tthis.renderSpriteByCenter(arg.object.sprite.src,arg.matter.position.x,arg.matter.position.y,img.width,img.height,arg.matter.angle);\n\t\t\t}\n\n\t\t\t//this.ctx.restore();\t\n\t\n\t\t}\n\t\t\n\t}\n\n\tif(arg.object.circle) {\n\t\tthis.static_circle(arg.object);\t\n\t}\n\t\n\tif(arg.object.regPolygon) {\n\t\tthis.static_regPolygon(arg.object);\t\t\n\t}\n\n\tif(arg.object.rectangle) {\n\t\tthis.static_rectangle(arg.object);\t\t\n\t}\n\n\tif(arg.object.composite) {\n\t\tfor(var i = 1; i < arg.parts.length; i++) {\n\t\t\tthis.dynamicRenderDraw(arg.parts[i]);\n\t\t}\n\t}\n\n}\n\n/**\n * \n * @param {*} L \n */\n\nPhSim.PhRender.prototype.dynamicDrawLayer = function(L) {\n\t\n\tfor(var i = 0; i < sim.simulations[simulationI].layers[L].length; i++) {\n\t\tthis.dynamicRenderDraw(L,i);\n\t}\n\n}\n","/*** Sprites ***/\n\nPhSim.Sprites = {\n    Calc: {}\n}\n\nPhSim.Sprites.Sprite = function() {\n\tthis.src = null;\n\tthis.w = null;\n\tthis.h = null;\n\tthis.x = null;\n\tthis.y = null;\n\tthis.fit = null;\n\tthis.repeat = null;\n\tthis.object = null;\n}\n\nPhSim.Sprites.renderSprite = function(ctx,sprite) {\n\tvar localElm = document.createElement(\"img\");\n\tlocalElm.src = sprite.src;\n\tif(sprite.spec === true) {\n\t\tctx.drawImage(localElm,sprite.x,sprite.y,sprite.w,sprite.h);\n\t}\n\n\tif(sprite.auto === true) {\n\t\tctx.drawImage(localElm,sprite.x,sprite.y,sprite.w,sprite.h);\n\t}\n}\n\nPhSim.Sprites.renderGlobalSprites = function(ctx,simulation) {\n\n\tfor(i = 0; i < simulation.sprites.length; i++) {\n\t\tPhSim.Sprites.renderSprite(ctx,simulation.sprites[i]);\n\t}\n\n}\n\n\nPhSim.Sprites.circularSpriteRenderCanvas = function(ctx,canvas,angle) {\n\n\tvar localElm = document.createElement(\"canvas\");\n\tvar localCtx = localElm.getContext(\"2d\");\n\n\tvar localImg = document.createElement(\"img\");\n\tlocalImg.src = canvas.src;\n\n\tlocalCtx.rotate(angle);\n\n\tlocalCtx.drawImage()\n\n\n}\n\nPhSim.Sprites.SpriteImgArray = function(sprites,onload = function() {}) {\n\t\n\t// Force load if sprites list is empty\n\n\tthis.static = {};\n\tthis.loaded_n = 0;\n\tthis.loaded = false;\n\tthis.onload = onload;\n\tthis.length = 0;\n\n\tvar self = this;\n\n\tfor(var i = 0; i < sprites.length; i++) {\n\t\tself.addSprite(sprites[i],function(){\n\n\t\t\tself.loaded_n++;\n\n\t\t\tif(self.loaded_n = self.length) {\n\t\t\t\tonload();\n\t\t\t}\n\t\t})\n\t}\n\n\tif(sprites.length === 0) {\n\t\tself.onload();\n\t\tself.loaded = true;\n\t}\n\n}\n\nPhSim.Sprites.SpriteImgArray.prototype.addSprite = function(staticObj,onload = function() {} ) {\n\t\n\tvar self = this;\n\t\n\tvar img = document.createElement(\"img\");\n\n\timg.addEventListener(\"load\",function() {\n\t\tonload();\n\t});\n\n\timg.src = staticObj.src;\n\n\tthis.static[staticObj.src] = staticObj;\n\tthis[staticObj.src] = img;\n\n\tthis.length++;\n}","PhSim.Audio = {}\n\nPhSim.Audio.AudioArray = function(p_audio,onload) {\n\n\t// force load function if audio list is empty\n\t\n\tthis.array = [];\n\tthis.loaded_n = 0;\n\tthis.loaded = false;\n\tthis.onload = onload;\n\n\tvar self = this;\n\n\t\n\tif(p_audio.length === 0) {\n\t\tself.loaded = true;\n\t\tself.onload();\n\t}\n\n\tfor(var i = 0; i < p_audio.length; i++) {\n\n\t\tvar audio = document.createElement(\"audio\");\n\n\t\taudio.addEventListener(\"canplaythrough\",function() {\n\t\t\tself.loaded_n++;\n\n\t\t\tif(self.array.length === self.loaded_n) {\n\t\t\t\tself.loaded = true;\n\t\t\t\tself.onload();\n\t\t\t}\n\n\t\t})\n\n\t\taudio.src = p_audio[i].src;\n\t\taudio.loop = p_audio[i].loop\n\n\t\tthis.array.push(audio);\n\n\t}\n\n}","/**\n * \n * @param {PhSim.Objects.Vector} vector1 \n * @param {PhSim.Objects.Vector} vector2 \n */\n\nPhSim.Tools.addVectors = function(vector1,vector2) {\n\treturn new PhSim.Objects.Vector(vector1.x + vector2.x, vector1.y + vector2.y);\n}\n\n/**\n * \n * @param {PhSim.Objects.Vector} vector1 \n * @param {PhSim.Objects.Vector} vector2 \n */\n\nPhSim.Tools.subtractVectors = function(vector1,vector2) {\n\treturn new PhSim.Objects.Vector(vector1.x - vector2.x, vector1.y - vector2.y);\n}\n\n/**\n * \n * @param {PhSim.Objects.Vector} vector \n * @param {Number} scalar \n */\n\nPhSim.Tools.scaleVector = function(vector,scalar) {\n\treturn new PhSim.Objects.Vector(vector.x * scalar,vector.y * scalar)\n}\n\n/**\n * \n * @param {PhSim.Objects.Vector} vector \n * @param {Number} scalar \n */\n\nPhSim.Tools.divideVector = function(vector,scalar) {\n\treturn new PhSim.Objects.Vector(vector.x * (1/scalar),vector.y * (1/scalar));\n}\n\n/**\n * \n * @param {PhSim.Objects.Vector} vector1 \n * @param {PhSim.Objects.Vector} vector2 \n */\n\nPhSim.Tools.calcVertDistance = function(vector1,vector2) {\n\t\n\tvar l1 = Math.pow(vector1.x - vector2.x,2);\n\tvar l2 = Math.pow(vector1.y - vector2.y,2);\n\n\treturn Math.sqrt(l1+l2);\n\n}\n\n/**\n * \n * @param {PhSim.Objects.Vector} vector \n * \n */\n\nPhSim.Tools.getVectorLength = function(vector) {\n\treturn Math.sqrt(Math.pow(vector.x,2)+Math.pow(vector.y,2))\n}\n\n/**\n * \n * @param {PhSim.Objects.Vector} vector \n */\n\nPhSim.Tools.getUnitVector = function(vector) {\n\treturn PhSim.Tools.scaleVector(vector,1/PhSim.Tools.getVectorLength(vector));\n}\n\n/*** Vector Transformation */\n\nPhSim.Tools.applyTransformation = function(a11,a12,a21,a22,x,y) {\n\treturn {\n\t\t\"x\": a11 * x + a12 * y,\n\t\t\"y\": a21 * x + a22 * y   \n\t}\n}\n\n/*** Rotate Vector ***/\n\nPhSim.Tools.rotatedVector = function(x,y,a) {\n\treturn PhSim.Tools.applyTransformation(Math.cos(a),Math.sin(a),-Math.cos(a),Math.sin(a),x,y);\n}","/**\n * Possible Object Structure\n */\n\nPhSim.objectTypes = {\n\tpath: true,\n\tcircle: true,\n\tregularPolygon: true,\n\trectangle: true\n}\n\n/*** Structure defining possible object types ***/\n\n/**\n * \n * @param {String} objectTypeStr\n * @returns {Boolean} \n * \n */\n\nPhSim.Tools.checkObjectType = function (objectTypeStr) {\n\tif(objectTypes[objectTypeStr])\n\t\treturn false;\n\telse {\n\t\treturn true;\n\t}\n}","/*** \n * \n * Get Rectangle by diagonal with points (x1,y1) and (x2,y2)\n * \n * ***/\n\nPhSim.Tools.diagRect = function(x1,y1,x2,y2,a) {\n\n\tvar v = {\n\t\t\"x\": x2 - x1,\n\t\t\"y\": y2 - y1\n\t}\n\n\tv = {\n\t\t\"x\": v.x * Math.cos(-a) - v.y * Math.sin(-a),\n\t\t\"y\": v.x * Math.sin(-a) + v.y * Math.cos(-a)\n\t}\n\n\tv = {\n\t\t\"x\": v.x + x1,\n\t\t\"y\": v.y + y1\n\t}\n\n\tx2 = v.x;\n\ty2 = v.y;\n\n    return new PhSim.Objects.Rectangle(x2-x1,y2-y1,x1,y1);\n    \n }\n","\n/**\n * \n * Get vertices for a static object representing a regular polygon.\n * \n * @function getRegPolygonVerts\n * @param {PhSim.Objects.RegPolygon} regularPolygon - The Static Regular Polygon Object\n * @returns {PhSim.Objects.Vector[]}\n * \n */\n\nPhSim.Tools.getRegPolygonVerts = function(regularPolygon) {\n\n\tvar a = []\n\t\n\tvar firstAngle = (2*Math.PI)/regularPolygon.sides;\n\n\tfor(var i = 0; i < regularPolygon.sides; i++) {\n\t\tvar x = regularPolygon.x + Math.cos(firstAngle * i + regularPolygon.cycle) * regularPolygon.radius;\n\t\tvar y = regularPolygon.y + Math.sin(firstAngle * i + regularPolygon.cycle) * regularPolygon.radius;\n\t\ta.push(new PhSim.Objects.Vector(x,y));\n\t}\n\n\treturn a;\n\n}\n\n\n/* \n\nRectangles\n\n*/\n\nPhSim.Tools.getRectangleVertArray = function(rectangle) {\n\n\tvar a = [\n\n\t\t\t{\n\t\t\t\t\"x\": rectangle.x,\n\t\t\t\t\"y\": rectangle.y,\n\t\t\t\t\"topLeft\": true\n\t\t\t},\n\t\n\t\t\t{\n\t\t\t\t\"x\": rectangle.x + rectangle.w,\n\t\t\t\t\"y\": rectangle.y,\n\t\t\t\t\"topRight\": true\n\t\t\t},\n\n\t\t\t{\n\t\t\t\t\"x\": rectangle.x + rectangle.w,\n\t\t\t\t\"y\": rectangle.y + rectangle.h,\n\t\t\t\t\"bottomRight\": true\n\t\t\t},\n\t\n\t\t\t{\n\t\t\t\t\"x\": rectangle.x,\n\t\t\t\t\"y\": rectangle.y + rectangle.h,\n\t\t\t\t\"bottomLeft\": true\n\t\t\t}\n\t\n\t];\n\n\tMatter.Vertices.rotate(a, rectangle.cycle, PhSim.Tools.getRectangleCentroid(rectangle));\n\n\n\treturn a;\n\n}\n\n\nPhSim.Tools.getRectangleCorners = function(rectangle) {\n\n\n\tvar a = PhSim.Tools.getRectangleVertArray(rectangle)\n\n\t\n\tvar z = {\n\n\t\t\"topLeft\": a[0],\n\n\t\t\"topRight\": a[1],\n\n\t\t\"bottomLeft\": a[3],\n\n\t\t\"bottomRight\": a[2]\n\n\t}\n\n\treturn z;\n\n}","/**\n * \n * Get centroid of a rectangle\n * \n * @function getRectangleCentroid\n * @param {PhSim.Objects.Rectangle} rectangle\n * @returns {PhSim.Objects.Vector}\n *  \n */\n\nPhSim.Tools.getRectangleCentroid = function(rectangle) {\n\treturn {\n\t\t\"x\": rectangle.x + 0.5 * rectangle.w,\n\t\t\"y\": rectangle.y + 0.5 * rectangle.h\n\t}\n}\n\n\n/*** Find Centroid of a path polygon ***/\n\nPhSim.Tools.findCentroidOfPath = function(a) {\n\t\t\n\tvar v = {\n\t\tx: 0,\n\t\ty: 0,\n\t}\n\t\n\tfor(var j = 0; j < a.verts.length; j++) { \n\t\tv.x += a.verts[j].x;\n\t\tv.y += a.verts[j].y;\n\t}\n\t\n\tv.x = (1/a.verts.length) * v.x;\n\tv.y = (1/a.verts.length) * v.y;\n\t\n\treturn v;\n\n}\n","/**\n * \n * Get bounding box from an array of vertices.\n * \n * \n * @function getVertBoundingBox\n * @param {Array} verts \n */\n\nPhSim.Tools.getVertBoundingBox = function(verts) {\n\n\tvar verts = JSON.parse(JSON.stringify(verts));\n\n\tvar o = {\n\t\t\"smallX\": null,\n\t\t\"largeX\": null,\n\t\t\"smallY\": null,\n\t\t\"largeY\": null,\n\t\t\"w\": null,\n\t\t\"h\": null,\n\t\t\"x\": null,\n\t\t\"y\": null,\n\t\t\"upperLeftCorner\": null,\n\t\t\"upperRightCorner\": null,\n\t\t\"lowerLeftCorner\": null,\n\t\t\"lowerRightCorner\": null,\n\t\t\"rectangle\": true,\n\t};\n\n\tverts.sort(function(a,b){\n\t\treturn a.x - b.x;\n\t});\n\n\to.smallX = verts[0].x;\n\to.largeX = verts[verts.length - 1].x;\n\n\tverts.sort(function(a,b){\n\t\treturn a.y - b.y;\n\t});\n\n\to.smallY = verts[0].y;\n\to.largeY = verts[verts.length - 1].y;\n\n\to.w = o.largeX - o.smallX;\n\to.h = o.largeY - o.smallY;\n\to.x = o.smallX;\n\to.y = o.smallY;\n\n\treturn o;\n}\n\n/**\n * \n * @param {Object} object - The Static Object\n * @returns {Object} \n */\n\nPhSim.Tools.getStaticBoundingBox = function(object) {\n\t\n\tif(object.path) {\n\t\treturn PhSim.Tools.getVertBoundingBox(object.verts);\n\t}\n\n\tif(object.regPolygon) {\n\t\treturn PhSim.Tools.getVertBoundingBox(PhSim.Tools.getRegPolygonVerts(object));\n\t}\n\n\tif(object.rectangle) {\n\t\treturn PhSim.Tools.getVertBoundingBox(PhSim.Tools.getRectangleVertArray(object,true));\n\t}\n\n\tif(object.circle) {\n\n\t\tvar ax = object.x - object.radius;\n\t\tvar ay = object.y - object.radius;\n\t\tvar bx = object.x + object.radius;\n\t\tvar by = object.y + object.radius;\n\n\t\treturn PhSim.Tools.diagRect(ax,ay,bx,by,0);\n\t}\n\n\tif(object.composite) {\n\t\t\n\t\tvar a = [];\n\n\t\tfor(var i = 0; i < object.objUniverse.length; i++) {\n\t\t\ta.push( PhSim.Tools.getRectangleVertArray( this.getStaticBoundingBox(object.objUniverse[i]) ) );\n\t\t}\n\n\t\ta = a.flat(Infinity);\n\n\t\treturn PhSim.Tools.getVertBoundingBox(a);\n\n\t}\n}\n\n/**\n * \n * Get bounding box of a static object\n * \n * @function getDynBoundingBox\n * @param {PhSim.DynObject} dynObj \n */\n\nPhSim.Tools.getDynBoundingBox = function(dynObj) {\n\treturn {\n\t\t\"x\": dynObj.matter.bounds.min.x,\n\t\t\"y\": dynObj.matter.bounds.min.y,\n\t\t\"w\": dynObj.matter.bounds.max.x - dynObj.bounds.min.x,\n\t\t\"h\": dynObj.matter.bounds.max.y - dynObj.bounds.min.y,\n\t}\n}","// Tools declaration\n\nPhSim.Tools = {}\n\n// Vector Tools\n\nimport \"./vectorTools\";\n\n// Object Checker\n\nimport \"./objectChecker\";\n\n// Create rectangle from diagonal\n\nimport \"./diagRect\";\n\n// Vertices Functions\n\nimport \"./vertex\";\n\n// Centroid\n\nimport \"./centroid\";\n\n// Bounding box functions\n\nimport \"./boundingBox\";","PhSim.DynSim.prototype.L = function(L) {\n\treturn this.matterJSEngine.world.composites[L];\n}\n\nPhSim.DynSim.prototype.LO = function(L,O) {\n\treturn this.dynTree[L][O];\n}\n\nPhSim.DynSim.prototype.getObjectFromLOStr = function(str) {\n\tstr.split(\",\");\n\treturn this.LO(str[1],str[2])\n}","PhSim.DynSim.createFromCanvas = function(sim,canvas) {\n\tvar p = new PhSim.DynSim(sim);\n\tp.simCanvas = canvas;\n\tp.simCtx = canvas.getContext(\"2d\");\n\tp.simCanvas.width = p.sim.box.width;\n\tp.simCanvas.height = p.sim.box.height;\n\tp.registerCanvasEvents();\n\tp.configRender(p.simCtx);\n\treturn p;\n}\n\n/**\n * \n * @param {Object} sim \n * @param {Node} simContainer \n * \n */\n\nPhSim.DynSim.createFromContainer = function(sim,simContainer) {\n\t\n\t// Canvas\n\n\tvar canvas = document.createElement(\"canvas\");\n\n\t// Simulation object\n\n\tvar p = PhSim.DynSim.createFromCanvas(sim,canvas);\n\n\tp.simContainer = simContainer;\n\n\tsimContainer.appendChild(p.simCanvas);\n\tsimContainer.classList.add(\"phsim-container\");\n\n\tp.configFilter(simContainer);\n\t\n\treturn p;\n}\n\nPhSim.DynSim.createContainer = function(sim) {\n\tvar container = document.createElement(\"div\");\n\treturn this.createFromContainer(sim,container);\n}\n\n/**\n * @function loadFromJSON\n * @param {String} jsonURL - URL For JSON File\n * @param {function} onload - Onload function\n * \n */\n\nPhSim.DynSim.loadFromJSON = function(jsonURL,onload) {\n\n\tvar x = new XMLHttpRequest();\n\tx.open(\"GET\",jsonURL);\n\n\tx.addEventListener(\"load\",function(){\n\t\tvar o = PhSim.DynSim.createContainer(JSON.parse(x.responseText));\n\t\tonload(o);\n\t})\n\n\tx.send();\n\n}\n\nPhSim.DynSim.prototype.configRender = function() {\n\t\n\tthis.assignPhRender(new PhSim.PhRender(this.simCtx));\n\t\n\tif(!this.noCamera) {\n\t\tthis.camera = new PhSim.DynSimCamera(this);\n\t\tthis.camera.translate(-this.camera.x,-this.camera.y);\n\t}\n\n}","PhSim.DynSim.prototype.configFilter = function(container) {\n\tthis.htmlFilter = document.createElement(\"div\");\n\tthis.htmlFilter.style.background = \"rgba(3,3,3,0.7)\";\n\tthis.htmlFilter.style.position = \"absolute\";\n\tthis.htmlFilter.style.display = \"none\";\n\tthis.htmlFilter.classList.add(\"dynsim-filter\");\n\tcontainer.appendChild(this.htmlFilter);\n}\n\nPhSim.DynSim.prototype.enableFilter = function() {\n\tvar elmBox = this.simCanvas.getBoundingClientRect();\n\tthis.htmlFilter.style.display = \"inline-block\";\n\tthis.htmlFilter.style.left = \"0px\";\n\tthis.htmlFilter.style.position = \"absolute\";\n\t//this.htmlFilter.style.top = elmBox.top + \"px\";\n\tthis.htmlFilter.style.width = Math.floor(elmBox.width) + \"px\";\n\tthis.htmlFilter.style.height = Math.floor(elmBox.height) + \"px\";\n}\n\nPhSim.DynSim.prototype.disableFilter = function() {\n\tthis.htmlFilter.style.display = \"none\";\n}\n\nPhSim.DynSim.prototype.toggleFilter = function() {\n\n\tif(this.htmlFilter.style.display === \"none\") {\n\t\tthis.enableFilter();\n\t}\n\n\telse {\n\t\tthis.disableFilter();\n\t}\n}\n\n/**\n * \n * @param {Object} options - Options\n * @param {String} options.msg - The message\n * @param {String} options.closeButtonTxt - Inner text for closing button\n * @param {String} options.bgColor - Background Color\n * @param {String} options.txtColor - Text Color\n * @param {Number} options.w - Width\n * @param {Number} options.h - Height\n * @param {Function} options.onok - Function to call when alert is closed\n *  \n */\n\nPhSim.DynSim.prototype.alert = function(options) {\n\t\n\tvar alertBox = document.createElement(\"div\");\n\talertBox.style.backgroundColor = options.bgColor;\n\talertBox.style.color = options.txtColor;\n\talertBox.style.textAlign = \"center\";\n\talertBox.style.width = options.w + \"px\";\n\talertBox.style.height = options.h + \"px\";\n\talertBox.style.fontSize = \"20px\";\n\n\tvar rect = alertBox.getBoundingClientRect();\n\n\tvar elmBox = this.simCanvas.getBoundingClientRect();\n\n\tvar alertBoxMsg = document.createElement(\"div\");\n\talertBoxMsg.className = \"phsim-alertbox-msg\"\n\talertBoxMsg.innerText = options.msg;\n\talertBoxMsg.style.textAlign = \"left\";\n\talertBoxMsg.style.padding = \"20px\";\n\n\talertBox.appendChild(alertBoxMsg);\n\n\tvar closeButton = document.createElement(\"div\");\n\tcloseButton.addEventListener(\"click\",options.onok);\n\tcloseButton.innerText = options.closeButtonTxt;\n\talertBox.appendChild(closeButton);\n\n\tthis.simContainer.appendChild(alertBox);\n\n\talertBox.style.position = \"absolute\";\n\talertBox.style.left = (elmBox.width * 0.5 - alertBox.offsetWidth * 0.5) + \"px\";\n\talertBox.style.top = (elmBox.height * 0.5 - alertBox.offsetHeight * 0.5) + \"px\";\n\n\treturn alertBox;\n\n}","\n// Play Audio Index\n\nPhSim.DynSim.prototype.playAudioByIndex = function(i) {\n\tthis.audioArray.array[i].play();\n}\n\nPhSim.DynSim.prototype.pauseAudioByIndex = function(i) {\n\tthis.audioArray.array[i].pause();\n}\n\nPhSim.DynSim.prototype.pauseAudioByIndex = function(i) {\n\tthis.audioArray.array[i].pause();\n}\n\nPhSim.DynSim.prototype.setAudioVolByIndex = function(i,v) {\n\tthis.audioArray.array[i].volume = v;\n\treturn this.audioArray.array[i].volume; \n}\n\nPhSim.DynSim.prototype.setAudioMuteByIndex = function(i) {\n\tthis.audioArray.array[i].muted = v;\n\treturn this.audioArray.array[i].muted;\n}\n\nPhSim.DynSim.prototype.toggleAudioByIndex = function(i) {\n\t\n\tif(\tthis.audioArray.array[i].muted === true) {\n\t\tthis.audioArray.array[i].muted = false;\n\t\treturn false;\n\t}\n\n\tif(\tthis.audioArray.array[i].muted === false) {\n\t\tthis.audioArray.array[i].muted = true;\n\t\treturn true;\n\t}\n\n}","PhSim.DynSim.prototype.registerCanvasEvents = function() {\n\n\tvar self = this;\n\n\t// onmousedown\n\n\tthis.eventStack.mousedown = []\n\n\tthis.mousedownBridge = function(e) {\n\t\tvar eventObj = new PhSim.PhMouseEvent();\n\t\tvar canvas = this.simCtx.canvas;\n\t\tvar rect = canvas.getBoundingClientRect();\n\t\teventObj.domEvent = e;\n\t\teventObj.x =  e.clientX - rect.left;\n\t\teventObj.y = e.clientY - rect.top;\n\t\teventObj.type = \"mousedown\";\n\t\teventObj.dynArr = this.pointObjArray(eventObj.x,eventObj.y);\n\n\t\tif(!self.paused) {\n\t\t\tif(self.objMouseArr.length > 0) {\n\t\t\t\tself.callEventClass(\"objmousedown\",canvas,eventObj);\n\t\t\t}\n\t\t}\n\n\t\tself.callEventClass(\"mousedown\",canvas,eventObj);\n\t}\n\n\tthis.simCanvas.addEventListener(\"mousedown\",function(e) {\n\t\tif(!self.filter) {\n\t\t\tself.mousedownBridge(e);\n\t\t}\n\t});\n\n\t// click\n\n\tthis.eventStack.click = []\n\tthis.eventStack.objclick = []\n\n\tthis.clickBridge = function(e) {\n\t\tvar eventObj = new PhSim.PhMouseEvent();\n\t\tvar canvas = this.simCtx.canvas;\n\t\tvar rect = canvas.getBoundingClientRect();\n\t\teventObj.domEvent = e;\n\t\teventObj.x =  e.clientX - rect.left;\n\t\teventObj.y = e.clientY - rect.top;\n\t\teventObj.type = \"click\";\n\t\teventObj.dynArr = this.pointObjArray(eventObj.x,eventObj.y);\n\n\n\t\tif(self.objMouseArr.length > 0) {\n\t\t\tself.callEventClass(\"objclick\",canvas,eventObj);\n\t\t}\n\n\t\tself.callEventClass(\"click\",canvas,eventObj);\n\t}\n\n\tthis.simCanvas.addEventListener(\"click\",function(e) {\n\t\tif(!self.filter) {\n\t\t\tself.clickBridge(e);\n\t\t}\n\t});\n\n\t//mousemove\n\n\tthis.eventStack.mousemove = this.eventStack.mousemove || []\n\tthis.eventStack.objmousemove = this.eventStack.objmousemove || []\n\n\tthis.mousemoveBridge = function(e) {\n\t\tvar eventObj = new PhSim.PhMouseEvent();\n\t\tvar canvas = this.simCtx.canvas;\n\t\tvar rect = canvas.getBoundingClientRect();\n\t\teventObj.domEvent = e;\n\n\t\teventObj.x =  e.clientX - rect.left;\n\t\teventObj.y = e.clientY - rect.top;\n\n\t\tif(self.mouseX && self.mouseY) {\n\t\t\tself.prevMouseX = self.mouseX;\n\t\t\tself.prevMouseY = self.mouseY;\n\t\t}\n\n\t\tself.prevObjMouseArr = [];\n\n\t\tif(self.objMouseArr) {\n\t\t\tself.prevObjMouseArr = [...self.objMouseArr];\n\t\t}\n\n\t\tself.mouseX = eventObj.x;\n\t\tself.mouseY = eventObj.y;\n\t\n\t\tself.dynArr = self.objMouseArr;\n\n\t\tself.objMouseArr = [];\n\t\tself.formerMouseObjs = [];\n\t\tself.newMouseObjs = [];\n\n\t\tif(self.init) {\n\n\t\t\tfor(i = 0; i < self.objUniverse.length; i++) {\n\n\t\t\t\tif(self.pointInObject(self.objUniverse[i],self.mouseX,self.mouseY)) {\n\t\t\t\t\tself.objMouseArr.push(self.objUniverse[i])\n\t\t\t\t}\n\t\n\t\t\t\tif(!self.objMouseArr.includes(self.objUniverse[i]) && self.prevObjMouseArr.includes(self.objUniverse[i])) {\n\t\t\t\t\tself.formerMouseObjs.push(self.objUniverse[i])\n\t\t\t\t}\n\t\n\t\t\t\tif(self.objMouseArr.includes(self.objUniverse[i]) && !self.prevObjMouseArr.includes(self.objUniverse[i])) {\n\t\t\t\t\tself.newMouseObjs.push(self.objUniverse[i])\n\t\t\t\t}\n\t\n\t\t\t}\n\n\t\t\tif(self.objMouseArr.length > 0) {\n\t\t\t\tself.callEventClass(\"objmousemove\",canvas,eventObj);\n\t\t\t}\n\n\t\t\tif(self.newMouseObjs.length > 0) {\n\t\t\t\teventObj.newMouseObjs = self.newMouseObjs;\n\t\t\t\tself.callEventClass(\"objmouseover\",canvas,eventObj);\n\t\t\t}\n\n\t\t\tif(self.formerMouseObjs.length > 0) {\n\t\t\t\teventObj.formerMouseObjs = self.formerMouseObjs;\n\t\t\t\tself.callEventClass(\"objmouseout\",canvas,eventObj);\n\t\t\t}\n\t\t}\n\n\t\t//console.log(self.objMouseArr)\n\n\t\tself.callEventClass(\"mousemove\",canvas,eventObj);\n\n\t\t//console.log(eventObj);\n\t}\n\n\tthis.simCanvas.addEventListener(\"mousemove\",function(e) {\n\t\tif(!self.filter) {\n\t\t\tself.mousemoveBridge(e);\n\t\t}\n\t});\n\n\t/*** Mouseup bridge ***/\n\n\tthis.eventStack.objmouseup = [];\n\n\tthis.mouseupBridge = function(e) {\n\t\tvar eventObj = new PhSim.PhMouseEvent();\n\t\tvar canvas = this.simCtx.canvas;\n\t\tvar rect = canvas.getBoundingClientRect();\n\t\teventObj.domEvent = e;\n\t\teventObj.x =  e.clientX - rect.left;\n\t\teventObj.y = e.clientY - rect.top;\n\t\tself.mouseX = eventObj.x;\n\t\tself.mouseY = eventObj.y;\n\n\t\tif(self.objMouseArr.length > 0) {\n\t\t\tself.callEventClass(\"objmouseup\",canvas,eventObj);\n\t\t}\n\n\t\tself.callEventClass(\"mouseup\",canvas,eventObj);\n\t}\n\n\tthis.simCanvas.addEventListener(\"mouseup\",function(e) {\n\t\tif(!self.filter) {\n\t\t\tself.mouseupBridge(e);\n\t\t}\n\t});\n\n\t/*** Mouseout bridge ***/\n\n\tthis.mouseoutBridge = function(e) {\n\t\tvar eventObj = new PhSim.PhMouseEvent();\n\t\tvar canvas = this.simCtx.canvas;\n\t\tvar rect = canvas.getBoundingClientRect();\n\t\teventObj.domEvent = e;\n\t\teventObj.x =  e.clientX - rect.left;\n\t\teventObj.y = e.clientY - rect.top;\n\t\tself.mouseX = eventObj.x;\n\t\tself.mouseY = eventObj.y;\n\t\tself.callEventClass(\"mouseout\",canvas,eventObj);\n\t}\n\n\tthis.simCanvas.addEventListener(\"mouseout\",function(e) {\n\t\tif(!self.filter) {\n\t\t\tself.mouseoutBridge(e);\n\t\t}\n\t});\n\n}\n\nPhSim.DynSim.prototype.registerKeyEvents = function() {\n\n\tvar self = this;\n\n\tthis.keydownBridge = function(e) {\n\t\tvar eventObj = new PhSim.PhKeyEvent();\n\t\teventObj.domEvent = e;\n\t\teventObj.key = e.key;\n\t\teventObj.code = e.code;\n\t\teventObj.type = \"keydown\";\n\t\tself.callEventClass(\"keydown\",self,eventObj);\n\t}\n\n\tthis.keydownBridgeWrapper = function(e) {\n\t\tif(!self.filter) {\n\t\t\tself.keydownBridge(e);\n\t\t}\n\t}\n\n\twindow.addEventListener(\"keydown\",this.keydownBridgeWrapper);\n}\n\nPhSim.DynSim.prototype.deregisterKeyEvents = function() {\n\twindow.removeEventListener(\"keydown\",this.keydownBridgeWrapper);\n}","/**\n * \n * Used to add events to a PhSim simulation\n * \n * \n * @param {string} eventStr - String representing the event.\n * @param {PhSimEventCall} call - Function to run when event is executed.\n * @param {object} [options = {}] - Event Listener Options.\n * @param {boolean} [options.once] - If true, the function is executed only once.\n * @param {boolean} [options.slEvent] - If true, the event will be removed when the simulation changes\n * \n */\n\n\n\n\nPhSim.DynSim.prototype.addEventListener = function(eventStr,call,options = {}) {\n\t\n\t\n\n\tif(options && options.slEvent === true) {\n\t\tif(this.slEventStack[eventStr]) {\n\t\t\tthis.slEventStack[eventStr].push(call);\n\t\t}\n\t}\n\n\telse {\n\t\tif(this.eventStack[eventStr]) {\n\t\t\tthis.eventStack[eventStr].push(call);\n\t\t}\n\t}\n\n\n\tif(options) {\n\t\tif(options === true) {\n\t\t\tif(options.once) {\n\t\n\t\t\t\tvar f = function(e) {\n\t\t\t\t\tthis.removeEventListener(eventStr,call)\n\t\t\t\t\tthis.removeEventListener(eventStr,f)\n\t\t\t\t}\n\t\n\t\t\t\tthis.addEventListener(eventStr,f);\n\n\t\t\t}\n\t\t}\n\n\t}\n\n\n\telse {\n\t\tthrow new Error(\"Event Target Not Available\")\n\t}\n\n}\n\n/**\n * \n * @param {*} eventStr \n * @param {*} call \n */\n\n\nPhSim.DynSim.prototype.removeEventListener = function(eventStr,call) {\n\t\n\tif(this.eventStack[eventStr] && this.eventStack[eventStr].includes(call)) {\n\t\tvar callIndex = this.eventStack[eventStr].indexOf(call);\n\t\tthis.eventStack[eventStr].splice(callIndex,1);\n\t}\n\n\tif(this.slEventStack[eventStr] && this.slEventStack[eventStr].includes(call)) {\n\t\tvar callIndex = this.slEventStack[eventStr].indexOf(call);\n\t\tthis.slEventStack[eventStr].splice(callIndex,1);\n\t}\n\n}\n\nPhSim.DynSim.prototype.callEventClass = function(eventStr,thisArg,eventArg) {\n\t\n\tif(this.eventStack[eventStr]) {\n\t\tfor(var i = 0; i < this.eventStack[eventStr].length; i++) {\n\t\t\tvar func = this.eventStack[eventStr][i]\n\t\t\teventArg.func = func;\n\t\t\tfunc.call(thisArg,eventArg);\n\n\t\t}\n\t}\n\n\tif(this.slEventStack[eventStr]) {\n\t\tfor(var i = 0; i < this.slEventStack[eventStr].length; i++) {\n\n\t\t\tvar func = this.slEventStack[eventStr][i]\n\t\t\teventArg.func = func;\n\t\t\tfunc.call(thisArg,eventArg);\n\n\t\t}\n\t}\n}","// Newtonian Gravity\n\nPhSim.DynSim.prototype.applyGravitationalField = function() {\n\t\n\tvar a = this.objUniverse;\n\n\tfor(var i = 0; i < a.length; i++) {\n\t\tfor(var j = 0; j < a.length; j++) {\n\t\t\tif(i !== j && !a[i].matter.isStatic && !a[j].matter.isStatic) {\n\t\t\t\tvar a1 = PhSim.Tools.scaleVector(PhSim.Tools.subtractVectors(a[j].matter.position,a[i].matter.position),6.67 * Math.pow(10,-11) * a[i].matter.mass * a[j].matter.mass * -1)\n\t\t\t\tvar b1 = Math.pow(PhSim.Tools.calcVertDistance(a[j].matter.position,a[i].matter.position),3);\n\t\t\t\tvar c = PhSim.Tools.divideVector(a1,b1);\n\t\t\t\tthis.applyForce(a[j],a[i].matter.position,c);\n\t\t\t}\n\t\t}\t\n\t}\n\n}\n","PhSim.DynSim.prototype.play = function() {\n\n\tif(this.init === false) {\n\t\tthis.initSim(0);\n\t}\n\n\telse {\n\t\tthis.paused = false;\n\t}\n\n}\n\nPhSim.DynSim.prototype.toggle = function() {\n\t\n\tif(this.paused === false) {\n\t\tthis.paused = true;\n\t\treturn true;\n\t}\n\n\tif(this.paused === true) {\n\t\tthis.paused = false;\n\t\treturn false;\n\t}; \n\n}\n\nPhSim.DynSim.prototype.pause = function() {\n\tthis.paused = true;\n}\n\nPhSim.DynSim.prototype.exitSl = function() {\n\tthis.callEventClass(\"beforeslchange\",this,new PhSim.PhEvent());\n\tthis.paused = false;\n\tclearInterval(this.intervalLoop);\n}\n\nPhSim.DynSim.prototype.exit = function() {\n\tthis.callEventClass(\"exit\",this,new PhSim.PhEvent());\n\tthis.deregisterKeyEvents();\n\tthis.exitSl();\n}","/**\n * Go to simulation in the composite simulation\n * @param {Number} i \n */\n\nPhSim.DynSim.prototype.gotoSimulationIndex = function (i) {\n\n\tvar self = this;\n\n\tthis.firstSlUpdate = false;\n\n\tvar event = new PhSim.PhEvent();\n\n\tevent.type = \"slchange\";\n\n\tthis.callEventClass(\"beforeslchange\",this,event);\n\n\tif(!this.noCamera) {\n\t\tthis.camera.translate(-this.camera.x,-this.camera.y);\n\t}\n\n\tif(this.simCtx) {\n\t    this.drawLoadingScreen();\n\t}\n\t\n\t//this.dynsimulation = new DynSL(this.sim.simulations[i],this.simCtx);\n\n\tthis.slEventStack = new PhSim.EventStack();\n\n\tthis.simulation = this.sim.simulations[i];\n\n\tthis.simulationIndex = i;\n\n\tif(this.simCtx) {\n\t\tthis.width = this.simCtx.canvas.width;\n\t\tthis.height = this.simCtx.canvas.height;\n\t}\n\t\n\tthis.paused = false;\n\n\n\tif(this.paused) {\n\t\tthis.paused = false;\n\t}\n\n\telse {\n\n\t\tvar this_a = this;\n\n\t\tthis.matterJSWorld = Matter.World.create();\n\t\tthis.dynTree = [];\n\t\tthis.objUniverse = [];\n\t\tthis.staticSprites = [];\n\t\tthis.staticAudio = [];\n\t\tthis.audioPlayers = 0;\n\t\tthis.collisionClasses = {};\n\n\t\tthis.matterJSEngine = Matter.Engine.create({\n\t\t\tworld: this_a.matterJSWorld\n\t\t});\n\n\t\tvar ncc = new PhSim.CollisionClass(\"__main\");\n\t\tncc.engine = this.matterJSEngine;\n\t\tncc.world = this.matterJSWorld;\n\n\t\tthis.collisionClasses[\"__main\"] = ncc;\n\n\t\tif(this.sim.simulations) {\n\t\t\n\t\t\tfor(var L = 0; L < this.simulation.layers.length; L++) {\n\n\t\t\t\tvar layerComposite = Matter.Composite.create();\n\t\t\t\tvar layerBranch = [];\n\n\t\t\t\tfor(var O = 0; O < this.simulation.layers[L].objUniverse.length; O++) {\n\t\t\t\t\t\n\t\t\t\t\tif(this.simulation.layers[L].objUniverse[O].noDyn || this.simulation.layers[L].objUniverse[O].permStatic) {\n\t\t\t\t\t\tlayerBranch.push(this.simulation.layers[L].objUniverse[O]);\n\t\t\t\t\t\tthis.objUniverse.push(this.simulation.layers[L].objUniverse[O]);\n\t\t\t\t\t\tthis.staticSprites.push(this.simulation.layers[L].objUniverse[O].sprite)\t\t\t\t\n\t\t\t\t\t}\n\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar dynObject = new PhSim.DynObject(this.simulation.layers[L].objUniverse[O])\n\t\t\t\t\t\t\n\t\t\t\t\t\t// If the collision class object exists\n\n\t\t\t\t\t\tif(dynObject.static.collisionClass && dynObject.static.collisionClass.trim() !== \"__main\") {\n\n\t\t\t\t\t\t\tvar a = this.getCollisionClasses(dynObject);\n\n\t\t\t\t\t\t\tfor(var i = 0; i < a.length; i++) {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(this.collisionClasses[a[i]]) {\n\t\t\t\t\t\t\t\t\tthis.collisionClasses[a[i]].addDynObject(dynObject)\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tvar ncc = new PhSim.CollisionClass(a[i]);\n\t\t\t\t\t\t\t\t\tncc.addDynObject(dynObject);\n\t\t\t\t\t\t\t\t\tthis.collisionClasses[a[i]] = ncc;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tMatter.World.add(layerComposite,dynObject.matter);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(dynObject.static.widgets) {\n\t\t\t\t\t\t\tthis.extractWidgets(dynObject);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlayerBranch.push(dynObject);\n\t\t\t\t\t\tthis.objUniverse.push(dynObject);\n\t\t\t\t\t\tdynObject.layerBranch = layerBranch;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(dynObject.static.sprite) {\n\t\t\t\t\t\t\tthis.staticSprites.push(dynObject.static.sprite)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tMatter.World.add(this.matterJSWorld,layerComposite);\n\t\t\t\tthis.dynTree.push(layerBranch);\n\n\t\t\t\tvar a = new PhSim.PhDynEvent();\n\t\t\t\tthis_a.callEventClass(\"matterJSLoad\",this_a,a);\n\n\t\t\t}\n\n\t\t}\n\n\t\tMatter.Events.on(this.matterJSEngine,\"collisionStart\",function(event) {\n\t\t\t\n\t\t\tvar a = new PhSim.PhDynEvent();\n\t\t\ta.matterEvent = event;\n\t\t\tthis_a.callEventClass(\"collisionstart\",this_a,a);\n\n\t\t});\n\n\t\tif(this.simulation.game) {\n\t\t\tthis.lclGame = this.extractLclGame(this.simulation.game);\n\t\t}\n\n\t\tfor(var C = 0; C < this_a.simulation.widgets.length; C++) {\n\t\t\t\t\n\t\t\tvar a = this_a.simulation.widgets[C];\n\n\t\t\tif(a.constraint) {\n\n\t\t\t\tvar b = {}\n\n\t\t\t\tif(a.objectA) {\n\t\t\t\t\tb.bodyA = this_a.LO(a.objectA.L,a.objectA.O);;\n\t\t\t\t}\n\n\t\t\t\tif(a.objectB) {\n\t\t\t\t\tb.bodyB = this_a.LO(a.objectB.L,a.objectB.O);\n\t\t\t\t}\n\n\t\t\t\tif(a.pointA) {\n\t\t\t\t\tb.pointA = a.pointA;\n\t\t\t\t}\n\n\t\t\t\tif(a.pointB) {\n\t\t\t\t\tb.pointB = a.pointB;\n\t\t\t\t}\n\n\t\t\t\tvar c = Matter.Constraint.create(b);\n\n\t\t\t\tMatter.World.add(this.matterJSWorld,c)\n\n\t\t\t}\n\n\t\t\tif(a.connection) {\n\n\t\t\t\tthis_a.connectDynObjects(this_a.dynTree[a.objectA.L][a.objectA.O],this_a.dynTree[a.objectB.L][a.objectB.O]);\n\n\t\t\t}\n\n\n\n\t\t}\n\n\t\tvar promise = new Promise(function(resolve,reject){\n\n\t\t\tif(self.phRender) {\n\t\t\t\tself.phRender.spriteImgArray = new PhSim.Sprites.SpriteImgArray(self.staticSprites,function() {\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\telse {\n\t\t\t\tresolve();\n\t\t\t}\n\n\t\t}).then(function() {\n\t\t\treturn new Promise(function(resolve,reject){\n\t\t\t\tself.audioArray = new PhSim.Audio.AudioArray(self.staticAudio,function(){\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t})\n\t\t}).then(function(){\n\t\t\tthis_a.intervalLoop = setInterval(this_a.loopFunction.bind(this_a),this_a.delta);\n\t\t\tthis_a.init = true;\n\t\t});\n\n\t\t\n\t\t//return this.MatterJSEngine;\n\n\t}\n\n\n\n\treturn this.dynsimulation;\n}\n\nPhSim.DynSim.prototype.initSim = function(simulationI) {\n\n\tthis.status = 1;\n\tvar self = this;\n\tthis.status = 2;\n\n\tthis.status = 3;\n\tvar e = new PhSim.PhEvent();\n\tself.gotoSimulationIndex(0);\n\tself.callEventClass(\"load\",self,e);\n\tself.addEventListener(\"collisionstart\",function() {\n\t\t//self.playAudioByIndex(self.simulation.collisionSound);\n\t});\n\tself.status = 4;\n\n}","PhSim.DynSim.prototype.applyForce = function(dynObject,position,forceVector) {\n\treturn Matter.Body.applyForce(dynObject.matter,position,forceVector);\n}\n\nPhSim.DynSim.prototype.setVelocity = function(dynObject,velocityVector) {\n\treturn Matter.Body.setVelocity(dynObject.matter,velocityVector);\n}\n\nPhSim.DynSim.prototype.translate = function(dynObject,translationVector) {\n\treturn Matter.Body.translate(dynObject.matter,translationVector);\n}\n\nPhSim.DynSim.prototype.setPosition = function(dynObject,positionVector) {\n\tMatter.Body.setPosition(dynObject.matter,positionVector);\n}\n\nPhSim.DynSim.prototype.rotate = function(dynObject,angle,point) {\n\treturn Matter.Body.rotate(dynObject.matter, angle, point)\n}\n\nPhSim.DynSim.prototype.setAngle = function(dynObject,angle) {\n\treturn Matter.Body.setAngle(dynObject.matter,angle);\n}","PhSim.DynSim.prototype.assignPhRender = function(phRender) {\n\n\t/** PhRender object */\n\n\tthis.phRender = phRender;\n\n\t/** Refence to simulation in PhRender */\n\n\tthis.phRender.sim = this.sim;\n\n\t/** Refence to dynamic simulation in PhRender */\n\n\tthis.phRender.dynSim = this;\n\treturn phRender;\n}\n\nPhSim.DynSim.prototype.setRadius = function(dynObject,radius) {\n\n\tvar ratio = radius / dynObject.object.radius;\n\n\tif(dynObject.object.regPolygon || dynObject.object.circle) {\n\t\tMatter.Body.scale(dynObject.object, ratio, ratio);\n\t}\n\n}\n\nPhSim.DynSim.prototype.setRectWidthAndHeight = function(dynObject,w,h) {\n\n}\n\n/**\n * \n * @param {*} dyn_object - Dynamic Object\n * @param {*} colorStr - Color\n */\n\nPhSim.DynSim.prototype.setColor = function(dyn_object,colorStr) {\n\tdyn_object.object.fillStyle = colorStr;\n}\n\n/**\n * \n * @param {*} dyn_object \n * @param {*} colorStr \n */\n\nPhSim.DynSim.prototype.setBorderColor = function(dyn_object,colorStr) {\n\tdyn_object.object.strokeStyle = colorStr;\n}\n\n/**\n * \n * @param {*} dyn_object \n * @param {*} lineWidth \n */\n\nPhSim.DynSim.prototype.setLineWidth = function(dyn_object,lineWidth) {\n\tdyn_object.object.lineWidth = lineWidth;\n}","PhSim.DynSim.prototype.updateDynObj = function(currentObj) {\n\n\n\t// Loop must start at index 1 because the first element in the array is a reference to the parent object itself.\n\n\tif(currentObj.noDyn || currentObj.permStatic) {\n\t\tthis.phRender.renderStatic(currentObj);\t\n\t}\n\t\n\telse {\n\n\t\tif(currentObj.object.circle || currentObj.object.regPolygon || currentObj.object.rectangle) {\n\t\t\tcurrentObj.object.cycle = currentObj.firstCycle + currentObj.matter.angle;\n\t\t}\n\t\n\t\tif(currentObj.object.rectangle) {\n\t\t\t\n\t\t\tvar v = {\n\t\t\t\t\"x\": currentObj.matter.position.x - currentObj.matter.positionPrev.x,\n\t\t\t\t\"y\": currentObj.matter.position.y - currentObj.matter.positionPrev.y \n\t\t\t}\n\t\n\t\t\tcurrentObj.object.x = currentObj.matter.position.x - currentObj.object.w * 0.5\n\t\t\tcurrentObj.object.y = currentObj.matter.position.y - currentObj.object.h * 0.5\n\t\n\t\t}\n\t\n\t\tif(currentObj.object.circle || currentObj.object.regPolygon) {\n\t\t\tcurrentObj.object.x = currentObj.matter.position.x;\n\t\t\tcurrentObj.object.y = currentObj.matter.position.y;\n\t\t}\n\t\n\t\tif(currentObj.object.path) {\n\t\t\tPhSim.calc_skinmesh(currentObj);\n\t\t}\n\n\t\tif(this.phRender) {\t\n\t\t\tthis.phRender.dynamicRenderDraw(currentObj);\n\t\t}\n\n\t}\n\n\tvar event = new PhSim.PhEvent();\n\tevent.type = \"objupdate\";\n\tevent.target = currentObj;\n\n\tthis.callEventClass(\"objupdate\",this,event);\n\n}\n\nPhSim.DynSim.prototype.loopFunction = function() {\n\n\tif(this.paused === false) {\n\n\t\tvar beforeUpdateEvent = new PhSim.PhDynEvent()\n\n\t\tbeforeUpdateEvent.simulation = this.simulation;\n\n\t\tthis.prevDate = this.prevDate && this.updateDate;\n\t\n\t\tthis.callEventClass(\"beforeupdate\",this,beforeUpdateEvent);\n\n\t\tthis.updateDate = new Date();\n\n\t\tif(this.prevDate) {\n\t\t\tthis.updateTimeInterval = this.updateDate - this.prevDate;\n\t\t}\n\n\t\tfor(var c in this.collisionClasses) {\n\t\t\tMatter.Engine.update(this.collisionClasses[c].engine,this.delta);\n\t\t}\n\n\t\tif(this.simCtx) {\n\n\t\t\tthis.simCtx.fillStyle = this.simulation.world.bg;\n\n\t\t\tif(this.noCamera) {\n\t\t\t\tthis.simCtx.fillRect(0,0,this.width,this.height);\n\t\t\t}\n\t\n\t\t\telse {\n\t\t\t\tthis.simCtx.fillRect(0 - this.camera.x,0 - this.camera.y,this.width / this.camera.scale,this.height / this.camera.scale);\n\t\t\t}\n\t\t}\n\n\t\tfor(i = 0; i < this.objUniverse.length; i++) {\n\t\t\tthis.updateDynObj(this.objUniverse[i]);\n\t\t}\n\t\n\t\tthis.applyGravitationalField()\n\n\t\tvar afterUpdateEvent = new PhSim.PhDynEvent()\n\n\t\tafterUpdateEvent.simulation = this.simulation;\n\n\t\tthis.sl_time = this.sl_time + this.delta;\n\n\t\tif(this.filter) {\n\t\t\tthis.simCtx.fillStyle = \"rgba(3,3,3,0.7)\";\n\t\t\tthis.simCtx.fillRect(0,0,this.width / this.camera.scale,this.height / this.camera.scale);\n\t\t}\n\n\t\tif(!this.firstSlUpdate) {\n\t\t\tthis.callEventClass(\"firstslupdate\",this,afterUpdateEvent);\n\t\t}\n\n\t\tthis.firstSlUpdate = true;\n\n\t\tthis.callEventClass(\"afterupdate\",this,afterUpdateEvent);\n\n\t\t//this.renderAllCounters();\n\n\n\t}\n\n}","/** \n * \n * Extract Widgets from Dynamic Object.\n * To extract a widget in PhSim is to read all of the objects in the \"widgets\" array found in each\n * well-formed PhSim object and then translate it into JavaScript.\n * \n * @param {Object} widget - The Widget\n * @param {PhSim.DynObject} dyn_object The individual Dynamic Object\n * @returns undefined\n * \n*/\n\nPhSim.DynSim.prototype.extractWidget = function(widget,dyn_object) {\n\t\n    var self = this;\n    \n        if(widget.changeSl) {\n    \n            var closure = function() {\n    \n                var i = widget.slIndex;\n    \n                var f = function() {\n                    self.gotoSimulationIndex(i)\n                }\n    \n                return f;\n            }\n    \n            this.addSimpleEvent(widget.trigger,closure(),{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.numVar) {\n            self.numVar[widget.name] === widget.value;\n        }\n        \n        if(widget.keyboardControls) {\n            this.addKeyboardControls(dyn_object,widget)\n        }\n    \n        if(widget.circularConstraint) {\n            this.createCircularConstraint(dyn_object,widget.x,widget.y);\n        }\n    \n        if(widget.setNumVar) {\n    \n            var closure = function() {\n    \n                var c = widget.value;\n                var a = widget.name;\n    \n                var f = function() {\n                    self.numVar[a] === c;\n                }\n    \n                return f;\n            }\n    \n            this.addSimpleEvent(widget.trigger,closure(),{\n                ...widget,\n                triggerObj: dyn_object\n            });\n    \n        }\n    \n        if(widget.force) {\n            var f = this.createMotionFunction(\"force\",dyn_object,widget.vector);\n            this.addSimpleEvent(widget.trigger,f,{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.velocity) {\n            var f = this.createMotionFunction(\"velocity\",dyn_object,widget.vector);\n            this.addSimpleEvent(widget.trigger,f,{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.translate) {\n            var f = this.createMotionFunction(\"translate\",dyn_object,widget.vector);\n            this.addSimpleEvent(widget.trigger,f,{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.position) {\n            var f = this.createMotionFunction(\"position\",dyn_object,widget.vector);\n            this.addSimpleEvent(widget.trigger,f,{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.rotation) {\n    \n            if(widget.circularConstraintRotation) {\n                var f = this.createMotionFunction(\"circular_constraint_rotation\",dyn_object,widget.cycle);\n            }\n    \n            else {\n                var f = this.createMotionFunction(\"rotation\",dyn_object,widget.cycle);\n            }\n            \n            this.addSimpleEvent(widget.trigger,f,{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.setAngle) {\n            \n            if(widget.circularConstraintRotation) {\n                var f = this.createMotionFunction(\"circular_constraint_setAngle\",dyn_object,widget.cycle);\n            }\n    \n            else {\n                var f = this.createMotionFunction(\"setAngle\",dyn_object,widget.cycle);\n            }\n            \n            this.addSimpleEvent(widget.trigger,f,{\n                ...widget,\n                triggerObj: dyn_object\n            });\t\t\n        }\n    \n        if(widget.deleteSelf) {\n    \n            var ref = null;\n    \n            var closure = function() {\n    \n                var o = dyn_object;\n    \n                var f = function(){\n                    self.removeDynObj(o);\n                    self.removeSimpleEvent(ref);\n                }\n    \n                return f;\n            }\n    \n            var ref = this.addSimpleEvent(widget.trigger,closure(),{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.toggleLock) {\n            \n        }\n    \n        if(widget.clone) {\n    \n            // Clone By Time\n    \n            if(widget.trigger === \"time\") {\n            \n                var getFunction = function() {\n    \n                    var time = widget.time;\n                    var maxN = widget.maxN;\n    \n                    var func = null;\n    \n                    if(Number.isInteger(maxN)) {\n    \n                        func = function(e) {\n    \n                            if(func.__n === maxN) {\n                                clearInterval(func.__interN);\n                            }\n    \n                            else {\n                                if(!self.paused) {\n                                    self.spawnObject(dyn_object);\n                                    func.__n++;\n                                }\n                            }\n    \n                        }\n    \n                        func.__n = 0;\n    \n                    }\n    \n                    else {\n    \n                        func = function(e) {\n                            if(!self.paused) {\n                                self.spawnObject(dyn_object);\n                            }\n                        }\n    \n                    }\n    \n    \n                    func.__phtime = time;\n                    func.__interN = null;\n    \n                    return func;\n    \n                }\n    \n                var refFunc = getFunction();\n    \n                refFunc.__interN = setInterval(refFunc,refFunc.__phtime);\n    \n            }\n    \n            // Clone By Key\n    \n            if(widget.trigger === \"key\") {\n    \n                var getFunction = function() {\n    \n                    var kc = widget.key;\n                    var vc = widget.vector;\n    \n                    var cloneByKeyFunc = function(e) {\n                        if(e.key === kc) {\n                            self.spawnObject(dyn_object,vc);\n                        }\n                    }\n    \n                    return cloneByKeyFunc;\n    \n                }\n    \n                this.addEventListener(\"keydown\",getFunction());\n    \n            }\n    \n        }\n    \n        if(widget.draggable) {\n    \n    \n            var func = function(e) {\n    \n                var change = false;\n                var __ismoving = true;\n                var constraint = null;\n    \n                // Displacement vector between mouse and centroid of object when the mouse is pushed downwards.\n    \n                var delta = {}\n    \n                // Mouse Position\n    \n                var mV = {\n                    x: null,\n                    y: null\n                }\n    \n                var __onmousemove = function(e) {\n                    mV.x = e.x - delta.x;\n                    mV.y = e.y - delta.y;\n                }\n    \n                var __onmouseup = function() {\n                    self.removeEventListener(\"mousemove\",__onmousemove);\n                    self.removeEventListener(\"mouseup\",__onmouseup);\n                    self.removeEventListener(\"beforeupdate\",__onbeforeupdate);\n                }\n    \n                var __onbeforeupdate = function() {\n                    Matter.Body.setVelocity(dyn_object.matter,{x:0,y:0});\n                    self.setPosition(dyn_object,mV);\n                }\n    \n                var __onmousedown = function(e) {\n                    if(self.pointInObject(dyn_object,e.x,e.y)) {\n    \n                        delta.x = e.x - dyn_object.matter.position.x;\n                        delta.y = e.y - dyn_object.matter.position.y;\n    \n                        self.addEventListener(\"mousemove\",__onmousemove);\n                        self.addEventListener(\"mouseup\",__onmouseup);\n                        self.addEventListener(\"beforeupdate\",__onbeforeupdate);\n    \n                        __onmousemove(e);\n                    }\n                }\n                \n                self.addEventListener(\"mouseout\",__onmouseup);\n    \n                return __onmousedown;\n    \n            }\n    \n            this.addEventListener(\"mousedown\",func());\n        }\n    \n        if(widget.rectText) {\n            dyn_object.rectTextWidget === true;\n        }\n    \n        if(widget.coin) {\n    \n            var func = function() {\n    \n                var obj1 = dyn_object;\n    \n                var a = function() {\n    \n                    if(self.inSensorCollision(obj1) && self.lclGame) {\n                        self.lclGame.setScore(self.lclGame.score + 1);\n                        self.removeEventListener(\"collisionstart\",a);\t\n                    }\n    \n                }\n    \n                return a;\n    \n            }\n    \n            self.addEventListener(\"collisionstart\",func());\n        \n        }\n        \n        if(widget.hazard) {\n    \n            var func = function() {\n    \n                var obj1 = dyn_object;\n    \n                var a = function() {\n    \n                    if(self.inSensorCollision(obj1) && self.lclGame) {\n                        self.lclGame.decrementLife(self.lclGame.score + 1);\n                        self.removeEventListener(\"collisionstart\",a);\t\n                    }\n    \n                }\n    \n                return a;\n    \n            }\n    \n            self.addEventListener(\"collisionstart\",func());\n    \n        }\n    \n        if(widget.health) {\n    \n            var func = function() {\n    \n                var obj1 = dyn_object;\n    \n                var a = function() {\n    \n                    if(self.inSensorCollision(obj1) && self.lclGame) {\n                        self.lclGame.incrementLife(self.lclGame.score + 1);\n                        self.removeEventListener(\"collisionstart\",a);\t\n                    }\n    \n                }\n    \n                return a;\n    \n            }\n    \n            self.addEventListener(\"collisionstart\",func());\n    \n        }\n    \n        if(widget.noRotation) {\n            Matter.Body.setInertia(dyn_object.matter, Infinity)\n        }\n    \n        if(widget.elevator) {\n            \n    \n            var func = function() {\n            \n                var type = widget.type;\n    \n                var obj = dyn_object;\n                var relVec = PhSim.Tools.subtractVectors(widget.pointB,widget.pointA);\n                \n                var u = PhSim.Tools.getUnitVector(relVec);\n                \n                var ax;\n                var ay;\n                var bx;\n                var by;\n                \n                // Corrections\n                \n                var reversable = true;\n                \n                // Condition function for checking if object is in bounds\n                \n                var cond_f = function() {}\n                \n                if(type === \"x-bounded\") {\n    \n                    if(widget.pointA.x < widget.pointB.x) {\n                        ax = widget.pointA.x;\n                        bx = widget.pointB.x;\n                    }\n                    \n                    if(widget.pointB.x < widget.pointA.x) {\n                       ax = widget.pointB.x;\n                       bx = widget.pointA.x;\n                    }\n                \n                    cond_f = function() {\n                        return (ax <= obj.matter.position.x) && (obj.matter.position.x <= bx);\n                    }\n                \n                }\n                \n                if(type === \"y-bounded\") {\n    \n                    if(widget.pointA.y < widget.pointB.y) {\n                        ay = widget.pointA.y;\n                        by = widget.pointB.y;\n                    }\n                    \n                    if(widget.pointB.y < widget.pointA.y) {\n                       ay = widget.pointB.y;\n                       by = widget.pointA.y;\n                    }\n                \n                    cond_f = function() {\n                        return (ay <= obj.matter.position.y) && (obj.matter.position.y <= by);\n                    }\n                \n                }\n                \n                // Set body static\n                \n                Matter.Body.setStatic(dyn_object.matter,true);\n                \n                // Event function\n    \n                var inRange = function() {\n        \n                if( cond_f() ) {\n                self.translate(obj,PhSim.Tools.scaleVector(u,1));\n                        reversable = true;\n                }\n                  \n                    else {\n                    \n                        if(reversable) {\n    \n                            u = {\n                                \"x\": -u.x,\n                                \"y\": -u.y\n                            }\n    \n                            reversable = false;\n                        }\n    \n                        else {\n                            self.translate(obj,PhSim.Tools.scaleVector(u,1));\n                        }\n                    \n                    }\n                    \n    \n                }\n    \n                return inRange\n    \n    \n            }\n    \n            this.addEventListener(\"afterupdate\",func());\n    \n        }\n    \n        if(widget.setColor) {\n    \n    \n            var closure = function() {\n                \n                var color = widget.color;\n                var obj = dyn_object;\n    \n                var f = function() {\n                    self.setColor(obj,color);\n                }\n    \n                return f;\n    \n            }\n    \n            var f = this.addSimpleEvent(widget.trigger,closure(),{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n    \n        if(widget.setBorderColor) {\n    \n            var closure = function() {\n    \n                var color = widget.color\n                var obj = dyn_object;\n    \n                var f = function() {\n                    self.setBorderColor(obj,color);\n                }\n    \n                return f;\n    \n            }\n    \n            var f = this.addSimpleEvent(widget.trigger,closure(),{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n        \n        if(widget.setLineWidth) {\n            var f = this.addSimpleEvent(widget.trigger,function(){\n                self.setLineWidth(dyn_object,widget.color);\n            },{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n        \n        if(widget.endGame) {\n            var f = this.createMotionFunction(\"position\",dyn_object,widget.vector);\n            this.addSimpleEvent(widget.trigger,f,{\n                ...widget,\n                triggerObj: dyn_object\n            });\n        }\n        \n        if(widget.playAudio) {\n    \n            var i = this.audioPlayers;\n    \n            this.staticAudio.push(widget);\n    \n            var f = this.addSimpleEvent(widget.trigger,function(){\n                self.playAudioByIndex(i);\n            },{\n                ...widget,\n                triggerObj: dyn_object\n            });\n    \n            this.audioPlayers++;\n        }\n    \n        if(widget.transformCameraByObj) {\n    \n            var self = this;\n    \n            this.addEventListener(\"afterupdate\",function(){\n                var dx = dyn_object.matter.position.x - dyn_object.matter.positionPrev.x;\n                var dy = dyn_object.matter.position.y - dyn_object.matter.positionPrev.y;\n                self.camera.translate(-dx,-dy);\n            },{\n                \"slEvent\": true\n            });\n    \n        }\n    \n        if(widget.transformWithCamera) {\n            this.camera.transformingObjects.push(dyn_object)\n        }\n    \n        if(widget.cameraWindow) {\n            self.camera.translate(dyn_object.x,dyn_object.y);\n            self.camera.scale()\n        }\n    \n        if(widget.objLink_a) {\n    \n            var widgetO = widget;\n    \n            this.addEventListener(\"matterJSLoad\",function(){\n                var eventFuncClosure = function() {\n    \n                    var targetObj = self.LO(widgetO.target.L,widgetO.target.O);\n    \n                    var eventFunc = function(){\n                        self.callObjLinkFunctions(targetObj);\n                    } \n    \n                    return eventFunc;\n                \n                }\n    \n    \n                var options = {\n                    ...widgetO,\n                    triggerObj: dyn_object\n                }\n    \n                var f = self.addSimpleEvent(widgetO.trigger,eventFuncClosure(),options);\n            });\n    \n        }\n    \n        \n    \n    }\n    \n    \n    PhSim.DynSim.prototype.extractWidgets = function(dyn_object) {\n        for(var i = 0; i < dyn_object.object.widgets.length; i++) {\n            this.extractWidget(dyn_object.object.widgets[i],dyn_object);\n        }\n    }\n    \n    ","/** \n * Dynamic Simulation Instance Object \n * @param {object} sim - The simulation object\n**/\n\nPhSim.DynSim = function(sim) {\n\n\t/**\n\t * The static simulation object\n\t */\n\t\n\tthis.sim = sim;\n\n\tthis.registerKeyEvents();\n\n}\n\n/**\n * Number of frames per second\n */\n\nPhSim.DynSim.prototype.delta = 50/3; // 16 frames per second, or 16 frames per 1000ms\n\n/**\n * Boolean property for telling if the simulation has loaded a simulation at least one time.\n * @type {Boolean}\n * /\n\nPhSim.DynSim.prototype.init = false;\n\n/**\n * Time for inside the world\n * @type {Number}\n */\n\nPhSim.DynSim.prototype.sl_time = 0;\n\n/**\n * Index of the current simulation\n * @type {Number}\n */\n\nPhSim.DynSim.prototype.simulationIndex = null;\n\n/**\n * Loading status of the dynamic simulation\n * @type {Number}\n */\n\nPhSim.DynSim.prototype.status = 0;\n\n/**\n * x-coordinate of the mouse\n * @type {Number}\n */\n\nPhSim.DynSim.prototype.mouseX = null;\n\n/**\n * y-coordinate of the mouse\n * @type {Number}\n */\n\nPhSim.DynSim.prototype.mouseY = null;\n\n/**\n * Boolean property to tell if the simulation is paused or not.\n * @type {Boolean}\n */\n\nPhSim.DynSim.prototype.paused = true;\n\n/**\n * Global event stack\n * @type {PhSim.EventStack}\n */\n\nPhSim.DynSim.prototype.eventStack = new PhSim.EventStack();\n\n\n/**\n * Event stack for simulation specfic events\n * @type {PhSim.EventStack}\n */\n\nPhSim.DynSim.prototype.slEventStack = new PhSim.EventStack();\n\n /**\n  * \n  * @callback PhSimEventCall\n  * @param {PhSim.PhEvent} phEvent\n  * \n  */\n\n PhSim.DynSim.nextId = \"0\";\n\n/**\n * Structure giving more human-readable meaning to PhSim status.\n * @type {String[]}\n */\n\nPhSim.DynSim.statusStruct = {\n\t0: \"Unloaded\",\n\t1: \"Initalized\",\n\t2: \"Loaded Images\",\n\t3: \"Loaded Audio\",\n\t4: \"Loaded Simulation\"\n}\n\n\n\nPhSim.DynSim.prototype.forAllObjects = function(call) {\n\t\n\tvar a = this.getUniversalObjArray();\n\n\tfor(var i = 0; i < a.length; i++) {\n\t\tvar z = call(a[i]);\n\t\tif(z === false) {\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\n\nPhSim.DynSim.prototype.addToOverlayer = function(dynObject) {\n\tMatter.World.add(this.matterJSWorld, dynObject.matter);\n\tthis.objUniverse.push(dynObject);\n}\n\n// LO Functions\n\nimport \"./lo\";\n\n// Quick constructors\n\nimport \"./makeQuickly\";\n\n// Filter\n\nimport \"./filter\";\n\n// Audio Toggle\n\nimport \"./audioToggle\";\n\n// Event Register\n\nimport \"./registerEvents\";\n\n// Event Listeners\n\nimport \"./eventListener\";\n\n// Gravity Field\n\nimport \"./gravity\";\n\n// Togglers\n\nimport \"./toggle\";\n\n// Changing superlayers\n\nimport \"./gotoSuperlayer\";\n\n// Matter Aliases\n\nimport \"./matterAliases\";\n\n// Set Functions\n\nimport \"./set\";\n\n// Simulation updater\n\nimport \"./update\";\n\n// Extract widgets\n\nimport \"./extractWidgets\";","\n\n// Simulation Camera\n\nPhSim.DynSimCamera = function(dynSim) {\n\n\t/**\n\t * Dynamic Simulation\n\t * @type {PhSim.DynSim}\n\t */\n\n\tthis.dynSim = dynSim;\n\n}\n\nPhSim.DynSimCamera.prototype.scale = 1;\nPhSim.DynSimCamera.prototype.x = 0;\nPhSim.DynSimCamera.prototype.y = 0;\nPhSim.DynSimCamera.prototype.targetObj = null;\nPhSim.DynSimCamera.prototype.transformingObjects = []\n\nPhSim.DynSimCamera.prototype.zoomIn = function(scaleFactor) {\n\tthis.scale = this.scale * scaleFactor;\n\tthis.dynSim.simCtx.scale(scaleFactor,scaleFactor);\n}\n\nPhSim.DynSimCamera.prototype.translate = function(dx,dy) {\n\tthis.x = this.x + dx;\n\tthis.y = this.y + dy;\n\tthis.dynSim.simCtx.translate(dx,dy);\n\n\tfor(var i = 0; i < this.transformingObjects.length; i++) {\n\t\tthis.dynSim.translate(this.transformingObjects[i],dx,dy);\n\t}\n}\n\nPhSim.DynSimCamera.prototype.setPosition = function(x,y) {\n\tthis.dynSim.simCtx.translate(-this.x,-this.y)\n\tthis.x = x;\n\tthis.y = y;\n}\n\n\nPhSim.DynSim.prototype.loading = {\n\t\"bgClr\": \"black\",\n\t\"txtClr\": \"White\",\n\t\"txtFace\": \"arial\",\n\t\"txtAlign\": \"center\",\n\t\"txt\": \"Loading...\",\n\t\"yPos\": \"center\",\n\t\"txtSize\": 20\n}\n\nPhSim.DynSim.prototype.drawLoadingScreen = function() {\n\tthis.simCtx.fillStyle = this.loading.bgClr;\n\tthis.simCtx.fillRect(0,0,this.camera.scale,this.simCanvas.height);\n\tthis.simCtx.fillStyle = this.loading.txtClr;\n\tthis.simCtx.textAlign = this.loading.txtAlign;\n\tthis.simCtx.font = this.loading.txtSize + \"px \" + this.loading.txtFace;\n\tthis.simCtx.fillText(this.loading.txt,this.simCanvas.width / 2,this.simCanvas.height / 2)\n}\n\nPhSim.DynSim.prototype.extractLclGame = function(localSettings) {\n\n\tvar self = this;\n\n\tvar o = {\n\t\tintLife: localSettings.life,\n\t\tgoal: localSettings.goal,\n\t\tintScore: localSettings.score,\n\t\tstatic: localSettings,\n\t\tlife: localSettings.life,\n\t\tscore: localSettings.score,\n\n\t\tsetScore: function(c) {\n\n\t\t\to.score = c;\n\n\t\t\tif(o.score >= o.goal && Number.isInteger(o.score) && Number.isInteger(o.goal)) {\n\t\t\t\n\t\t\t\tself.pause();\n\t\t\t\tself.enableFilter();\n\n\t\t\t\tif(self.simulationIndex + 1 === self.sim.simulations.length) {\n\t\t\t\t\tvar a = self.alert({\n\t\t\t\t\t\tmsg:\"You Win!\",\n\t\t\t\t\t\tcloseButtonTxt:\"Play again\",\n\t\t\t\t\t\tbgColor:\"#333\",\n\t\t\t\t\t\ttxtColor:\"#fff\",\n\t\t\t\t\t\tw:300,\n\t\t\t\t\t\th:100,\n\t\t\t\t\t\tonok: function() {\n\t\t\t\t\t\t\tself.disableFilter();\n\t\t\t\t\t\t\ta.parentNode.removeChild(a);\n\t\t\t\t\t\t\tself.gotoSimulationIndex(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\telse {\n\t\t\t\t\tclearInterval(self.intervalLoop);\n\t\t\t\t\tself.disableFilter();\n\t\t\t\t\tself.gotoSimulationIndex(self.simulationIndex + 1);\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t},\n\n\t\tsetLife: function(c) {\n\t\t\to.life = c;\n\n\t\t\tif(o.life === 0) {\n\t\t\t\to.end();\n\t\t\t}\n\n\t\t},\n\n\t\tincrementLife: function() {\n\t\t\to.setLife(o.life + 1);\n\t\t},\n\n\t\tdecrementLife: function() {\n\t\t\to.setLife(o.life - 1);\n\t\t},\n\n\t\tend: function() {\n\n\t\t\tself.pause();\n\t\t\tself.enableFilter();\n\n\n\t\t\tvar a = self.alert({\n\t\t\t\tmsg:\"Game Over\",\n\t\t\t\tcloseButtonTxt:\"Try again\",\n\t\t\t\tbgColor:\"#333\",\n\t\t\t\ttxtColor:\"#fff\",\n\t\t\t\tw:300,\n\t\t\t\th:100,\n\t\t\t\tonok: function() {\n\t\t\t\t\tself.gotoSimulationIndex(self.simulationIndex);\n\t\t\t\t\tself.disableFilter();\n\t\t\t\t\ta.parentNode.removeChild(a);\t\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t}\n\n\treturn o;\n\n}","PhSim.Gradients = {}\n\nPhSim.Gradients.extractGradient = function(ctx,jsObject) {\n\n\tvar gradient = ctx.createLinearGradient(jsObject.limits.start.x,jsObject.limits.start.y,jsObject.limits.end.x,jsObject.limits.end.y);\n\n\tfor(var i = 0; i < jsObject.stops.length; i++) {\n\t\tgradient.addColorStop(jsObject.stops[i].pos,jsObject.stops[i].color);\n\t}\n\t\n\treturn gradient;\n\n}","/*** \n * \n * \n * Object Widgets\n * \n * \n****/\n\nPhSim.Widgets = {}\n\nPhSim.Widgets.Velocity = function() {\n\tthis.velocity = true;\n\tthis.key = null;\n\tthis.vector = new PhSim.Objects.Vector(null,null);\n}\n\n//PhSim.Widgets.VelocityKey.desc = \"VelocityKey is a widget that allows the user to change the velocity of a physical object by some key.\"\n\nPhSim.Widgets.Force = function() {\n\tthis.trigger = null;\n\tthis.force = true;\n\tthis.key = null;\n\tthis.vector = new PhSim.Objects.Vector(null,null);\n}\n\nPhSim.Widgets.Position = function() {\n\tthis.trigger = null;\n\tthis.position = true;\n\tthis.key = null;\n\tthis.vector = new PhSim.Objects.Vector(null,null);\n}\n\nPhSim.Widgets.Translate = function() {\n\tthis.trigger = null;\n\tthis.translate = true;\n\tthis.key = null;\n\tthis.vector = new PhSim.Objects.Vector(null,null);\n}\n\nPhSim.Widgets.Clone = function() {\n\tthis.trigger = null;\n\tthis.timeCloner = true;\n\tthis.time = null;\n\tthis.clone = true;\n\tthis.key = null;\n\tthis.vector = new PhSim.Objects.Vector(null,null);\n\tthis.copyWidgets = true;\n\tthis.maxN = null;\n}\n\nPhSim.Widgets.DeleteSelf = function() {\n\tthis.deleteSelf = true;\n\tthis.trigger = null;\n}\n\nPhSim.Widgets.PointInWidgetsReturn = function() {\n\tthis.widget = null;\n\tthis.point = null;\n\tthis.pointInWidgetsReturn = true;\n}\n\nPhSim.Widgets.Draggable = function() {\n\tthis.draggable = true;\n}\n\nPhSim.Widgets.Coin = function() {\n\tthis.coin = true;\n}\n\nPhSim.Widgets.Hazard = function() {\n\tthis.hazard = true;\n}\n\nPhSim.Widgets.Health = function() {\n\tthis.health = true;\n}\n\nPhSim.Widgets.Elevator = function() {\n\t\n\tthis.pointA = {\n\t\tx: null,\n\t\ty: null,\n\t}\n\n\tthis.pointB = {\n\t\tx: null,\n\t\ty: null,\n\t}\n\n\tthis.elevator = true;\n\n}\n\nPhSim.Widgets.TransformCameraByObj = function() {\n\tthis.transformCameraByObj = true;\n}\n\nPhSim.Widgets.TransformWithCamera = function() {\n\tthis.transformWithCamera = true;\n}\n\nPhSim.Widgets.KeyboardControls = function() {\n\tthis.up = null;\n\tthis.down = null;\n\tthis.left = null;\n\tthis.right = null;\n\tthis.keyboardControls = true;\n}\n\nPhSim.Widgets.SimpleEvent = function() {\n\tthis.simpleEvent = true;\n\tthis.trigger = null;\n\tthis.action = null;\n\tthis.args = []\n}\n\nPhSim.Widgets.InputBox = function() {\n\tthis.trigger = null;\n\tthis.text = null;\n\tthis.buttonTxt = null;\n\tthis.name = null;\n\tthis.inputBox = true;\n}\n\nPhSim.Widgets.Alert = function() {\n\tthis.buttonTxt = null;\n\tthis.name = null;\n\tthis.text = null;\n\tthis.name = null;\n\tthis.alert = true;\n}\n\n\nPhSim.Widgets.SimpleEvent.actionStruct = [\n\t\"deleteSelf\",\n\t\"addScore\",\n\t\"subtractScore\",\n\t\"explodeSelf\",\n\t\"endGame\",\n\t\"goto\"\n]\n\n// Connection Widget\n\nPhSim.Widgets.Connection = function() {\n\t\n\tthis.objectA = {\n\t\t\"L\": null,\n\t\t\"O\": null\n\t};\n\n\tthis.objectB = {\n\t\t\"L\": null,\n\t\t\"O\": null\n\t};\n\n\tthis.connection = true;\n}\n\n// \n\n// Composite Widget\n\nPhSim.Widgets.Composite = function() {\n\tthis.objUniverse = [];\n\tthis.composite = true;\n}\n\n// Rotation Widget\n\nPhSim.Widgets.Rotation = function() {\n\tthis.trigger = null;\n\tthis.rotation = true;\n\tthis.key = null;\n\tthis.cycle = null;\n\tthis.circularConstraintRotation = null;\n}\n\n// Rotation Widget\n\nPhSim.Widgets.SetAngle = function() {\n\tthis.trigger = null;\n\tthis.setAngle = true;\n\tthis.key = null;\n\tthis.cycle = null;\n\tthis.circularConstraintRotation = null;\n}\n\n// Disable Rotation Widget\n\nPhSim.Widgets.NoRotation = function() {\n\tthis.noRotation = true;\n}\n\n// RectText Widget\n\nPhSim.Widgets.RectText = function() {\n\tthis.content = \"\";\n\tthis.font = \"\";\n\tthis.margin = 0;\n\tthis.size = null;\n\tthis.borderSize = 0;\n\tthis.fill = \"#000000\";\n\tthis.rectText = true;\n\tthis.lineWidth = null;\n\tthis.borderColor = null;\n}\n\nPhSim.Widgets.NumVar = function() {\n\tthis.name = null;\n\tthis.value = null;\n\tthis.numVar = true;\n}\n\nPhSim.Widgets.SetNumVar = function() {\n\tthis.value;\n\tthis.name = null;\n\tthis.trigger = null;\n\tthis.setNumVar = true;\n}\n\nPhSim.Widgets.SetColor = function() {\n\tthis.color = null;\n\tthis.trigger = null;\n\tthis.setColor = true;\n}\n\nPhSim.Widgets.SetBorderColor = function() {\n\tthis.color = null;\n\tthis.trigger = null;\n\tthis.setBorderColor = true;\n}\n\nPhSim.Widgets.SetLineWidth = function() {\n\tthis.lineWidth = null;\n\tthis.trigger = null;\n\tthis.setLineWidth = true;\n}\n\nPhSim.Widgets.Game = function() {\n\tthis.life = null;\n\tthis.goal = null;\n\tthis.score = null;\n\tthis.game = true;\n}\n\nPhSim.Widgets.PlayAudio = function() {\n\tthis.trigger = null;\n\tthis.src = null;\n\tthis.playAudio = true;\n}\n\nPhSim.Widgets.RectText.valueStruc = {\n\tcontent: \"\",\n\ttextAlign: [\"start\",\"end\",\"left\",\"right\",\"center\"],\n\ttextBaseLine: [\"top\", \"hanging\", \"middle\", \"alphabetic\", \"ideographic\", \"bottom\"],\n\tdirection: [\"ltr\",\"rtl\"],\n\tfont: \"\"\n}\n\nPhSim.Widgets.ObjLink_a = function() {\n\tthis.trigger = null;\n\n\tthis.target = {\n\t\t\"L\": 0,\n\t\t\"O\": 0\n\t};\n\n\tthis.objLink_a = true;\n}\n\nPhSim.Widgets.ToggleLock = function() {\n\tthis.toggleLock = true;\n\tthis.trigger = null;\n}\n\nPhSim.Widgets.CircularConstraint = function() {\n\tthis.x = 30;\n\tthis.y = 30;\n\tthis.circularConstraint = true;\n}\n\nPhSim.Widgets.RectText.alignStruct = [\n\t\"left\",\n\t\"right\",\n\t\"center\",\n]\n\n/*\n\nConstraint types\n\n*/\n\nPhSim.Constraints = {\n    Static: {}\n}\n\nPhSim.Constraints.Static.SingleObjectConstraint = function() {\n\tthis.damping = 0,\n\tthis.relativeEndPoint = new Vector();\n\tthis.point = new Vector();\n\tthis.object =  null;\n\tthis.SingleObjectConstraint = true;\n}\n\nPhSim.Constraints.Static.DoubleObjectConstraint = function(rel1,rel2) {\n\tthis.doubleObjectConstraint = true\n}\n\nPhSim.Constraints.Static.Constraint = function() {\n\tthis.objectA = null;\n\tthis.objectB = null;\n\tthis.pointA = null;\n\tthis.pointB = null;\n\tthis.constraint = true;\n}\n\n","PhSim.CollisionClass = function(name) {\n\n\tvar this_a = this;\n\n\tthis.name = name;\n\n\tthis.world = Matter.World.create();\n\n\tthis.engine = Matter.Engine.create({\n\t\tworld: this_a.world\n\t});\n\n}\n\nPhSim.CollisionClass.prototype.addDynObject = function(dynObject) {\n\treturn Matter.World.add(this.world,dynObject.matter);\n};","/**\n * \n * Create Dynamic Object from static object\n * \n * @param {StaticObject} staticObject - Static Object\n * @param {string} staticObject.name - Object Name;\n * @param {boolean} staticObject.locked - Lock\n * @param {Number} staticObject.density - Density\n * @param {Number} staticObject.mass  - Object mass, overrides density if set\n * @param {boolean} staticObject.path - Tells if object is irregular polygon\n * @param {Array} staticObject.verts - Array for vertices, used if object.path === true.\n * @param {boolean} staticObject.circle - Tells if object is a circle.\n * @param {Number} staticObject.x - Center of regular polygon, center of circle or upper left corner of rectangle.\n * @param {Number} staticObject.radius - Radius of circle or circle that circumscribes regular polygon.\n * @param {boolean} staticObject.rectangle - Tells if object is a rectangle\n * @param {Number} staticObject.w - Rectangle Width\n * @param {Number} staticObject.h - Rectangle Height\n * \n */\n\nPhSim.DynObject = function(staticObject) {\n\n\tvar opts = {}\n\n\tif(staticObject.name) {\n\t\topts.label = staticObject.name;\n\t}\n\n\tif(staticObject.locked) {\n\t\topts.isStatic = staticObject.locked;\n\t}\n\n\tif(typeof staticObject.density === \"number\") {\n\t\topts.density = staticObject.density;\n\n\t}\n\n\tif(typeof staticObject.mass === \"number\") {\n\t\topts.mass = staticObject.mass;\n\t\topts.inverseMass = 1/staticObject.mass;\n\t}\n\n\tif(Number.isInteger(staticObject.collisionNum)) {\n\t\topts.collisionFilter = staticObject.collisionNum;\n\t}\n\n\tif(staticObject.path === true) {\n\n\t\tthis.matter = Matter.Bodies.fromVertices(Matter.Vertices.centre(staticObject.verts).x, Matter.Vertices.centre(staticObject.verts).y, staticObject.verts, opts);\n\n\t\t/** Irregular polygon skinmesh */\n\n\t\tthis.skinmesh = JSON.parse(JSON.stringify(staticObject.verts));\n\n\t\t//PhSim.Objects.Path.call(this);\n\n\t}\n\n\tif(staticObject.circle === true) {\n\t\tthis.matter = Matter.Bodies.circle(staticObject.x, staticObject.y, staticObject.radius,opts);\n\t\tthis.firstCycle = staticObject.cycle;\n\t\t//PhSim.Objects.Circle.call(this);\n\t}\n\n\tif(staticObject.rectangle === true) {\n\t\tvar set = PhSim.Tools.getRectangleVertArray(staticObject);\n\t\tthis.firstCycle = staticObject.cycle;\n\t\tthis.matter = Matter.Bodies.fromVertices(Matter.Vertices.centre(set).x, Matter.Vertices.centre(set).y, set, opts); \n\t\t//PhSim.Objects.Rectangle.call(this);\n\t}\n\n\tif(staticObject.regPolygon === true) {\n\t\tvar set = PhSim.Tools.getRegPolygonVerts(staticObject);\n\t\tthis.firstCycle = staticObject.cycle;\n\t\tthis.matter = Matter.Bodies.fromVertices(Matter.Vertices.centre(set).x, Matter.Vertices.centre(set).y, set, opts); \n\t\t//PhSim.Objects.RegPolygon.call(this);\n\t}\n\n\t/** Deep cloned copy of the static object used to create the DynObject*/\n\n\tthis.object = JSON.parse(JSON.stringify(staticObject));\n\n\t/** Reference to static object used to create the DynObject*/\n\n\tthis.static = staticObject;\n\n\t/** Object ID */\n\n\tthis.id = PhSim.DynSim.nextId;\n\n\tPhSim.DynSim.nextId = (Number.parseInt(PhSim.DynSim.nextId,36) + 1).toString(36);\n\t\n\t/** Refernce of DynObj in matter object */\n\n\tthis.matter.plugin.ph = this;\n\n}","/**\n * \n * Calculate DynObject skinmesh\n * \n * @function calc_skinmesh\n * @param {PhSim.DynObject} dynObject \n */\n\nPhSim.calc_skinmesh = function(dynObject) {\n\n\t/** Vector defining transformation */\n\t\n\tdynObject.transformVector = {\n\t\tx: (dynObject.matter.position.x - dynObject.matter.positionPrev.x),\n\t\ty: (dynObject.matter.position.y - dynObject.matter.positionPrev.y),\n\t}\n\n\t/** Number defining rotation */\n\n\ttransformAngle = dynObject.matter.angle - dynObject.matter.anglePrev \n\n\tMatter.Vertices.translate(dynObject.skinmesh,Matter.Vertices.centre(dynObject.skinmesh),-1);\n\tMatter.Vertices.rotate(dynObject.skinmesh,transformAngle,{x: 0, y: 0});\n\tMatter.Vertices.translate(dynObject.skinmesh,dynObject.matter.position,1);\n\n\tdynObject.verts = dynObject.skinmesh;\n\tdynObject.object.verts = dynObject.skinmesh;\n\n}","// Simple Event Reference\n\nPhSim.DynSim.SimpeEventRef = function(trigger,ref) {\n\tthis.trigger = trigger;\n\tthis.ref = ref;\n}\n\n// Simple Event Reference Array\n\nPhSim.DynSim.prototype.simpleEventRefs = [];\n\n/**\n * Create a SimpleEvent\n * @function addSimpleEvent\n * @param {string} trigger - The type of SimpleEvent.\n * @param {Function} call - The JavaScript function to be executed.\n * @param {Object} options - A JavaScript option for the various triggers.\n * @param {string} options.key -  The event.key value for triggering the simpleEvent.\n * @param {Number} options.time - The time interval between a repeated event or a delay time for timeouts.\n * Relevant when the trigger is set to \"time\".\n * @param {Number} options.maxN - The maximum number of times a repeated SimpleEvent can be executed.\n * @param {PhSim.DynObject} options.triggerObj - Trigger object\n * @returns {Number} - A reference to the simple event.\n * */\n\n\nPhSim.DynSim.prototype.addSimpleEvent = function(trigger,call,options) {\n\n\tif(trigger.match(/_global$/)) {\n\t\toptions.triggerObj = null;\n\t}\n\n\tvar self = this;\n\t\n\tif(trigger === \"key\") {\n\n\t\tif(options.triggerObj) {\n\t\t\n\t\t\tvar f = function(e) {\n\t\t\t\tif(options.key === e.key) {\n\t\t\t\t\tcall();\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\telse {\n\n\t\t\tvar f = function(e) {\n\t\t\t\tcall();\n\t\t\t}\n\n\t\t}\n\n\t\tself.addEventListener(\"keydown\",f,{\n\t\t\t\"slEvent\": true\n\t\t});\n\n\t\treturn this.simpleEventRefs.push(new PhSim.DynSim.SimpeEventRef(trigger,f)) - 1;\n\t\t\n\t}\n\n\tif(trigger === \"sensor\" || trigger === \"sensor_global\") {\n\n\t\tvar self = this;\n\n\t\tif(options.triggerObj) {\n\t\t\t\n\t\t\tvar f = function(e) {\n\n\t\t\t\tvar m = self.inSensorCollision(options.triggerObj)\n\t\n\t\t\t\tif(m) {\n\t\t\t\t\tcall(e);\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tvar f = function(e) {\n\t\t\t\tcall(e);\n\t\t\t}\n\t\t}\n\n\t\tself.addEventListener(\"collisionstart\",f,{\n\t\t\t\"slEvent\": true\n\t\t});\n\n\t\treturn this.simpleEventRefs.push(new PhSim.DynSim.SimpeEventRef(trigger,f)) - 1;\n\n\t}\n\n\tif(trigger === \"update\") {\n\t\t\n\t\tvar f = function() {\n\t\t\tcall();\n\t\t}\n\n\t\tself.addEventListener(\"beforeupdate\",f,{\n\t\t\tslEvent: true\n\t\t});\n\n\t\treturn this.simpleEventRefs.push(new PhSim.DynSim.SimpeEventRef(trigger,f)) - 1;\n\t\t\n\t}\n\n\tif(trigger === \"objclick\" || trigger === \"objclick_global\") {\n\n\t\tif(options.triggerObj) {\n\t\t\tvar f = function(e) {\n\t\t\t\tif(self.objMouseArr[self.objMouseArr.length - 1] === options.triggerObj) {\n\t\t\t\t\tcall(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tvar f = function(e) {\n\t\t\t\tcall(e);\n\t\t\t}\n\t\t}\n\n\t\tself.addEventListener(\"objclick\",f,{\n\t\t\tslEvent: true\n\t\t});\n\n\t\treturn this.simpleEventRefs.push(new PhSim.DynSim.SimpeEventRef(trigger,f)) - 1;\n\t}\n\n\tif(trigger === \"objmousedown\" || trigger === \"objmousedown_global\") {\n\n\t\tif(options.triggerObj) {\n\t\t\tvar f = function(e) {\n\t\t\t\tif(self.objMouseArr[self.objMouseArr.length - 1] === options.triggerObj) {\n\t\t\t\t\tcall(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tvar f = function(e) {\n\t\t\t\tcall(e);\n\t\t\t}\n\t\t}\n\n\t\tself.addEventListener(\"objmousedown\",f,{\n\t\t\tslEvent: true\n\t\t});\n\n\t\treturn this.simpleEventRefs.push(new PhSim.DynSim.SimpeEventRef(trigger,f)) - 1;\n\t}\n\n\tthis.callEventClass(\"firstslupdate\",this,afterUpdateEvent);\n\n\t\n\tif(trigger === \"objmouseup\" || trigger === \"objmouseup_global\") {\n\n\t\tif(options.triggerObj) {\n\t\t\tvar f = function(e) {\n\t\t\t\tif(self.objMouseArr[self.objMouseArr.length - 1] === options.triggerObj) {\n\t\t\t\t\tcall(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tvar f = function(e) {\n\t\t\t\tcall(e);\n\t\t\t}\n\t\t}\n\n\t\tself.addEventListener(\"objmouseup\",f,{\n\t\t\tslEvent: true\n\t\t});\n\n\t\treturn this.simpleEventRefs.push(new PhSim.DynSim.SimpeEventRef(trigger,f)) - 1;\n\t}\n\n\tif(trigger === \"objlink\") {\n\t\toptions.triggerObj.objLinkFunctions = options.triggerObj.objLinkFunctions || [];\n\t\toptions.triggerObj.objLinkFunctions.push(call);\n\t}\n\n\tif(trigger === \"afterslchange\") {\n\n\t\t\n\t\tif(options.triggerObj) {\n\t\t\tvar f = function(e) {\n\t\t\t\tcall(e);\n\t\t\t}\n\t\t}\n\n\t\telse {\n\t\t\tvar f = function(e) {\n\t\t\t\tcall(e);\n\t\t\t}\n\t\t}\n\n\t\tself.addEventListener(\"afterslchange\",f,{\n\t\t\tslEvent: true\n\t\t});\n\n\t\treturn this.simpleEventRefs.push(new PhSim.DynSim.SimpeEventRef(trigger,f)) - 1;\n\n\t}\n\n\tif(trigger === \"time\") {\n\n\t\tvar getFunction = function() {\n\n\t\t\tif(Number.isInteger(options.maxN)) {\n\n\t\t\t\tfunc = function(e) {\n\n\t\t\t\t\tif(func.__n === options.maxN) {\n\t\t\t\t\t\tclearInterval(func.__interN);\n\t\t\t\t\t}\n\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(!self.paused) {\n\t\t\t\t\t\t\tcall();\n\t\t\t\t\t\t\tfunc.__n++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tfunc.__n = 0;\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\tfunc = function(e) {\n\t\t\t\t\tif(!self.paused) {\n\t\t\t\t\t\tcall();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tfunc.__phtime = options.time;\n\t\t\tfunc.__interN = null;\n\n\t\t\treturn func;\n\n\t\t}\n\n\t\tvar refFunc = getFunction();\n\n\t\trefFunc.__interN = setInterval(refFunc,refFunc.__phtime);\n\t}\n\n}\n\n/** \n * \n * @param {Number} refNumber - Reference Number\n * \n*/\n\nPhSim.DynSim.prototype.removeSimpleEvent = function(refNumber) {\n\t\n\to = this.simpleEventRefs[refNumber];\n\n\tif(o.trigger === \"key\") {\n\t\tthis.removeEventListener(\"keydown\",o.ref);\n\t}\n\n\tif(o.trigger === \"sensor\") {\n\t\tthis.removeEventListener(\"collisionstart\",o.ref);\n\t}\n\n\tif(o.trigger === \"update\") {\n\t\tthis.removeEventListener(\"beforeupdate\",o.ref);\n\t}\n\n}","/**\n * \n * Process string by replacing magical words\n * \n * @function processVar\n * @param {String} str \n * @returns {String}\n * \n */\n\nPhSim.DynSim.prototype.processVar = function(str) {\n\n\tvar str = str;\n\t\n\tif(str.search(\"{__game__score}\") !== -1 && this.lclGame) {\n\t\tstr = str.replace(/{__game__score}/g,this.lclGame.score);\n\t}\n\n\tif(str.search(\"{__game__life}\") !== -1 && this.lclGame) {\n\t\tstr = str.replace(/{__game__life}/g,this.lclGame.life);\n\t}\n\n\tif(str.search(\"{__game__goal}\") !== -1 && this.lclGame) {\n\t\tstr = str.replace(/{__game__goal}/g,this.lclGame.goal);\n\t}\n\n\tif(str.search(\"{__game__int_life}\") !== -1 && this.lclGame) {\n\t\tstr = str.replace(/{__game__int_life}/g,this.lclGame.intLife);\n\t}\n\n\tif(str.search(\"{__game__int_score}\") !== -1 && this.lclGame) {\n\t\tstr = str.replace(/{__game__int_score}/g,this.lclGame.intScore);\n\t}\n\n\treturn str;\n\n}","\"use strict\";\r\n\r\n/***\r\n\r\nPhysics Simulator Class Library\r\n\r\nCopyright 2020 Mjduniverse.com\r\n\r\n@author Mjduniverse.com\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software \r\nand associated documentation files (the \"Software\"), to deal in the Software without restriction, \r\nincluding without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, \r\nand/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, \r\nsubject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all copies or substantial \r\nportions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT \r\nLIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. \r\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, \r\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE \r\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n***/\r\n\r\n/**\r\n * PhSim Module\r\n */\r\n\r\nimport \"./core\";\r\nimport \"./objects\";\r\nimport \"./eventStack\";\r\nimport \"./phRender\";\r\nimport \"./sprites\";\r\nimport \"./audio\";\r\nimport \"./tools/tools\";\r\nimport \"./dynSim/dynSim\";\r\nimport \"./dynSimCamera\";\r\nimport \"./gradient\";\r\nimport \"./widgets\";\r\nimport \"./collisionClass\";\r\nimport \"./dynObject\";\r\nimport \"./calc_skinmesh\";\r\nimport \"./simpleEvent\";\r\nimport \"./processVar\";","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}