{"code":"!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=0)}([function(t,e,i){\"use strict\";i.r(e);var s={Vector:function(t,e){this.x=t,this.y=e},GradientLimits:function(t,e,i,s){this.start=new Vector(t,e),this.end=new Vector(i,s)},GradientStop:function(t,e){this.color=e,this.pos=t},Gradient:function(){this.stops=[],this.name=\"\",this.limits={start:{x:null,y:null},end:{x:null,y:null}}},lclGradient:function(){this.src=null,this.limits=new s.GradientLimits(x0,y0,x1,y1),this.type=\"linear\"},Path:function(){this.verts=[],this.path=!0},Circle:function(){this.circle=!0,this.x=null,this.y=null,this.radius=null,this.cycle=null},RegPolygon:function(t,e,i,s){this.regPolygon=!0,this.x=t,this.y=e,this.radius=i,this.cycle=null,this.sides=s},Rectangle:function(t,e,i,s){this.rectangle=!0,this.x=t,this.y=e,this.w=i,this.h=s,this.cycle=0},Composite:function(){this.composite=!0,this.name=\"Untitled\"},SimBox:function(t,e){this.width=t,this.height=e},Camera:function(t,e,i){this.x=t,this.y=e,this.c=i},Layer:function(){this.objUniverse=[],this.name=null},simulation:function(){this.layers=[],this.layers.push(new s.Layer),this.world={grav:1,bg:\"white\",border:null,unit:1},this.simulation=!0,this.widgets=[]},CompositeSimulation:function(){this.version=1,this.simulations=[],this.simulations.push(new s.simulation),this.simulations[0].layers[0].name=\"Untitled Layer\",this.simulations[0].name=\"Untitled simulation\",this.box=new s.SimBox(800,600),this.camera=new s.Camera(0,0,1)}},r=s,c=function(t){this.ctx=t};c.prototype.defaultAlpha=1,c.prototype.defaultStrokeStyle=\"transparent\",c.prototype.defaultFillStyle=\"transparent\",c.prototype.setCtx=function(t){this.ctx.lineCap=\"round\",\"number\"==typeof this.ctx.globalAlpha?this.ctx.globalAlpha=t.globalAlpha:this.ctx.globalAlpha=this.defaultAlpha,this.ctx.strokeStyle=t.strokeStyle||this.defaultStrokeStyle,this.ctx.fillStyle=t.fillStyle||this.defaultFillStyle,t.lineWidth?0===t.lineWidth?this.ctx.strokeStyle=\"transparent\":this.ctx.lineWidth=t.lineWidth:this.ctx.strokeStyle=\"transparent\"},c.prototype.static_path=function(t){this.setCtx(t),this.ctx.beginPath(),this.ctx.moveTo(t.verts[0].x,t.verts[0].y);for(var e=0;e<t.verts.length;e++)this.ctx.lineTo(t.verts[e].x,t.verts[e].y);if(this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill(),t.sprite){var i=this.spriteImgArray[t.sprite.src],s=findCentroidOfPath(t);if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t.verts[0].x,t.verts[0].y);for(e=0;e<t.verts.length;e++)this.ctx.lineTo(t.verts[e].x,t.verts[e].y);this.ctx.translate(s.x,s.y),this.ctx.scale(t.sprite.scale,t.sprite.scale);var r=this.ctx.createPattern(i,\"repeat\");this.ctx.fillStyle=r,this.ctx.closePath(),this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t.verts[0].x,t.verts[0].y);for(e=0;e<t.verts.length;e++)this.ctx.lineTo(t.verts[e].x,t.verts[e].y);this.ctx.closePath(),this.ctx.clip();var c=PhSim.Tools.getStaticBoundingBox(t),h=i.height*(c.w/i.width);this.renderSpriteByCenter(t.sprite.src,s.x,s.y,c.w,h,0),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,s.x,s.y,i.width,i.height,0)}},c.prototype.renderSpriteByCenter=function(t,e,i,s,r,c){var h=this.spriteImgArray[t];this.ctx.save(),this.ctx.translate(e,i),this.ctx.rotate(c),null===r?this.ctx.drawImage(h,0,0,h.width,h.height,.5*-s,.5*-r,s):this.ctx.drawImage(h,0,0,h.width,h.height,.5*-s,.5*-r,s,r),this.ctx.restore()},c.prototype.renderConstraint=function(t){var e=SLO(t.object.S,t.object.L,t.object.O);this.ctx.save(),this.ctx.globalAlpha=.5,this.ctx.strokeStyle=\"black\",this.ctx.arc(t.point.x,t.point.y,10,0,2*Math.PI),this.ctx.stroke(),this.ctx.arc(t.relativeEndPoint.x+findCentroidOfPath(e).x,t.relativeEndPoint.y+findCentroidOfPath(e).y,10,0,2*Math.PI),this.ctx.stroke(),this.ctx.setLineDash([10,10]),this.ctx.moveTo(t.point.x,t.point.y),this.ctx.lineTo(t.relativeEndPoint.x+findCentroidOfPath(e).x,t.relativeEndPoint.y+findCentroidOfPath(e).y),this.ctx.stroke(),this.ctx.restore()},c.prototype.static_circle=function(t){if(this.setCtx(t),this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.radius,0,2*Math.PI),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),t.gradient&&(this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.fillStyle=PhSim.Gradients.extractGradient(this.ctx,t.gradient),this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()),t.sprite){var e=this.spriteImgArray[t.sprite.src];if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.scale(t.sprite.scale,t.sprite.scale);var i=this.ctx.createPattern(e,\"repeat\");this.ctx.fillStyle=i,this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.clip();var s=PhSim.Tools.getStaticBoundingBox(t),r=e.height*(s.w/e.width);this.renderSpriteByCenter(t.sprite.src,0,0,s.w,r),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,t.x,t.y,t.cycle)}},c.prototype.static_rectangle=function(t){var e=PhSim.Tools.getRectangleCentroid(t),i=.5*-t.w,s=.5*-t.h;if(this.setCtx(t),this.ctx.translate(e.x,e.y),this.ctx.rotate(t.cycle),this.ctx.beginPath(),this.ctx.rect(i,s,t.w,t.h),this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill(),t.widgets)for(var r=0;r<t.widgets.length;r++)t.widgets[r].rectText&&this.rectText(t.widgets[r],i,s,t.w,t.h,0);if(this.ctx.rotate(-t.cycle),this.ctx.translate(-e.x,-e.y),Number.isInteger(t.sprite)){var c=this.spriteImgArray[t.sprite.src];if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.rotate(t.cycle);var h=this.ctx.createPattern(c,\"repeat\");this.ctx.fillStyle=h,this.ctx.rect(.5*-t.w,.5*-t.h,t.w,t.h),this.ctx.fill(),this.ctx.restore()}if(t.sprite.fit){this.ctx.save(),this.ctx.translate(e.x,e.y),this.ctx.rotate(t.cycle),this.ctx.rect(.5*-t.w,.5*-t.h,t.w,t.h),this.ctx.clip();PhSim.Tools.getStaticBoundingBox(t);var o=c.height*(t.w/c.width);this.renderSpriteByCenter(t.sprite.src,0,0,t.w,o),this.ctx.restore()}else this.renderSpriteByCenter(t.sprite.src,e.x,e.y,c.w,c.h,t.cycle)}},c.prototype.rectText=function(t,e,i,s,r,c){this.ctx.save(),this.ctx.translate(e,i),this.ctx.rotate(c),this.ctx.beginPath(),this.ctx.rect(0,0,s,r),this.ctx.clip(),this.ctx.textAlign=\"left\",this.ctx.fillStyle=t.fill,this.ctx.lineWidth=void 0,t.lineWidth&&(this.ctx.lineWidth=t.lineWidth),this.ctx.strokeStyle=t.borderColor,this.ctx.font=t.size+\"px \"+t.font,this.ctx.textBaseline=\"top\";var h=t.content;this.dynSim&&(h=this.dynSim.processVar(h)),this.ctx.fillText(h,0,0),t.lineWidth&&this.ctx.strokeText(h,0,0),this.ctx.restore()},c.prototype.static_regPolygon=function(t){var e=PhSim.Tools.getRegPolygonVerts(t);this.setCtx(t),this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y);for(var i=0;i<e.length;i++)this.ctx.lineTo(e[i].x,e[i].y);if(this.ctx.closePath(),this.ctx.stroke(),this.ctx.fill(),t.sprite){var s=this.spriteImgArray[t.sprite.src];if(this.ctx.imageSmoothingEnabled=t.sprite.smooth,t.sprite.repeat){this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.cycle),this.ctx.scale(t.sprite.scale,t.sprite.scale);var r=this.ctx.createPattern(s,\"repeat\");this.ctx.fillStyle=r,this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.fill(),this.ctx.restore()}t.sprite.center&&this.renderSpriteByCenter(t.sprite.src,t.x,t.y,t.cycle)}},c.prototype.renderStatic=function(t){if(!0===t.path&&this.static_path(t),!0===t.circle&&this.static_circle(t),!0===t.rectangle&&this.static_rectangle(t),!0===t.regPolygon&&this.static_regPolygon(t),!0===t.composite)for(var e=0;e<t.objUniverse.length;e++)this.renderStatic(t.objUniverse[e])},c.prototype.renderStaticLayer=function(t){for(var e=0;e<t.objUniverse.length;e++)this.renderStatic(t.objUniverse[e])},c.prototype.simulation=function(t){for(var e=0;e<t.layers.length;e++)t.layers[e].hidden||this.layer(t.layers[e])},c.prototype.dynamicSkeleton=function(t){if(t.static.path){this.ctx.beginPath(),this.ctx.moveTo(t.skinmesh[0].x,t.skinmesh[0].y);for(var e=0;e<t.skinmesh.length;e++)this.ctx.lineTo(t.skinmesh[e].x,t.skinmesh[e].y)}else{this.ctx.beginPath(),this.ctx.moveTo(t.matter.vertices.x,t.matter.vertices.y);for(e=0;e<t.matter.vertices.length;e++)this.ctx.lineTo(t.matter.vertices[e].x,t.matter.vertices[e].y)}},c.prototype.dynamicSkeleton_center=function(t){if(t.static.path){this.ctx.beginPath(),this.ctx.moveTo(t.skinmesh[0].x-t.matter.position.x,t.skinmesh[0].y-t.matter.position.y);for(var e=0;e<t.skinmesh.length;e++)this.ctx.lineTo(t.skinmesh[e].x-t.matter.position.x,t.skinmesh[e].y-t.matter.position.y)}else{this.ctx.beginPath(),this.ctx.moveTo(t.matter.vertices.x-t.matter.position.x,t.matter.vertices.y-t.matter.position.y);for(e=0;e<t.matter.vertices.length;e++)this.ctx.lineTo(t.matter.vertices[e].x-t.matter.position.x,t.matter.vertices[e].y-t.matter.position.y)}},c.prototype.drawDynamicSkeleton=function(t){this.dynamicSkeleton(t),this.ctx.closePath(),this.ctx.stroke()},c.prototype.dynamicRenderDraw=function(t){if(this.ctx.lineWidth=t.object.lineWidth,this.ctx.fillStyle=t.object.fillStyle,this.ctx.strokeStyle=t.object.strokeStyle,t.object.path&&(this.drawDynamicSkeleton(t),this.ctx.fill(),t.object.sprite)){var e=this.spriteImgArray[t.object.sprite.src];if(this.ctx.imageSmoothingEnabled=t.object.sprite.smooth,t.object.sprite.repeat){this.ctx.save(),this.dynamicSkeleton(t),this.ctx.translate(t.matter.position.x,t.matter.position.y),this.ctx.rotate(t.matter.angle),this.ctx.scale(t.object.sprite.scale,t.object.sprite.scale);var i=this.ctx.createPattern(e,\"repeat\");this.ctx.fillStyle=i,this.ctx.fill(),this.ctx.restore()}if(t.object.sprite.fit){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t.object.verts[0].x,t.object.verts[0].y);for(var s=0;s<t.object.verts.length;s++)this.ctx.lineTo(t.object.verts[s].x,t.object.verts[s].y);this.ctx.closePath(),this.ctx.clip();var r=PhSim.Tools.getStaticBoundingBox(t.object),c=e.height*(r.w/e.width);this.renderSpriteByCenter(t.object.sprite.src,t.matter.position.x,t.matter.position.y,r.w,c,t.matter.angle),this.ctx.restore()}else this.renderSpriteByCenter(t.object.sprite.src,t.matter.position.x,t.matter.position.y,e.width,e.height,t.matter.angle)}if(t.object.circle&&this.static_circle(t.object),t.object.regPolygon&&this.static_regPolygon(t.object),t.object.rectangle&&this.static_rectangle(t.object),t.object.composite)for(var h=1;h<t.parts.length;h++)this.dynamicRenderDraw(t.parts[h])},c.prototype.dynamicDrawLayer=function(t){for(var e=0;e<sim.simulations[simulationI].layers[t].length;e++)this.dynamicRenderDraw(t,e)};var h=c,o={name:\"phsim\",version:\"1\"};o.Objects=r,o.PhRender=h}]);","extractedComments":[]}